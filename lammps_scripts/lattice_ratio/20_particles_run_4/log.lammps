LAMMPS (23 Jun 2022 - Update 1)
  using 1 OpenMP thread(s) per MPI task
variable num index 0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99

label startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 0

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.51                                                               
Lattice spacing in x,y,z = 5.51 5.51 5.51

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.65 ${n1e1} -100 100 -100 100 units box
region box block -82.65 82.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.65 82.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.65 -100 -100) to (82.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-82.65 -100 -100) to (82.65 100 100)
  create_atoms CPU = 0.001 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.65 -100 -100) to (82.65 100 100)
  create_atoms CPU = 0.005 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_0_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 107 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.81 | 18.27 | 19.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   165.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   165.3          200            200            0.0025391083   1.2242958e-37  0              0.0076173249   11981.426      0              5.7854017e+10  2.6109412e-16  0              3.3370341    
    200000   165.3          200            200            0.00077831261 -9.1668451e-37  0              0.0023349378   2318.0403      0              1.1192987e+10  2.6109412e-16  0              3.1042709    
    300000   165.3          200            200           -0.00012362728 -8.8233317e-37  0             -0.00037088184  159.31066      0              7.6925416e+08  2.6109412e-16  0              3.0355819    
    400000   165.3          200            200            0.011552533   -6.9648065e-38  0              0.0346576      26.729125      0              1.2906538e+08  2.6109412e-16  0              2.9886191    
    500000   165.3          200            200            0.00059814268 -2.699719e-35   0              0.001794428    0.10788767     0              520950.93      2.6109412e-16  0              2.9984335    
    600000   165.3          200            200            0.0024288578   2.7660708e-35  0              0.0072865734   2.1790082      0              10521651       2.6109412e-16  0              2.9959774    
    700000   165.3          200            200            0.0029755128   6.6663267e-37  0              0.0089265383   0.42833911     0              2068296.3      2.6109412e-16  0              2.9954066    
    800000   165.3          200            200            0.0031206777  -1.646023e-36   0              0.0093620331   0.066837153    0              322732.69      2.6109412e-16  0              2.995263     
    900000   165.3          200            200            0.0031601473  -1.0547972e-37  0              0.009480442    0.0097748815   0              47199.404      2.6109412e-16  0              2.9952248    
   1000000   165.3          200            200            0.0031698389   2.1509545e-37  0              0.0095095167   0.0013677434   0              6604.3436      2.6109412e-16  0              2.9952158    
   1100000   165.3          200            200            0.0031716073  -3.5477341e-38  0              0.009514822    0.00018383376  0              887.66742      2.6109412e-16  0              2.9952142    
   1200000   165.3          200            200            0.0031715897   1.579724e-39   0              0.009514769    2.3739894e-05  0              114.63145      2.6109412e-16  0              2.9952143    
   1300000   165.3          200            200            0.0031713382  -2.7189186e-39  0              0.0095140147   2.9401934e-06  0              14.197141      2.6109412e-16  0              2.9952146    
   1400000   165.3          200            200            0.0031711575   8.89131e-39    0              0.0095134726   3.4787627e-07  0              1.67977        2.6109412e-16  0              2.9952148    
   1500000   165.3          200            200            0.00317106     4.960102e-39   0              0.0095131799   3.906026e-08   0              0.18860802     2.6109412e-16  0              2.9952149    
   1600000   165.3          200            200            0.0031710133   2.1444645e-38  0              0.00951304     4.116841e-09   0              0.019878752    2.6109412e-16  0              2.995215     
   1700000   165.3          200            200            0.0031709926   4.0938379e-38  0              0.0095129777   3.9989391e-10  0              0.0019309446   2.6109412e-16  0              2.995215     
   1800000   165.3          200            200            0.0031709837   1.642287e-38   0              0.0095129512   3.463559e-11   0              0.00016724287  2.6109412e-16  0              2.995215     
   1900000   165.3          200            200            0.0031709801   2.4720938e-38  0              0.0095129403   2.5002188e-12  0              1.2072662e-05  2.6109412e-16  0              2.995215     
   2000000   165.3          200            200            0.0031709787   4.2982386e-39  0              0.009512936    1.2638454e-13  0              6.1026573e-07  2.6109412e-16  0              2.995215     
   2100000   165.3          200            200            0.0031709781  -5.5538885e-39  0              0.0095129344   2.0275272e-15  0              9.7902032e-09  2.6109412e-16  0              2.995215     
   2200000   165.3          200            200            0.0031709779   6.6081471e-38  0              0.0095129337   2.331009e-16   0              1.1255608e-09  2.6109412e-16  0              2.995215     
   2300000   165.3          200            200            0.0031709778   3.848602e-38   0              0.0095129335   2.9641784e-16  0              1.4312957e-09  2.6109412e-16  0              2.995215     
   2400000   165.3          200            200            0.0031709778   3.4800098e-38  0              0.0095129334   1.1036634e-16  0              5.3291957e-10  2.6109412e-16  0              2.995215     
   2500000   165.3          200            200            0.0031709778  -8.2436952e-39  0              0.0095129334   2.8778305e-17  0              1.3896014e-10  2.6109412e-16  0              2.995215     
   2600000   165.3          200            200            0.0031709778   5.5723779e-38  0              0.0095129333   6.4950682e-18  0              3.136236e-11   2.6109412e-16  0              2.995215     
   2700000   165.3          200            200            0.0031709778   2.7548468e-38  0              0.0095129333   1.1965546e-18  0              5.777734e-12   2.6109412e-16  0              2.995215     
   2800000   165.3          200            200            0.0031709778   3.1248104e-38  0              0.0095129333   2.5764221e-19  0              1.244062e-12   2.6109412e-16  0              2.995215     
   2900000   165.3          200            200            0.0031709778   7.3201488e-39  0              0.0095129333   4.7761484e-21  0              2.3062311e-14  2.6109412e-16  0              2.995215     
   3000000   165.3          200            200            0.0031709778   6.6716579e-40  0              0.0095129333   1.1533759e-19  0              5.5692396e-13  2.6109412e-16  0              2.995215     
Loop time of 66.3371 on 4 procs for 3000000 steps with 51 atoms

Performance: 39073161.100 ns/day, 0.000 hours/ns, 45223.566 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32849    | 1.756      | 5.7837     | 175.6 |  2.65
Neigh   | 0.085988   | 0.086576   | 0.088204   |   0.3 |  0.13
Comm    | 26.371     | 33.179     | 39.14      |  85.1 | 50.02
Output  | 0.061625   | 0.061736   | 0.061814   |   0.0 |  0.09
Modify  | 16.053     | 22.097     | 29.678     | 122.6 | 33.31
Other   |            | 9.157      |            |       | 13.80

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 1

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.52                                                               
Lattice spacing in x,y,z = 5.52 5.52 5.52

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.8 ${n1e1} -100 100 -100 100 units box
region box block -82.8 82.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.8 82.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.8 -100 -100) to (82.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-82.8 -100 -100) to (82.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.8 -100 -100) to (82.8 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_1_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 107 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.81 | 18.27 | 19.43 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   165.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   165.6          200            200            0.0025318729   1.2212144e-37  0              0.0075956188   11960.243      0              5.7751735e+10  2.6109412e-16  0              3.338722     
    200000   165.6          200            200            0.000776958    3.913568e-38   0              0.002330874    2318.2793      0              1.1194141e+10  2.6109412e-16  0              3.1042897    
    300000   165.6          200            200           -0.00012362995 -4.039328e-37   0             -0.00037088984  159.98827      0              7.7252609e+08  2.6109412e-16  0              3.0355545    
    400000   165.6          200            200            0.011560553   -1.1910738e-37  0              0.034681658    25.715886      0              1.2417281e+08  2.6109412e-16  0              2.9886007    
    500000   165.6          200            200            0.00059595244 -2.6697653e-37  0              0.0017878573   0.087074263    0              420450.45      2.6109412e-16  0              2.9984348    
    600000   165.6          200            200            0.0024296437   9.452469e-37   0              0.007288931    2.2077088      0              10660236       2.6109412e-16  0              2.9959716    
    700000   165.6          200            200            0.0029726011  -2.3770502e-37  0              0.0089178033   0.43168741     0              2084464        2.6109412e-16  0              2.995404     
    800000   165.6          200            200            0.0031160225   2.1673608e-36  0              0.0093480674   0.067177164    0              324374.48      2.6109412e-16  0              2.9952619    
    900000   165.6          200            200            0.0031548069  -1.3695805e-37  0              0.0094644206   0.0098028415   0              47334.413      2.6109412e-16  0              2.9952244    
   1000000   165.6          200            200            0.0031642408  -2.315705e-37   0              0.0094927223   0.001368838    0              6609.6287      2.6109412e-16  0              2.9952156    
   1100000   165.6          200            200            0.0031659147   9.4970544e-39  0              0.0094977442   0.00018360987  0              886.58634      2.6109412e-16  0              2.9952142    
   1200000   165.6          200            200            0.0031658632   2.516626e-39   0              0.0094975895   2.3661928e-05  0              114.25498      2.6109412e-16  0              2.9952143    
   1300000   165.6          200            200            0.0031655998   5.2413224e-39  0              0.0094967994   2.9240484e-06  0              14.119183      2.6109412e-16  0              2.9952146    
   1400000   165.6          200            200            0.003165415    1.7178667e-38  0              0.0094962451   3.4510908e-07  0              1.6664082      2.6109412e-16  0              2.9952148    
   1500000   165.6          200            200            0.0031653161   2.0769754e-38  0              0.0094959482   3.863676e-08   0              0.18656309     2.6109412e-16  0              2.9952149    
   1600000   165.6          200            200            0.003165269    2.0553872e-38  0              0.009495807    4.0574427e-09  0              0.019591939    2.6109412e-16  0              2.995215     
   1700000   165.6          200            200            0.0031652481  -8.4868449e-40  0              0.0094957442   3.922127e-10   0              0.0018938547   2.6109412e-16  0              2.995215     
   1800000   165.6          200            200            0.0031652392   1.0116456e-38  0              0.0094957177   3.3727558e-11  0              0.0001628583   2.6109412e-16  0              2.995215     
   1900000   165.6          200            200            0.0031652356  -1.5008403e-38  0              0.0094957068   2.4049574e-12  0              1.1612678e-05  2.6109412e-16  0              2.995215     
   2000000   165.6          200            200            0.0031652342   9.3577066e-39  0              0.0094957025   1.1824583e-13  0              5.7096678e-07  2.6109412e-16  0              2.995215     
   2100000   165.6          200            200            0.0031652336  -3.0150012e-38  0              0.0094957008   1.6543385e-15  0              7.9882086e-09  2.6109412e-16  0              2.995215     
   2200000   165.6          200            200            0.0031652334   2.6575815e-38  0              0.0094957001   2.8420205e-16  0              1.37231e-09    2.6109412e-16  0              2.995215     
   2300000   165.6          200            200            0.0031652333   3.6360928e-38  0              0.0094956999   3.1654445e-16  0              1.5284798e-09  2.6109412e-16  0              2.995215     
   2400000   165.6          200            200            0.0031652333  -3.0462604e-38  0              0.0094956998   1.1437074e-16  0              5.5225537e-10  2.6109412e-16  0              2.995215     
   2500000   165.6          200            200            0.0031652333  -6.3074981e-39  0              0.0094956998   2.9391642e-17  0              1.4192172e-10  2.6109412e-16  0              2.995215     
   2600000   165.6          200            200            0.0031652333   2.0469854e-38  0              0.0094956998   6.5637425e-18  0              3.1693964e-11  2.6109412e-16  0              2.995215     
   2700000   165.6          200            200            0.0031652333   2.9713888e-38  0              0.0094956998   1.2261382e-18  0              5.9205826e-12  2.6109412e-16  0              2.995215     
   2800000   165.6          200            200            0.0031652333   3.3570324e-38  0              0.0094956998   2.6694112e-19  0              1.2889631e-12  2.6109412e-16  0              2.995215     
   2900000   165.6          200            200            0.0031652333   9.8612869e-39  0              0.0094956998   2.450256e-20   0              1.1831409e-13  2.6109412e-16  0              2.995215     
   3000000   165.6          200            200            0.0031652333  -1.5199135e-38  0              0.0094956998   4.6307629e-20  0              2.2360297e-13  2.6109412e-16  0              2.995215     
Loop time of 65.6646 on 4 procs for 3000000 steps with 51 atoms

Performance: 39473340.443 ns/day, 0.000 hours/ns, 45686.737 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31215    | 1.644      | 5.3653     | 167.7 |  2.50
Neigh   | 0.084437   | 0.085015   | 0.086611   |   0.3 |  0.13
Comm    | 26.145     | 33.03      | 38.896     |  86.0 | 50.30
Output  | 0.062523   | 0.062614   | 0.062692   |   0.0 |  0.10
Modify  | 15.748     | 21.793     | 29.422     | 124.0 | 33.19
Other   |            | 9.049      |            |       | 13.78

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 2

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.53                                                               
Lattice spacing in x,y,z = 5.53 5.53 5.53

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -82.95 ${n1e1} -100 100 -100 100 units box
region box block -82.95 82.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -82.95 82.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-82.95 -100 -100) to (82.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-82.95 -100 -100) to (82.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-82.95 -100 -100) to (82.95 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_2_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 108 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.82 | 18.29 | 19.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   165.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   165.9          200            200            0.0025282625   2.6133952e-39  0              0.0075847874   11967.094      0              5.7784816e+10  2.6109412e-16  0              3.3384703    
    200000   165.9          200            200            0.00077881453 -2.8148882e-36  0              0.0023364436   2333.9601      0              1.1269858e+10  2.6109412e-16  0              3.1034562    
    300000   165.9          200            200           -0.00012217075  3.875862e-36   0             -0.00036651226  156.30665      0              7.5474889e+08  2.6109412e-16  0              3.0357292    
    400000   165.9          200            200            0.011447641    4.8690117e-38  0              0.034342923    28.986591      0              1.3996587e+08  2.6109412e-16  0              2.9886592    
    500000   165.9          200            200            0.00059780955 -2.6941982e-35  0              0.0017934287   0.14829962     0              716085.77      2.6109412e-16  0              2.9984314    
    600000   165.9          200            200            0.0024114305   3.1296734e-35  0              0.0072342915   2.1314675      0              10292094       2.6109412e-16  0              2.9959871    
    700000   165.9          200            200            0.0029606267   7.9813648e-37  0              0.0088818802   0.42277863     0              2041446.7      2.6109412e-16  0              2.9954109    
    800000   165.9          200            200            0.0031077304   2.6338669e-36  0              0.0093231913   0.066271192    0              319999.87      2.6109412e-16  0              2.9952647    
    900000   165.9          200            200            0.0031480785   1.6239357e-38  0              0.0094442355   0.0097282096   0              46974.043      2.6109412e-16  0              2.9952255    
   1000000   165.9          200            200            0.0031581345   1.8243631e-37  0              0.0094744035   0.0013658998   0              6595.4412      2.6109412e-16  0              2.995216     
   1100000   165.9          200            200            0.0031600484  -2.9544017e-38  0              0.0094801453   0.00018420475  0              889.4588       2.6109412e-16  0              2.9952143    
   1200000   165.9          200            200            0.0031600873   5.303866e-39   0              0.009480262    2.3869843e-05  0              115.25893      2.6109412e-16  0              2.9952144    
   1300000   165.9          200            200            0.0031598574   1.2779746e-39  0              0.0094795722   2.9671704e-06  0              14.327404      2.6109412e-16  0              2.9952146    
   1400000   165.9          200            200            0.0031596847   3.9402379e-39  0              0.0094790542   3.5251007e-07  0              1.702145       2.6109412e-16  0              2.9952148    
   1500000   165.9          200            200            0.0031595901  -5.7997122e-39  0              0.0094787703   3.9771034e-08  0              0.19204009     2.6109412e-16  0              2.9952149    
   1600000   165.9          200            200            0.0031595445   6.6516702e-39  0              0.0094786335   4.2167881e-09  0              0.020361361    2.6109412e-16  0              2.995215     
   1700000   165.9          200            200            0.0031595241   2.2089672e-38  0              0.0094785723   4.1287059e-10  0              0.0019936043   2.6109412e-16  0              2.995215     
   1800000   165.9          200            200            0.0031595154  -2.6223024e-39  0              0.0094785462   3.6179864e-11  0              0.00017469961  2.6109412e-16  0              2.995215     
   1900000   165.9          200            200            0.0031595118  -1.6949404e-38  0              0.0094785355   2.6642579e-12  0              1.2864748e-05  2.6109412e-16  0              2.995215     
   2000000   165.9          200            200            0.0031595104   6.9529488e-39  0              0.0094785312   1.4067933e-13  0              6.7929015e-07  2.6109412e-16  0              2.995215     
   2100000   165.9          200            200            0.0031595098  -1.06448e-38    0              0.0094785295   2.746363e-15   0              1.3261204e-08  2.6109412e-16  0              2.995215     
   2200000   165.9          200            200            0.0031595096   2.3205503e-38  0              0.0094785289   1.57196e-16    0              7.5904324e-10  2.6109412e-16  0              2.995215     
   2300000   165.9          200            200            0.0031595096   1.3879132e-38  0              0.0094785287   2.6341787e-16  0              1.2719506e-09  2.6109412e-16  0              2.995215     
   2400000   165.9          200            200            0.0031595095  -1.2517664e-38  0              0.0094785286   1.0313679e-16  0              4.9801064e-10  2.6109412e-16  0              2.995215     
   2500000   165.9          200            200            0.0031595095   3.6998999e-38  0              0.0094785285   2.7456605e-17  0              1.3257812e-10  2.6109412e-16  0              2.995215     
   2600000   165.9          200            200            0.0031595095   3.7080737e-38  0              0.0094785285   6.2530017e-18  0              3.0193507e-11  2.6109412e-16  0              2.995215     
   2700000   165.9          200            200            0.0031595095   1.5898527e-38  0              0.0094785285   1.2424761e-18  0              5.9994726e-12  2.6109412e-16  0              2.995215     
   2800000   165.9          200            200            0.0031595095  -6.9976321e-39  0              0.0094785285   2.6637412e-19  0              1.2862253e-12  2.6109412e-16  0              2.995215     
   2900000   165.9          200            200            0.0031595095  -1.7410334e-39  0              0.0094785285   1.5476934e-20  0              7.4732573e-14  2.6109412e-16  0              2.995215     
   3000000   165.9          200            200            0.0031595095  -1.6070154e-39  0              0.0094785285   6.9428553e-20  0              3.3524563e-13  2.6109412e-16  0              2.995215     
Loop time of 65.5418 on 4 procs for 3000000 steps with 51 atoms

Performance: 39547309.788 ns/day, 0.000 hours/ns, 45772.349 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32821    | 1.6272     | 5.3223     | 167.3 |  2.48
Neigh   | 0.085245   | 0.085775   | 0.087289   |   0.3 |  0.13
Comm    | 25.953     | 32.871     | 38.747     |  86.5 | 50.15
Output  | 0.082997   | 0.083084   | 0.083162   |   0.0 |  0.13
Modify  | 15.736     | 21.77      | 29.377     | 122.9 | 33.22
Other   |            | 9.105      |            |       | 13.89

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 3

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.54                                                               
Lattice spacing in x,y,z = 5.54 5.54 5.54

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -83.1 ${n1e1} -100 100 -100 100 units box
region box block -83.1 83.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.1 83.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-83.1 -100 -100) to (83.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-83.1 -100 -100) to (83.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-83.1 -100 -100) to (83.1 100 100)
  create_atoms CPU = 0.003 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_3_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 108 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.82 | 18.29 | 19.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   166.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   166.2          200            200            0.0025253451  -3.537934e-37   0              0.0075760354   11979.309      0              5.7843795e+10  2.6109412e-16  0              3.3378301    
    200000   166.2          200            200            0.00078170988  3.5218616e-38  0              0.0023451296   2354.7366      0              1.137018e+10   2.6109412e-16  0              3.1023433    
    300000   166.2          200            200           -0.00012025766  1.0200329e-36  0             -0.00036077298  151.3459       0              7.3079517e+08  2.6109412e-16  0              3.0359638    
    400000   166.2          200            200            0.011290116    1.2270517e-36  0              0.033870349    33.816661      0              1.6328855e+08  2.6109412e-16  0              2.988747     
    500000   166.2          200            200            0.00060180331  1.4827438e-35  0              0.0018054099   0.26203641     0              1265280        2.6109412e-16  0              2.9984249    
    600000   166.2          200            200            0.0023880889   4.5718806e-36  0              0.0071642667   2.0237697      0              9772059.5      2.6109412e-16  0              2.9960086    
    700000   166.2          200            200            0.002946118    1.4239124e-36  0              0.008838354    0.40985214     0              1979029.3      2.6109412e-16  0              2.9954205    
    800000   166.2          200            200            0.0030984114   1.675301e-36   0              0.0092952342   0.064921103    0              313480.77      2.6109412e-16  0              2.9952685    
    900000   166.2          200            200            0.0031409617   2.1515223e-37  0              0.0094228852   0.009611227    0              46409.176      2.6109412e-16  0              2.9952269    
   1000000   166.2          200            200            0.0031518935  -2.8210744e-38  0              0.0094556804   0.0013600446   0              6567.1684      2.6109412e-16  0              2.9952165    
   1100000   166.2          200            200            0.003154145   -5.7444058e-38  0              0.0094624349   0.00018481374  0              892.3994       2.6109412e-16  0              2.9952145    
   1200000   166.2          200            200            0.0031543111   8.9554941e-40  0              0.0094629333   2.4134595e-05  0              116.53732      2.6109412e-16  0              2.9952144    
   1300000   166.2          200            200            0.0031541282   5.1274295e-39  0              0.0094623845   3.0247903e-06  0              14.60563       2.6109412e-16  0              2.9952147    
   1400000   166.2          200            200            0.0031539725   6.798321e-39   0              0.0094619175   3.6263759e-07  0              1.7510471      2.6109412e-16  0              2.9952148    
   1500000   166.2          200            200            0.0031538839   4.1157636e-39  0              0.0094616516   4.1348561e-08  0              0.1996574      2.6109412e-16  0              2.9952149    
   1600000   166.2          200            200            0.0031538404   8.7358291e-39  0              0.0094615211   4.4414333e-09  0              0.021446092    2.6109412e-16  0              2.995215     
   1700000   166.2          200            200            0.0031538207   3.1158702e-38  0              0.009461462    4.4238128e-10  0              0.0021361009   2.6109412e-16  0              2.995215     
   1800000   166.2          200            200            0.0031538122  -5.0588816e-39  0              0.0094614366   3.973847e-11   0              0.00019188285  2.6109412e-16  0              2.995215     
   1900000   166.2          200            200            0.0031538087   6.1409913e-39  0              0.0094614261   3.0489038e-12  0              1.4722065e-05  2.6109412e-16  0              2.995215     
   2000000   166.2          200            200            0.0031538073  -4.2796934e-38  0              0.0094614219   1.755053e-13   0              8.4745228e-07  2.6109412e-16  0              2.995215     
   2100000   166.2          200            200            0.0031538068   3.1817392e-38  0              0.0094614203   4.7508641e-15  0              2.2940222e-08  2.6109412e-16  0              2.995215     
   2200000   166.2          200            200            0.0031538065   1.5142232e-40  0              0.0094614196   4.1204055e-17  0              1.9895964e-10  2.6109412e-16  0              2.995215     
   2300000   166.2          200            200            0.0031538065  -3.9427206e-38  0              0.0094614194   1.9632302e-16  0              9.4797361e-10  2.6109412e-16  0              2.995215     
   2400000   166.2          200            200            0.0031538064   1.8863266e-38  0              0.0094614193   8.7553033e-17  0              4.2276226e-10  2.6109412e-16  0              2.995215     
   2500000   166.2          200            200            0.0031538064   2.6804596e-38  0              0.0094614193   2.4596086e-17  0              1.187657e-10   2.6109412e-16  0              2.995215     
   2600000   166.2          200            200            0.0031538064  -4.3632058e-39  0              0.0094614193   5.8601318e-18  0              2.8296479e-11  2.6109412e-16  0              2.995215     
   2700000   166.2          200            200            0.0031538064   4.1273785e-38  0              0.0094614193   1.1155927e-18  0              5.386798e-12   2.6109412e-16  0              2.995215     
   2800000   166.2          200            200            0.0031538064  -6.0314456e-38  0              0.0094614193   2.4891605e-19  0              1.2019265e-12  2.6109412e-16  0              2.995215     
   2900000   166.2          200            200            0.0031538064  -7.0825508e-38  0              0.0094614193   9.4714468e-21  0              4.5734227e-14  2.6109412e-16  0              2.995215     
   3000000   166.2          200            200            0.0031538064  -1.235483e-38   0              0.0094614193   7.157154e-20   0              3.4559335e-13  2.6109412e-16  0              2.995215     
Loop time of 65.3306 on 4 procs for 3000000 steps with 51 atoms

Performance: 39675143.263 ns/day, 0.000 hours/ns, 45920.305 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32116    | 1.5881     | 5.2233     | 166.6 |  2.43
Neigh   | 0.084155   | 0.084702   | 0.086209   |   0.3 |  0.13
Comm    | 26.095     | 32.812     | 38.602     |  84.6 | 50.22
Output  | 0.060917   | 0.060995   | 0.061056   |   0.0 |  0.09
Modify  | 15.766     | 21.708     | 29.204     | 122.1 | 33.23
Other   |            | 9.077      |            |       | 13.89

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 4

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.55                                                               
Lattice spacing in x,y,z = 5.55 5.55 5.55

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -83.25 ${n1e1} -100 100 -100 100 units box
region box block -83.25 83.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.25 83.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-83.25 -100 -100) to (83.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-83.25 -100 -100) to (83.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-83.25 -100 -100) to (83.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_4_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 108 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.82 | 18.29 | 19.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   166.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   166.5          200            200            0.0025224068   2.387405e-37   0              0.0075672204   11991.226      0              5.7901341e+10  2.6109412e-16  0              3.3372283    
    200000   166.5          200            200            0.00078536476 -4.3947562e-37  0              0.0023560943   2379.3163      0              1.1488867e+10  2.6109412e-16  0              3.1010264    
    300000   166.5          200            200           -0.00011805158  4.8080385e-36  0             -0.00035415475  145.63805      0              7.0323403e+08  2.6109412e-16  0              3.0362343    
    400000   166.5          200            200            0.011098266   -7.9918472e-36  0              0.033294799    39.808736      0              1.9222214e+08  2.6109412e-16  0              2.9888579    
    500000   166.5          200            200            0.00060798514 -4.296943e-36   0              0.0018239554   0.43482471     0              2099612.9      2.6109412e-16  0              2.998415     
    600000   166.5          200            200            0.0023623978   4.5408734e-36  0              0.0070871933   1.8985001      0              9167177.4      2.6109412e-16  0              2.9960329    
    700000   166.5          200            200            0.0029303455   3.9669997e-37  0              0.0087910366   0.39432108     0              1904035.4      2.6109412e-16  0              2.9954315    
    800000   166.5          200            200            0.0030885655   2.6247434e-36  0              0.0092656965   0.063248658    0              305405.13      2.6109412e-16  0              2.9952728    
    900000   166.5          200            200            0.0031336458  -1.3985162e-37  0              0.0094009373   0.0094583686   0              45671.077      2.6109412e-16  0              2.9952286    
   1000000   166.5          200            200            0.0031455874   8.9983307e-38  0              0.0094367623   0.001350758    0              6522.327       2.6109412e-16  0              2.9952172    
   1100000   166.5          200            200            0.0031482296  -1.3130111e-38  0              0.0094446887   0.00018518637  0              894.19869      2.6109412e-16  0              2.9952148    
   1200000   166.5          200            200            0.0031485433   8.3630624e-39  0              0.00944563     2.4400602e-05  0              117.82177      2.6109412e-16  0              2.9952145    
   1300000   166.5          200            200            0.003148415    4.053765e-39   0              0.0094452451   3.0870527e-06  0              14.906273      2.6109412e-16  0              2.9952147    
   1400000   166.5          200            200            0.0031482792   3.4934355e-39  0              0.0094448376   3.7394811e-07  0              1.8056616      2.6109412e-16  0              2.9952148    
   1500000   166.5          200            200            0.0031481976  -9.5682795e-39  0              0.0094445929   4.3148556e-08  0              0.20834893     2.6109412e-16  0              2.9952149    
   1600000   166.5          200            200            0.0031481566   1.7032904e-38  0              0.0094444698   4.7022623e-09  0              0.022705542    2.6109412e-16  0              2.995215     
   1700000   166.5          200            200            0.0031481377   2.6246559e-38  0              0.0094444132   4.7722686e-10  0              0.0023043577   2.6109412e-16  0              2.995215     
   1800000   166.5          200            200            0.0031481295  -2.3086033e-38  0              0.0094443886   4.402145e-11   0              0.00021256383  2.6109412e-16  0              2.995215     
   1900000   166.5          200            200            0.0031481261   8.2119211e-39  0              0.0094443784   3.5242693e-12  0              1.7017435e-05  2.6109412e-16  0              2.995215     
   2000000   166.5          200            200            0.0031481248   3.5236118e-39  0              0.0094443743   2.2066313e-13  0              1.0655033e-06  2.6109412e-16  0              2.995215     
   2100000   166.5          200            200            0.0031481242   2.960887e-38   0              0.0094443727   7.7902547e-15  0              3.7616352e-08  2.6109412e-16  0              2.995215     
   2200000   166.5          200            200            0.003148124   -4.4467595e-40  0              0.009444372    5.4587785e-19  0              2.6358488e-12  2.6109412e-16  0              2.995215     
   2300000   166.5          200            200            0.0031481239   3.3760549e-38  0              0.0094443718   1.3019904e-16  0              6.2868456e-10  2.6109412e-16  0              2.995215     
   2400000   166.5          200            200            0.0031481239  -1.2036216e-38  0              0.0094443717   7.1307377e-17  0              3.443178e-10   2.6109412e-16  0              2.995215     
   2500000   166.5          200            200            0.0031481239  -2.2982344e-38  0              0.0094443717   2.1408906e-17  0              1.0337594e-10  2.6109412e-16  0              2.995215     
   2600000   166.5          200            200            0.0031481239   4.7371025e-39  0              0.0094443717   5.3045073e-18  0              2.5613567e-11  2.6109412e-16  0              2.995215     
   2700000   166.5          200            200            0.0031481239   4.2467204e-38  0              0.0094443717   9.632836e-19   0              4.6513518e-12  2.6109412e-16  0              2.995215     
   2800000   166.5          200            200            0.0031481239   2.9444886e-38  0              0.0094443717   2.2852941e-19  0              1.1034867e-12  2.6109412e-16  0              2.995215     
   2900000   166.5          200            200            0.0031481239  -1.8548328e-38  0              0.0094443717   2.8006991e-20  0              1.3523574e-13  2.6109412e-16  0              2.995215     
   3000000   166.5          200            200            0.0031481239  -1.4214715e-39  0              0.0094443717   4.5651588e-20  0              2.2043518e-13  2.6109412e-16  0              2.995215     
Loop time of 65.0142 on 4 procs for 3000000 steps with 51 atoms

Performance: 39868228.565 ns/day, 0.000 hours/ns, 46143.783 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31589    | 1.6119     | 5.2954     | 167.6 |  2.48
Neigh   | 0.084092   | 0.084709   | 0.086258   |   0.3 |  0.13
Comm    | 26.111     | 32.674     | 38.383     |  83.4 | 50.26
Output  | 0.061393   | 0.061465   | 0.061522   |   0.0 |  0.09
Modify  | 15.687     | 21.543     | 28.833     | 121.0 | 33.14
Other   |            | 9.04       |            |       | 13.90

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 5

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.56                                                               
Lattice spacing in x,y,z = 5.56 5.56 5.56

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -83.4 ${n1e1} -100 100 -100 100 units box
region box block -83.4 83.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.4 83.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-83.4 -100 -100) to (83.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-83.4 -100 -100) to (83.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-83.4 -100 -100) to (83.4 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_5_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 108 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.82 | 18.29 | 19.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   166.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   166.8          200            200            0.0025194457   1.5293043e-39  0              0.0075583371   12002.835      0              5.7957393e+10  2.6109412e-16  0              3.3366648    
    200000   166.8          200            200            0.00078954381 -4.3960065e-37  0              0.0023686314   2406.5999      0              1.1620609e+10  2.6109412e-16  0              3.0995714    
    300000   166.8          200            200           -0.0001157023   1.9613044e-36  0             -0.00034710691  139.65406      0              6.7433947e+08  2.6109412e-16  0              3.0365196    
    400000   166.8          200            200            0.010885586   -1.7181157e-35  0              0.032656758    46.456233      0              2.2432052e+08  2.6109412e-16  0              2.9889839    
    500000   166.8          200            200            0.00061597411  5.2453994e-35  0              0.0018479223   0.65980554     0              3185964.8      2.6109412e-16  0              2.9984019    
    600000   166.8          200            200            0.0023367854  -6.8657172e-36  0              0.0070103563   1.7691995      0              8542831.1      2.6109412e-16  0              2.9960573    
    700000   166.8          200            200            0.0029144618   1.1450982e-36  0              0.0087433853   0.37773174     0              1823931.4      2.6109412e-16  0              2.9954427    
    800000   166.8          200            200            0.003078655    1.6756963e-36  0              0.0092359649   0.061407052    0              296512.68      2.6109412e-16  0              2.9952773    
    900000   166.8          200            200            0.0031263079   1.5785513e-39  0              0.0093789237   0.0092815933   0              44817.492      2.6109412e-16  0              2.9952304    
   1000000   166.8          200            200            0.0031392827  -5.904192e-38   0              0.0094178482   0.0013383687   0              6462.5035      2.6109412e-16  0              2.9952178    
   1100000   166.8          200            200            0.0031423265   2.6793524e-38  0              0.0094269794   0.00018519065  0              894.21937      2.6109412e-16  0              2.995215     
   1200000   166.8          200            200            0.0031427926  -1.4478458e-39  0              0.0094283779   2.4627647e-05  0              118.91809      2.6109412e-16  0              2.9952146    
   1300000   166.8          200            200            0.003142721    3.242837e-39   0              0.009428163    3.1459277e-06  0              15.190559      2.6109412e-16  0              2.9952147    
   1400000   166.8          200            200            0.0031426059  -9.756168e-39   0              0.0094278176   3.8509136e-07  0              1.8594684      2.6109412e-16  0              2.9952149    
   1500000   166.8          200            200            0.0031425317  -5.5065476e-39  0              0.009427595    4.4967045e-08  0              0.21712977     2.6109412e-16  0              2.9952149    
   1600000   166.8          200            200            0.0031424932   2.6311898e-38  0              0.0094274796   4.970964e-09   0              0.024003006    2.6109412e-16  0              2.995215     
   1700000   166.8          200            200            0.0031424752   5.3706693e-38  0              0.0094274256   5.1378399e-10  0              0.002480879    2.6109412e-16  0              2.995215     
   1800000   166.8          200            200            0.0031424673   6.0191359e-39  0              0.009427402    4.8604845e-11  0              0.0002346954   2.6109412e-16  0              2.995215     
   1900000   166.8          200            200            0.003142464    9.2385293e-39  0              0.009427392    4.0463707e-12  0              1.9538476e-05  2.6109412e-16  0              2.995215     
   2000000   166.8          200            200            0.0031424627   2.6395135e-38  0              0.009427388    2.7247088e-13  0              1.3156644e-06  2.6109412e-16  0              2.995215     
   2100000   166.8          200            200            0.0031424621   9.5859054e-39  0              0.0094273864   1.1672363e-14  0              5.6361665e-08  2.6109412e-16  0              2.995215     
   2200000   166.8          200            200            0.0031424619  -1.7101856e-38  0              0.0094273857   6.5921484e-17  0              3.1831125e-10  2.6109412e-16  0              2.995215     
   2300000   166.8          200            200            0.0031424618   3.1409772e-38  0              0.0094273855   7.5273705e-17  0              3.6346978e-10  2.6109412e-16  0              2.995215     
   2400000   166.8          200            200            0.0031424618  -2.9525658e-38  0              0.0094273854   5.5565775e-17  0              2.6830724e-10  2.6109412e-16  0              2.995215     
   2500000   166.8          200            200            0.0031424618  -2.8329452e-40  0              0.0094273854   1.8398907e-17  0              8.8841739e-11  2.6109412e-16  0              2.995215     
   2600000   166.8          200            200            0.0031424618   2.6876973e-38  0              0.0094273854   4.7667697e-18  0              2.3017025e-11  2.6109412e-16  0              2.995215     
   2700000   166.8          200            200            0.0031424618  -2.0988781e-38  0              0.0094273854   1.0400183e-18  0              5.0218759e-12  2.6109412e-16  0              2.995215     
   2800000   166.8          200            200            0.0031424618   2.8237146e-38  0              0.0094273854   2.4234323e-19  0              1.1701887e-12  2.6109412e-16  0              2.995215     
   2900000   166.8          200            200            0.0031424618   2.7732414e-38  0              0.0094273854   1.0575163e-20  0              5.1063677e-14  2.6109412e-16  0              2.995215     
   3000000   166.8          200            200            0.0031424618   2.198232e-38   0              0.0094273854   9.0467048e-20  0              4.36833e-13    2.6109412e-16  0              2.995215     
Loop time of 64.1009 on 4 procs for 3000000 steps with 51 atoms

Performance: 40436248.799 ns/day, 0.000 hours/ns, 46801.214 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31791    | 1.5081     | 4.907      | 159.8 |  2.35
Neigh   | 0.084131   | 0.084718   | 0.086259   |   0.3 |  0.13
Comm    | 25.896     | 32.564     | 38.283     |  85.1 | 50.80
Output  | 0.060326   | 0.060408   | 0.060474   |   0.0 |  0.09
Modify  | 15.238     | 21.14      | 28.477     | 122.5 | 32.98
Other   |            | 8.744      |            |       | 13.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 6

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.57                                                               
Lattice spacing in x,y,z = 5.57 5.57 5.57

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -83.55 ${n1e1} -100 100 -100 100 units box
region box block -83.55 83.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.55 83.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-83.55 -100 -100) to (83.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-83.55 -100 -100) to (83.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-83.55 -100 -100) to (83.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_6_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 108 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.82 | 18.29 | 19.45 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   167.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   167.1          200            200            0.0025164605   7.093714e-37   0              0.0075493815   12014.125      0              6.4457678e+10  2.6109412e-16  0              3.3361391    
    200000   167.1          200            200            0.00079402754 -4.4212268e-37  0              0.0023820826   2435.545       0              1.3067084e+10  2.6109412e-16  0              3.0980401    
    300000   167.1          200            200           -0.00011321481 -8.7588755e-37  0             -0.00033964444  133.43669      0              7.159089e+08   2.6109412e-16  0              3.0368181    
    400000   167.1          200            200            0.010652764    3.5937249e-35  0              0.031958292    53.698736      0              2.881022e+08   2.6109412e-16  0              2.9891247    
    500000   167.1          200            200            0.00062582615 -5.8831124e-37  0              0.0018774784   0.93843706     0              5034863        2.6109412e-16  0              2.9983857    
    600000   167.1          200            200            0.0023115748  -2.587423e-35   0              0.0069347245   1.6378782      0              8787475.2      2.6109412e-16  0              2.9960815    
    700000   167.1          200            200            0.0028986154  -2.1292542e-36  0              0.0086958463   0.36029293     0              1933028.4      2.6109412e-16  0              2.9954539    
    800000   167.1          200            200            0.0030687382   4.966593e-36   0              0.0092062146   0.059414444    0              318767.87      2.6109412e-16  0              2.9952819    
    900000   167.1          200            200            0.0031189701   6.8135596e-39  0              0.0093569103   0.0090818863   0              48725.754      2.6109412e-16  0              2.9952322    
   1000000   167.1          200            200            0.0031329874  -1.8096094e-37  0              0.0093989622   0.0013228047   0              7097.0561      2.6109412e-16  0              2.9952185    
   1100000   167.1          200            200            0.0031364384   7.7332392e-40  0              0.0094093153   0.00018479012  0              991.42819      2.6109412e-16  0              2.9952153    
   1200000   167.1          200            200            0.0031370599  -1.1783969e-38  0              0.0094111798   2.4807591e-05  0              133.09664      2.6109412e-16  0              2.9952147    
   1300000   167.1          200            200            0.0031370463  -7.5078286e-39  0              0.009411139    3.1999686e-06  0              17.168337      2.6109412e-16  0              2.9952148    
   1400000   167.1          200            200            0.0031369524   5.6340415e-39  0              0.0094108573   3.9583999e-07  0              2.123744       2.6109412e-16  0              2.9952149    
   1500000   167.1          200            200            0.0031368858  -4.437962e-39   0              0.0094106575   4.6771474e-08  0              0.25093634     2.6109412e-16  0              2.9952149    
   1600000   167.1          200            200            0.0031368501   4.697912e-39   0              0.0094105502   5.2432297e-09  0              0.028130755    2.6109412e-16  0              2.995215     
   1700000   167.1          200            200            0.003136833   -1.4576137e-38  0              0.009410499    5.5152206e-10  0              0.0029590029   2.6109412e-16  0              2.995215     
   1800000   167.1          200            200            0.0031368254   1.6573606e-38  0              0.0094104762   5.3430537e-11  0              0.00028666327  2.6109412e-16  0              2.995215     
   1900000   167.1          200            200            0.0031368222  -6.614288e-39   0              0.0094104666   4.6096046e-12  0              2.4731257e-05  2.6109412e-16  0              2.995215     
   2000000   167.1          200            200            0.0031368209   1.1730859e-38  0              0.0094104626   3.3050135e-13  0              1.7731919e-06  2.6109412e-16  0              2.995215     
   2100000   167.1          200            200            0.0031368204  -1.862785e-38   0              0.0094104611   1.6466214e-14  0              8.8343836e-08  2.6109412e-16  0              2.995215     
   2200000   167.1          200            200            0.0031368202   3.5152567e-38  0              0.0094104605   2.4577471e-16  0              1.3186201e-09  2.6109412e-16  0              2.995215     
   2300000   167.1          200            200            0.0031368201  -2.784201e-38   0              0.0094104602   3.4305239e-17  0              1.8405302e-10  2.6109412e-16  0              2.995215     
   2400000   167.1          200            200            0.00313682     1.7459421e-38  0              0.0094104601   4.1804421e-17  0              2.2428732e-10  2.6109412e-16  0              2.995215     
   2500000   167.1          200            200            0.00313682    -2.1887711e-39  0              0.0094104601   1.5384964e-17  0              8.2542763e-11  2.6109412e-16  0              2.995215     
   2600000   167.1          200            200            0.00313682    -1.2916522e-38  0              0.0094104601   4.2860159e-18  0              2.2995152e-11  2.6109412e-16  0              2.995215     
   2700000   167.1          200            200            0.00313682     1.4297363e-40  0              0.0094104601   8.4931888e-19  0              4.5567299e-12  2.6109412e-16  0              2.995215     
   2800000   167.1          200            200            0.00313682     3.4255995e-38  0              0.0094104601   2.159705e-19   0              1.1587159e-12  2.6109412e-16  0              2.995215     
   2900000   167.1          200            200            0.00313682     2.5190488e-38  0              0.0094104601   3.9504991e-20  0              2.1195052e-13  2.6109412e-16  0              2.995215     
   3000000   167.1          200            200            0.00313682     1.8177956e-38  0              0.0094104601   2.3764214e-20  0              1.2749876e-13  2.6109412e-16  0              2.995215     
Loop time of 63.0355 on 4 procs for 3000000 steps with 50 atoms

Performance: 41119659.611 ns/day, 0.000 hours/ns, 47592.199 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28982    | 1.5313     | 4.9879     | 161.4 |  2.43
Neigh   | 0.084198   | 0.084737   | 0.086201   |   0.3 |  0.13
Comm    | 25.124     | 31.824     | 37.492     |  85.0 | 50.49
Output  | 0.060915   | 0.060996   | 0.061062   |   0.0 |  0.10
Modify  | 14.978     | 20.852     | 28.16      | 121.4 | 33.08
Other   |            | 8.682      |            |       | 13.77

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.46
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 7

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.58                                                               
Lattice spacing in x,y,z = 5.58 5.58 5.58

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -83.7 ${n1e1} -100 100 -100 100 units box
region box block -83.7 83.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.7 83.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-83.7 -100 -100) to (83.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-83.7 -100 -100) to (83.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-83.7 -100 -100) to (83.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_7_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 108 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.88 | 18.35 | 19.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   167.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   167.4          200            200            0.0025134502   3.54366e-37    0              0.0075403506   12025.091      0              5.8064862e+10  2.6109412e-16  0              3.3356505    
    200000   167.4          200            200            0.00079864162  4.9906638e-37  0              0.0023959248   2465.3109      0              1.1904104e+10  2.6109412e-16  0              3.0964824    
    300000   167.4          200            200           -0.00011035031  1.9525041e-36  0             -0.00033105092  126.39369      0              6.1030987e+08  2.6109412e-16  0              3.0371574    
    400000   167.4          200            200            0.010371422    9.7296212e-36  0              0.031114265    62.422524      0              3.0141603e+08  2.6109412e-16  0              2.9892998    
    500000   167.4          200            200            0.00063940257 -4.3731468e-36  0              0.0019182077   1.3177845      0              6363109.8      2.6109412e-16  0              2.9983635    
    600000   167.4          200            200            0.002284411    2.6879519e-35  0              0.0068532329   1.4891518      0              7190581.1      2.6109412e-16  0              2.9961082    
    700000   167.4          200            200            0.0028815694   3.5702231e-36  0              0.0086447081   0.33979697     0              1640758        2.6109412e-16  0              2.9954665    
    800000   167.4          200            200            0.003058294   -2.2721486e-37  0              0.0091748821   0.057002826    0              275246.25      2.6109412e-16  0              2.995287     
    900000   167.4          200            200            0.0031114247   2.7245889e-37  0              0.009334274    0.0088300812   0              42637.302      2.6109412e-16  0              2.9952342    
   1000000   167.4          200            200            0.003126621    1.4174686e-37  0              0.009379863    0.0013013809   0              6283.9024      2.6109412e-16  0              2.9952193    
   1100000   167.4          200            200            0.003130535    1.3532744e-38  0              0.0093916051   0.00018381953  0              887.59872      2.6109412e-16  0              2.9952155    
   1200000   167.4          200            200            0.0031313339  -3.55379e-39    0              0.0093940018   2.4946508e-05  0              120.45776      2.6109412e-16  0              2.9952148    
   1300000   167.4          200            200            0.0031313868   6.878454e-39   0              0.0093941605   3.2537681e-06  0              15.711282      2.6109412e-16  0              2.9952148    
   1400000   167.4          200            200            0.0031313174   4.7924557e-39  0              0.0093939521   4.072758e-07   0              1.9665891      2.6109412e-16  0              2.9952149    
   1500000   167.4          200            200            0.0031312596   2.7148549e-39  0              0.0093937788   4.8758931e-08  0              0.23543943     2.6109412e-16  0              2.9952149    
   1600000   167.4          200            200            0.0031312269   5.9925913e-39  0              0.0093936808   5.5504849e-09  0              0.026801305    2.6109412e-16  0              2.995215     
   1700000   167.4          200            200            0.0031312109  -1.5410116e-38  0              0.0093936328   5.9501016e-10  0              0.0028730911   2.6109412e-16  0              2.995215     
   1800000   167.4          200            200            0.0031312037   7.9819125e-39  0              0.0093936111   5.9110197e-11  0              0.00028542199  2.6109412e-16  0              2.995215     
   1900000   167.4          200            200            0.0031312006   1.3925876e-38  0              0.0093936018   5.2899449e-12  0              2.5543251e-05  2.6109412e-16  0              2.995215     
   2000000   167.4          200            200            0.0031311993  -2.5213725e-38  0              0.009393598    4.0332668e-13  0              1.9475202e-06  2.6109412e-16  0              2.995215     
   2100000   167.4          200            200            0.0031311988   1.9538602e-38  0              0.0093935964   2.2936397e-14  0              1.1075165e-07  2.6109412e-16  0              2.995215     
   2200000   167.4          200            200            0.0031311986  -1.9263274e-38  0              0.0093935958   5.9402247e-16  0              2.8683219e-09  2.6109412e-16  0              2.995215     
   2300000   167.4          200            200            0.0031311985   2.7823428e-38  0              0.0093935956   6.9940437e-18  0              3.3771734e-11  2.6109412e-16  0              2.995215     
   2400000   167.4          200            200            0.0031311985   3.2031693e-38  0              0.0093935955   2.823529e-17   0              1.3633811e-10  2.6109412e-16  0              2.995215     
   2500000   167.4          200            200            0.0031311985   1.5547791e-38  0              0.0093935955   1.2463298e-17  0              6.0180808e-11  2.6109412e-16  0              2.995215     
   2600000   167.4          200            200            0.0031311985  -4.361464e-38   0              0.0093935955   3.7213477e-18  0              1.7969056e-11  2.6109412e-16  0              2.995215     
   2700000   167.4          200            200            0.0031311985   5.6002492e-39  0              0.0093935955   7.2070254e-19  0              3.4800146e-12  2.6109412e-16  0              2.995215     
   2800000   167.4          200            200            0.0031311985  -1.2574161e-38  0              0.0093935955   1.8281983e-19  0              8.8277153e-13  2.6109412e-16  0              2.995215     
   2900000   167.4          200            200            0.0031311985  -1.4994825e-38  0              0.0093935955   2.3828683e-20  0              1.1506018e-13  2.6109412e-16  0              2.995215     
   3000000   167.4          200            200            0.0031311985   1.4032286e-38  0              0.0093935955   6.9609573e-20  0              3.3611972e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9824 on 4 procs for 3000000 steps with 51 atoms

Performance: 40511151.089 ns/day, 0.000 hours/ns, 46887.906 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29945    | 1.5337     | 5.0089     | 162.1 |  2.40
Neigh   | 0.086349   | 0.086948   | 0.088557   |   0.3 |  0.14
Comm    | 25.866     | 32.471     | 38.167     |  84.0 | 50.75
Output  | 0.058467   | 0.05855    | 0.058611   |   0.0 |  0.09
Modify  | 15.214     | 21.086     | 28.341     | 121.7 | 32.96
Other   |            | 8.746      |            |       | 13.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 8

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.59                                                               
Lattice spacing in x,y,z = 5.59 5.59 5.59

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -83.85 ${n1e1} -100 100 -100 100 units box
region box block -83.85 83.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -83.85 83.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-83.85 -100 -100) to (83.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-83.85 -100 -100) to (83.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-83.85 -100 -100) to (83.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_8_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 109 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.84 | 18.31 | 19.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   167.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   167.7          200            200            0.0025104141  -1.7531042e-37  0              0.0075312422   12035.73       0              5.8116231e+10  2.6109412e-16  0              3.3351984    
    200000   167.7          200            200            0.00080325371 -4.425966e-37   0              0.0024097611   2495.2472      0              1.2048656e+10  2.6109412e-16  0              3.0949363    
    300000   167.7          200            200           -0.00010728983 -5.1070218e-36  0             -0.00032186949  119.07388      0              5.7496513e+08  2.6109412e-16  0              3.0375131    
    400000   167.7          200            200            0.010063145   -2.0081984e-35  0              0.030189436    71.820062      0              3.4679338e+08  2.6109412e-16  0              2.9894957    
    500000   167.7          200            200            0.00065567734  1.8282202e-35  0              0.001967032    1.7714174      0              8553540.6      2.6109412e-16  0              2.9983367    
    600000   167.7          200            200            0.0022579898   1.5578683e-35  0              0.0067739694   1.3400153      0              6470454.3      2.6109412e-16  0              2.9961343    
    700000   167.7          200            200            0.002864664    1.0259845e-36  0              0.0085939921   0.31841514     0              1537512.8      2.6109412e-16  0              2.9954791    
    800000   167.7          200            200            0.0030478722  -6.8333667e-37  0              0.0091436165   0.054411796    0              262735.09      2.6109412e-16  0              2.9952922    
    900000   167.7          200            200            0.0031038861   2.9723701e-37  0              0.0093116583   0.0085489454   0              41279.798      2.6109412e-16  0              2.9952362    
   1000000   167.7          200            200            0.0031202649   2.6153325e-38  0              0.0093607948   0.0012756503   0              6159.6587      2.6109412e-16  0              2.9952201    
   1100000   167.7          200            200            0.0031246465  -1.2211552e-38  0              0.0093739394   0.00018226749  0              880.10447      2.6109412e-16  0              2.9952158    
   1200000   167.7          200            200            0.0031256255  -6.8460432e-39  0              0.0093768764   2.5013148e-05  0              120.77954      2.6109412e-16  0              2.9952149    
   1300000   167.7          200            200            0.0031257463   1.6519721e-39  0              0.0093772389   3.2994239e-06  0              15.931737      2.6109412e-16  0              2.9952148    
   1400000   167.7          200            200            0.0031257019  -3.4051962e-39  0              0.0093771058   4.1791784e-07  0              2.0179757      2.6109412e-16  0              2.9952149    
   1500000   167.7          200            200            0.0031256533   2.7720088e-39  0              0.0093769598   5.0689077e-08  0              0.24475941     2.6109412e-16  0              2.995215     
   1600000   167.7          200            200            0.0031256238  -1.3327186e-39  0              0.0093768714   5.8573845e-09  0              0.028283213    2.6109412e-16  0              2.995215     
   1700000   167.7          200            200            0.0031256089  -2.4870721e-39  0              0.0093768268   6.3945246e-10  0              0.0030876871   2.6109412e-16  0              2.995215     
   1800000   167.7          200            200            0.0031256021  -4.8628157e-39  0              0.0093768063   6.5044722e-11  0              0.00031407768  2.6109412e-16  0              2.995215     
   1900000   167.7          200            200            0.0031255991   8.4219237e-39  0              0.0093767974   6.0192928e-12  0              2.9065011e-05  2.6109412e-16  0              2.995215     
   2000000   167.7          200            200            0.0031255979  -6.7579413e-39  0              0.0093767936   4.8425948e-13  0              2.3383157e-06  2.6109412e-16  0              2.995215     
   2100000   167.7          200            200            0.0031255974   3.0566803e-38  0              0.0093767921   3.0582749e-14  0              1.4767315e-07  2.6109412e-16  0              2.995215     
   2200000   167.7          200            200            0.0031255972   1.9399661e-38  0              0.0093767915   1.1028404e-15  0              5.3252216e-09  2.6109412e-16  0              2.995215     
   2300000   167.7          200            200            0.0031255971  -3.4657382e-38  0              0.0093767913   3.9560586e-19  0              1.9102391e-12  2.6109412e-16  0              2.995215     
   2400000   167.7          200            200            0.0031255971   1.3646611e-38  0              0.0093767912   1.7033115e-17  0              8.2246817e-11  2.6109412e-16  0              2.995215     
   2500000   167.7          200            200            0.0031255971   4.5456808e-39  0              0.0093767912   9.6182902e-18  0              4.6443281e-11  2.6109412e-16  0              2.995215     
   2600000   167.7          200            200            0.0031255971   4.2928381e-39  0              0.0093767912   3.2093903e-18  0              1.5496997e-11  2.6109412e-16  0              2.995215     
   2700000   167.7          200            200            0.0031255971   2.03487e-38    0              0.0093767912   6.8793526e-19  0              3.3217932e-12  2.6109412e-16  0              2.995215     
   2800000   167.7          200            200            0.0031255971  -8.8138836e-39  0              0.0093767912   1.7587985e-19  0              8.4926084e-13  2.6109412e-16  0              2.995215     
   2900000   167.7          200            200            0.0031255971   3.6549424e-38  0              0.0093767912   1.8624582e-22  0              8.993144e-16   2.6109412e-16  0              2.995215     
   3000000   167.7          200            200            0.0031255971  -1.899543e-38   0              0.0093767912   9.8524716e-20  0              4.7574059e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1662 on 4 procs for 3000000 steps with 51 atoms

Performance: 40395111.004 ns/day, 0.000 hours/ns, 46753.601 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29879    | 1.5283     | 4.9473     | 159.8 |  2.38
Neigh   | 0.084901   | 0.085467   | 0.08701    |   0.3 |  0.13
Comm    | 25.619     | 32.587     | 38.295     |  87.2 | 50.78
Output  | 0.060847   | 0.060927   | 0.060988   |   0.0 |  0.09
Modify  | 15.249     | 21.192     | 28.75      | 124.2 | 33.03
Other   |            | 8.713      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 9

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.6                                                               
Lattice spacing in x,y,z = 5.6 5.6 5.6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84 ${n1e1} -100 100 -100 100 units box
region box block -84 84 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84 84 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84 -100 -100) to (84 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84 -100 -100) to (84 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84 -100 -100) to (84 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_9_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 109 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.84 | 18.31 | 19.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   168            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   168            200            200            0.0025073516  -5.7618111e-38  0              0.0075220548   12046.039      0              5.8166009e+10  2.6109412e-16  0              3.3347815    
    200000   168            200            200            0.00080776627  4.9527965e-37  0              0.0024232988   2524.8638      0              1.2191664e+10  2.6109412e-16  0              3.0934304    
    300000   168            200            200           -0.00010379539 -2.2815481e-36  0             -0.00031138616  110.9549       0              5.3576149e+08  2.6109412e-16  0              3.0379099    
    400000   168            200            200            0.0096976107   1.0288235e-35  0              0.029092832    82.737471      0              3.9950964e+08  2.6109412e-16  0              2.989734     
    500000   168            200            200            0.00067702527 -5.2165051e-37  0              0.0020310758   2.3581512      0              11386668       2.6109412e-16  0              2.9983018    
    600000   168            200            200            0.0022303913   4.6979848e-37  0              0.006691174    1.1772521      0              5684529.1      2.6109412e-16  0              2.996162     
    700000   168            200            200            0.0028468307  -3.1557111e-36  0              0.0085404922   0.29405612     0              1419891.8      2.6109412e-16  0              2.9954927    
    800000   168            200            200            0.0030370108   4.0152631e-36  0              0.0091110323   0.051370121    0              248047.93      2.6109412e-16  0              2.9952978    
    900000   168            200            200            0.0030961669   3.0609577e-37  0              0.0092885006   0.008206566    0              39626.57       2.6109412e-16  0              2.9952385    
   1000000   168            200            200            0.0031138455   1.7221496e-37  0              0.0093415366   0.0012422811   0              5998.5306      2.6109412e-16  0              2.9952209    
   1100000   168            200            200            0.0031187444  -3.0744412e-38  0              0.0093562332   0.00017985124  0              868.43726      2.6109412e-16  0              2.9952162    
   1200000   168            200            200            0.0031199239   1.8640636e-38  0              0.0093597718   2.4994901e-05  0              120.69143      2.6109412e-16  0              2.9952151    
   1300000   168            200            200            0.0031201208   1.0376335e-38  0              0.0093603623   3.3388216e-06  0              16.121975      2.6109412e-16  0              2.9952149    
   1400000   168            200            200            0.0031201046   1.0400605e-38  0              0.0093603138   4.2848597e-07  0              2.0690054      2.6109412e-16  0              2.9952149    
   1500000   168            200            200            0.0031200662   5.3185042e-39  0              0.0093601987   5.2714475e-08  0              0.25453933     2.6109412e-16  0              2.995215     
   1600000   168            200            200            0.0031200405  -4.5326067e-39  0              0.0093601214   6.1903923e-09  0              0.029891189    2.6109412e-16  0              2.995215     
   1700000   168            200            200            0.0031200269   2.5249577e-38  0              0.0093600806   6.8893772e-10  0              0.0033266337   2.6109412e-16  0              2.995215     
   1800000   168            200            200            0.0031200205   1.3448728e-38  0              0.0093600614   7.1811082e-11  0              0.00034675001  2.6109412e-16  0              2.995215     
   1900000   168            200            200            0.0031200176  -1.7587306e-38  0              0.0093600529   6.8727086e-12  0              3.318585e-05   2.6109412e-16  0              2.995215     
   2000000   168            200            200            0.0031200164  -2.3863312e-38  0              0.0093600493   5.822283e-13   0              2.8113721e-06  2.6109412e-16  0              2.995215     
   2100000   168            200            200            0.003120016    9.4102568e-39  0              0.0093600479   4.0428421e-14  0              1.9521438e-07  2.6109412e-16  0              2.995215     
   2200000   168            200            200            0.0031200158   1.8100383e-38  0              0.0093600473   1.8681206e-15  0              9.0204857e-09  2.6109412e-16  0              2.995215     
   2300000   168            200            200            0.0031200157   3.5310275e-38  0              0.009360047    1.9175458e-17  0              9.2591426e-11  2.6109412e-16  0              2.995215     
   2400000   168            200            200            0.0031200157   2.2607823e-38  0              0.009360047    7.5426088e-18  0              3.6420558e-11  2.6109412e-16  0              2.995215     
   2500000   168            200            200            0.0031200156  -1.5704293e-39  0              0.0093600469   6.7726264e-18  0              3.2702589e-11  2.6109412e-16  0              2.995215     
   2600000   168            200            200            0.0031200156   1.9737006e-38  0              0.0093600469   2.5886723e-18  0              1.2499772e-11  2.6109412e-16  0              2.995215     
   2700000   168            200            200            0.0031200156  -8.7411326e-39  0              0.0093600469   5.8461726e-19  0              2.8229075e-12  2.6109412e-16  0              2.995215     
   2800000   168            200            200            0.0031200156  -9.0239343e-39  0              0.0093600469   1.5793212e-19  0              7.6259769e-13  2.6109412e-16  0              2.995215     
   2900000   168            200            200            0.0031200156   2.1026449e-38  0              0.0093600469   4.2911499e-21  0              2.0720427e-14  2.6109412e-16  0              2.995215     
   3000000   168            200            200            0.0031200156   5.3342434e-39  0              0.0093600469   1.4013406e-19  0              6.7665725e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1345 on 4 procs for 3000000 steps with 51 atoms

Performance: 40415064.611 ns/day, 0.000 hours/ns, 46776.695 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30921    | 1.5473     | 5.0403     | 162.2 |  2.41
Neigh   | 0.084898   | 0.085478   | 0.087082   |   0.3 |  0.13
Comm    | 25.627     | 32.532     | 38.309     |  86.7 | 50.72
Output  | 0.062553   | 0.062634   | 0.062697   |   0.0 |  0.10
Modify  | 15.154     | 21.118     | 28.65      | 123.9 | 32.93
Other   |            | 8.789      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 10

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.61                                                               
Lattice spacing in x,y,z = 5.61 5.61 5.61

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84.15 ${n1e1} -100 100 -100 100 units box
region box block -84.15 84.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.15 84.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84.15 -100 -100) to (84.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84.15 -100 -100) to (84.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84.15 -100 -100) to (84.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_10_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 109 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.84 | 18.31 | 19.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   168.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   168.3          200            200            0.0025042625   1.0476801e-39  0              0.0075127875   12056.017      0              5.8214193e+10  2.6109412e-16  0              3.3343988    
    200000   168.3          200            200            0.00081210858 -3.7262679e-36  0              0.0024363257   2553.7951      0              1.2331363e+10  2.6109412e-16  0              3.0919854    
    300000   168.3          200            200           -9.9924478e-05  6.4774075e-38  0             -0.00029977343  102.29844      0              4.9396254e+08  2.6109412e-16  0              3.0383369    
    400000   168.3          200            200            0.009283831    1.4324026e-35  0              0.027851493    94.699533      0              4.5727015e+08  2.6109412e-16  0              2.9900103    
    500000   168.3          200            200            0.00070331481  7.0213949e-36  0              0.0021099444   3.0706861      0              14827244       2.6109412e-16  0              2.998259     
    600000   168.3          200            200            0.0022031178  -2.5798421e-35  0              0.0066093533   1.0108232      0              4880903.5      2.6109412e-16  0              2.9961897    
    700000   168.3          200            200            0.0028287971   1.5867685e-36  0              0.0084863914   0.26793112     0              1293743.5      2.6109412e-16  0              2.9955067    
    800000   168.3          200            200            0.0030260038  -3.4841992e-36  0              0.0090780115   0.048004744    0              231797.73      2.6109412e-16  0              2.9953037    
    900000   168.3          200            200            0.0030883802  -1.8185524e-37  0              0.0092651406   0.0078139527   0              37730.781      2.6109412e-16  0              2.9952408    
   1000000   168.3          200            200            0.0031074052  -1.7886922e-37  0              0.0093222155   0.0012018249   0              5803.1821      2.6109412e-16  0              2.9952219    
   1100000   168.3          200            200            0.0031128444   6.1694755e-38  0              0.0093385331   0.00017651369  0              852.32145      2.6109412e-16  0              2.9952165    
   1200000   168.3          200            200            0.0031142348  -1.1630171e-38  0              0.0093427044   2.4866906e-05  0              120.07339      2.6109412e-16  0              2.9952152    
   1300000   168.3          200            200            0.0031145121   1.914134e-39   0              0.0093435363   3.3665524e-06  0              16.255877      2.6109412e-16  0              2.9952149    
   1400000   168.3          200            200            0.003114526    3.4142187e-39  0              0.009343578    4.3802964e-07  0              2.1150884      2.6109412e-16  0              2.9952149    
   1500000   168.3          200            200            0.0031144986   3.686514e-39   0              0.0093434959   5.4687133e-08  0              0.26406459     2.6109412e-16  0              2.995215     
   1600000   168.3          200            200            0.0031144768   8.3456202e-39  0              0.0093434305   6.5284409e-09  0              0.031523505    2.6109412e-16  0              2.995215     
   1700000   168.3          200            200            0.0031144646  -4.1776097e-39  0              0.0093433939   7.4070449e-10  0              0.0035765969   2.6109412e-16  0              2.995215     
   1800000   168.3          200            200            0.0031144587   2.6008955e-38  0              0.0093433761   7.9079312e-11  0              0.0003818457   2.6109412e-16  0              2.995215     
   1900000   168.3          200            200            0.003114456    2.2338386e-38  0              0.0093433681   7.8142073e-12  0              3.7732011e-05  2.6109412e-16  0              2.995215     
   2000000   168.3          200            200            0.0031144549   4.9238625e-39  0              0.0093433647   6.9398245e-13  0              3.3509929e-06  2.6109412e-16  0              2.995215     
   2100000   168.3          200            200            0.0031144544   2.6976358e-38  0              0.0093433633   5.2272417e-14  0              2.524048e-07   2.6109412e-16  0              2.995215     
   2200000   168.3          200            200            0.0031144542  -1.5804369e-38  0              0.0093433627   2.890987e-15   0              1.3959541e-08  2.6109412e-16  0              2.995215     
   2300000   168.3          200            200            0.0031144542   2.4974453e-38  0              0.0093433625   7.0019468e-17  0              3.3809895e-10  2.6109412e-16  0              2.995215     
   2400000   168.3          200            200            0.0031144541   4.1372178e-38  0              0.0093433624   1.6916033e-18  0              8.1681471e-12  2.6109412e-16  0              2.995215     
   2500000   168.3          200            200            0.0031144541  -1.9615691e-38  0              0.0093433624   4.3804361e-18  0              2.1151558e-11  2.6109412e-16  0              2.995215     
   2600000   168.3          200            200            0.0031144541   2.3374186e-38  0              0.0093433623   2.0276085e-18  0              9.7905958e-12  2.6109412e-16  0              2.995215     
   2700000   168.3          200            200            0.0031144541   2.7634405e-38  0              0.0093433623   4.816645e-19   0              2.3257855e-12  2.6109412e-16  0              2.995215     
   2800000   168.3          200            200            0.0031144541   2.6236587e-38  0              0.0093433623   1.4154681e-19  0              6.8347891e-13  2.6109412e-16  0              2.995215     
   2900000   168.3          200            200            0.0031144541   1.2806009e-38  0              0.0093433623   9.1089922e-20  0              4.3984063e-13  2.6109412e-16  0              2.995215     
   3000000   168.3          200            200            0.0031144541  -2.1501395e-38  0              0.0093433623   4.5141484e-21  0              2.1797207e-14  2.6109412e-16  0              2.995215     
Loop time of 64.0732 on 4 procs for 3000000 steps with 51 atoms

Performance: 40453755.900 ns/day, 0.000 hours/ns, 46821.477 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30769    | 1.5562     | 5.0702     | 162.7 |  2.43
Neigh   | 0.084889   | 0.085481   | 0.087014   |   0.3 |  0.13
Comm    | 25.741     | 32.553     | 38.278     |  85.9 | 50.81
Output  | 0.061468   | 0.061548   | 0.061613   |   0.0 |  0.10
Modify  | 15.201     | 21.125     | 28.557     | 123.2 | 32.97
Other   |            | 8.691      |            |       | 13.56

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 11

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.62                                                               
Lattice spacing in x,y,z = 5.62 5.62 5.62

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84.3 ${n1e1} -100 100 -100 100 units box
region box block -84.3 84.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.3 84.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84.3 -100 -100) to (84.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84.3 -100 -100) to (84.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84.3 -100 -100) to (84.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_11_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 109 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.84 | 18.31 | 19.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   168.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   168.6          200            200            0.0025011466  -4.668858e-37   0              0.0075034398   12065.667      0              5.8260789e+10  2.6109412e-16  0              3.3340491    
    200000   168.6          200            200            0.00081623151  2.2922979e-38  0              0.0024486945   2581.7781      0              1.2466482e+10  2.6109412e-16  0              3.0906161    
    300000   168.6          200            200           -9.5476172e-05 -2.742462e-36   0             -0.00028642852  92.790776      0              4.4805345e+08  2.6109412e-16  0              3.0388097    
    400000   168.6          200            200            0.0087956881   3.4297841e-36  0              0.026387064    108.20866      0              5.2250087e+08  2.6109412e-16  0              2.9903452    
    500000   168.6          200            200            0.00073731943 -4.1381238e-36  0              0.0022119583   3.9720809      0              19179757       2.6109412e-16  0              2.998204     
    600000   168.6          200            200            0.0021753576  -7.0233626e-36  0              0.0065260728   0.83455188     0              4029752.4      2.6109412e-16  0              2.9962183    
    700000   168.6          200            200            0.0028099995  -2.2772458e-37  0              0.0084299986   0.23871148     0              1152652.3      2.6109412e-16  0              2.9955216    
    800000   168.6          200            200            0.0030145871   1.2139368e-36  0              0.0090437612   0.044114448    0              213012.88      2.6109412e-16  0              2.9953101    
    900000   168.6          200            200            0.0030804126   2.9946534e-37  0              0.0092412378   0.0073436597   0              35459.904      2.6109412e-16  0              2.9952434    
   1000000   168.6          200            200            0.0031008972  -5.9260465e-38  0              0.0093026917   0.0011508411   0              5556.9996      2.6109412e-16  0              2.9952229    
   1100000   168.6          200            200            0.0031069277   7.8313886e-38  0              0.0093207831   0.0001718628   0              829.86395      2.6109412e-16  0              2.9952169    
   1200000   168.6          200            200            0.0031085508   1.4202063e-38  0              0.0093256523   2.4590183e-05  0              118.73719      2.6109412e-16  0              2.9952153    
   1300000   168.6          200            200            0.0031089174   7.4948961e-39  0              0.0093267523   3.3796515e-06  0              16.319127      2.6109412e-16  0              2.995215     
   1400000   168.6          200            200            0.003108965   -1.7804052e-38  0              0.0093268949   4.4649112e-07  0              2.1559458      2.6109412e-16  0              2.995215     
   1500000   168.6          200            200            0.00310895     7.0880478e-39  0              0.00932685     5.6646222e-08  0              0.27352433     2.6109412e-16  0              2.995215     
   1600000   168.6          200            200            0.0031089327  -2.9398621e-39  0              0.009326798    6.8827838e-09  0              0.0332345      2.6109412e-16  0              2.995215     
   1700000   168.6          200            200            0.0031089221   2.1081679e-38  0              0.0093267662   7.9695142e-10  0              0.0038481932   2.6109412e-16  0              2.995215     
   1800000   168.6          200            200            0.0031089167   1.0134155e-41  0              0.0093267501   8.7215313e-11  0              0.00042113153  2.6109412e-16  0              2.995215     
   1900000   168.6          200            200            0.0031089142   1.0939016e-38  0              0.0093267426   8.8990441e-12  0              4.2970299e-05  2.6109412e-16  0              2.995215     
   2000000   168.6          200            200            0.0031089131  -3.0233901e-38  0              0.0093267394   8.2715296e-13  0              3.9940256e-06  2.6109412e-16  0              2.995215     
   2100000   168.6          200            200            0.0031089127  -2.7690519e-39  0              0.009326738    6.7009182e-14  0              3.2356336e-07  2.6109412e-16  0              2.995215     
   2200000   168.6          200            200            0.0031089125   1.1151237e-38  0              0.0093267375   4.2848976e-15  0              2.0690237e-08  2.6109412e-16  0              2.995215     
   2300000   168.6          200            200            0.0031089124   1.7095312e-38  0              0.0093267373   1.6373754e-16  0              7.9062996e-10  2.6109412e-16  0              2.995215     
   2400000   168.6          200            200            0.0031089124   1.8803663e-38  0              0.0093267372   9.4039484e-20  0              4.5408301e-13  2.6109412e-16  0              2.995215     
   2500000   168.6          200            200            0.0031089124   3.0990448e-38  0              0.0093267372   2.2681523e-18  0              1.0952095e-11  2.6109412e-16  0              2.995215     
   2600000   168.6          200            200            0.0031089124  -1.0214566e-38  0              0.0093267371   1.5211506e-18  0              7.345092e-12   2.6109412e-16  0              2.995215     
   2700000   168.6          200            200            0.0031089124   1.5922492e-38  0              0.0093267371   3.4988978e-19  0              1.6894925e-12  2.6109412e-16  0              2.995215     
   2800000   168.6          200            200            0.0031089124   4.0063433e-38  0              0.0093267371   1.1830289e-19  0              5.712423e-13   2.6109412e-16  0              2.995215     
   2900000   168.6          200            200            0.0031089124  -4.6506117e-38  0              0.0093267371   4.2642769e-20  0              2.0590667e-13  2.6109412e-16  0              2.995215     
   3000000   168.6          200            200            0.0031089124   3.2620541e-39  0              0.0093267371   3.3701343e-20  0              1.6273172e-13  2.6109412e-16  0              2.995215     
Loop time of 64.4088 on 4 procs for 3000000 steps with 51 atoms

Performance: 40242922.342 ns/day, 0.000 hours/ns, 46577.456 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29552    | 1.5572     | 5.0715     | 162.7 |  2.42
Neigh   | 0.085881   | 0.086469   | 0.088022   |   0.3 |  0.13
Comm    | 25.806     | 32.83      | 38.636     |  87.5 | 50.97
Output  | 0.060661   | 0.060739   | 0.0608     |   0.0 |  0.09
Modify  | 15.185     | 21.177     | 28.821     | 124.9 | 32.88
Other   |            | 8.697      |            |       | 13.50

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 12

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.63                                                               
Lattice spacing in x,y,z = 5.63 5.63 5.63

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84.45 ${n1e1} -100 100 -100 100 units box
region box block -84.45 84.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.45 84.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84.45 -100 -100) to (84.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84.45 -100 -100) to (84.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84.45 -100 -100) to (84.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_12_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 109 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.84 | 18.31 | 19.47 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   168.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   168.9          200            200            0.0024980038   2.9284604e-37  0              0.0074940115   12074.99       0              5.8305804e+10  2.6109412e-16  0              3.333731     
    200000   168.9          200            200            0.00082010129 -1.147728e-36   0              0.0024603039   2608.6232      0              1.2596108e+10  2.6109412e-16  0              3.0893326    
    300000   168.9          200            200           -9.0450733e-05  4.7340708e-36  0             -0.0002713522   82.643315      0              3.9905499e+08  2.6109412e-16  0              3.0393201    
    400000   168.9          200            200            0.0082387063   2.6012846e-35  0              0.024716119    122.71166      0              5.9253068e+08  2.6109412e-16  0              2.9907382    
    500000   168.9          200            200            0.00077960426  1.8230041e-35  0              0.0023388128   5.0635448      0              24450045       2.6109412e-16  0              2.9981363    
    600000   168.9          200            200            0.0021484486  -7.1910707e-36  0              0.0064453458   0.65821537     0              3178286.4      2.6109412e-16  0              2.9962462    
    700000   168.9          200            200            0.0027910618  -1.915241e-37   0              0.0083731854   0.20754584     0              1002164.6      2.6109412e-16  0              2.9955369    
    800000   168.9          200            200            0.0030030067   2.1303448e-36  0              0.0090090202   0.03981458     0              192250.36      2.6109412e-16  0              2.9953167    
    900000   168.9          200            200            0.003072357    5.9785681e-37  0              0.009217071    0.006804812    0              32858.002      2.6109412e-16  0              2.9952461    
   1000000   168.9          200            200            0.0030943558   4.0356716e-37  0              0.0092830673   0.0010896021   0              5261.2988      2.6109412e-16  0              2.9952239    
   1100000   168.9          200            200            0.0031010066   2.4333996e-38  0              0.0093030199   0.0001658033   0              800.60478      2.6109412e-16  0              2.9952173    
   1200000   168.9          200            200            0.0031028761  -4.1796782e-38  0              0.0093086282   2.4135056e-05  0              116.53955      2.6109412e-16  0              2.9952155    
   1300000   168.9          200            200            0.0031033382  -2.3373171e-38  0              0.0093100146   3.3721547e-06  0              16.282928      2.6109412e-16  0              2.995215     
   1400000   168.9          200            200            0.0031034219   3.6203096e-39  0              0.0093102658   4.5286364e-07  0              2.1867165      2.6109412e-16  0              2.995215     
   1500000   168.9          200            200            0.0031034204   1.5187707e-38  0              0.0093102612   5.8439197e-08  0              0.28218197     2.6109412e-16  0              2.995215     
   1600000   168.9          200            200            0.003103408   -9.9301101e-39  0              0.0093102239   7.2321607e-09  0              0.034921516    2.6109412e-16  0              2.995215     
   1700000   168.9          200            200            0.0031033991   1.3513928e-38  0              0.0093101973   8.5495259e-10  0              0.0041282601   2.6109412e-16  0              2.995215     
   1800000   168.9          200            200            0.0031033943  -8.0798589e-39  0              0.009310183    9.5898583e-11  0              0.00046305994  2.6109412e-16  0              2.995215     
   1900000   168.9          200            200            0.0031033921   2.2288363e-39  0              0.0093101762   1.0094573e-11  0              4.874308e-05   2.6109412e-16  0              2.995215     
   2000000   168.9          200            200            0.0031033911   3.7113883e-38  0              0.0093101732   9.7893742e-13  0              4.7269384e-06  2.6109412e-16  0              2.995215     
   2100000   168.9          200            200            0.0031033906   1.8094021e-39  0              0.0093101719   8.4603988e-14  0              4.0852238e-07  2.6109412e-16  0              2.995215     
   2200000   168.9          200            200            0.0031033904   4.0185636e-39  0              0.0093101713   6.0831725e-15  0              2.9373463e-08  2.6109412e-16  0              2.995215     
   2300000   168.9          200            200            0.0031033904  -1.0911177e-38  0              0.0093101711   3.0845e-16     0              1.4893946e-09  2.6109412e-16  0              2.995215     
   2400000   168.9          200            200            0.0031033903   3.920125e-38   0              0.009310171    4.2784615e-18  0              2.0659159e-11  2.6109412e-16  0              2.995215     
   2500000   168.9          200            200            0.0031033903   3.5854966e-38  0              0.009310171    7.4183808e-19  0              3.5820706e-12  2.6109412e-16  0              2.995215     
   2600000   168.9          200            200            0.0031033903   1.5633036e-38  0              0.009310171    1.0000673e-18  0              4.8289669e-12  2.6109412e-16  0              2.995215     
   2700000   168.9          200            200            0.0031033903   1.1476517e-38  0              0.009310171    2.7605299e-19  0              1.3329611e-12  2.6109412e-16  0              2.995215     
   2800000   168.9          200            200            0.0031033903  -9.3460751e-39  0              0.009310171    1.0046876e-19  0              4.8512766e-13  2.6109412e-16  0              2.995215     
   2900000   168.9          200            200            0.0031033903   2.7082749e-38  0              0.009310171    1.6817806e-20  0              8.1207166e-14  2.6109412e-16  0              2.995215     
   3000000   168.9          200            200            0.0031033903   2.4370526e-38  0              0.009310171    1.3379882e-19  0              6.4606664e-13  2.6109412e-16  0              2.995215     
Loop time of 64.117 on 4 procs for 3000000 steps with 51 atoms

Performance: 40426098.412 ns/day, 0.000 hours/ns, 46789.466 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31008    | 1.5556     | 5.0802     | 163.2 |  2.43
Neigh   | 0.085871   | 0.086458   | 0.088013   |   0.3 |  0.13
Comm    | 25.658     | 32.542     | 38.334     |  86.7 | 50.75
Output  | 0.099972   | 0.10005    | 0.10011    |   0.0 |  0.16
Modify  | 15.188     | 21.125     | 28.632     | 123.9 | 32.95
Other   |            | 8.708      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 13

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.64                                                               
Lattice spacing in x,y,z = 5.64 5.64 5.64

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84.6 ${n1e1} -100 100 -100 100 units box
region box block -84.6 84.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.6 84.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84.6 -100 -100) to (84.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84.6 -100 -100) to (84.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84.6 -100 -100) to (84.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_13_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 110 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.86 | 18.33 | 19.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   169.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   169.2          200            200            0.0024948343   2.922108e-37   0              0.007484503    12083.988      0              5.8349253e+10  2.6109412e-16  0              3.3334432    
    200000   169.2          200            200            0.00082369693 -6.8335778e-37  0              0.0024710908   2634.204       0              1.2719628e+10  2.6109412e-16  0              3.088141     
    300000   169.2          200            200           -8.4566273e-05 -4.0630718e-37  0             -0.00025369882  71.561145      0              3.4554316e+08  2.6109412e-16  0              3.0398838    
    400000   169.2          200            200            0.0075790381   4.8442644e-35  0              0.022737114    138.5159       0              6.6884371e+08  2.6109412e-16  0              2.9912192    
    500000   169.2          200            200            0.00083494915 -4.2691196e-36  0              0.0025048475   6.4399494      0              31096211       2.6109412e-16  0              2.9980491    
    600000   169.2          200            200            0.0021219836  -4.1120878e-35  0              0.0063659509   0.47861683     0              2311069.4      2.6109412e-16  0              2.9962741    
    700000   169.2          200            200            0.002771507   -3.4246932e-36  0              0.008314521    0.17317613     0              836205.53      2.6109412e-16  0              2.9955529    
    800000   169.2          200            200            0.0029910102   2.3950469e-37  0              0.0089730307   0.034879541    0              168420.82      2.6109412e-16  0              2.9953237    
    900000   169.2          200            200            0.0030640968  -3.8581699e-38  0              0.0091922903   0.0061626439   0              29757.202      2.6109412e-16  0              2.995249     
   1000000   169.2          200            200            0.0030877304   6.8862377e-37  0              0.0092631911   0.0010132201   0              4892.477       2.6109412e-16  0              2.9952251    
   1100000   169.2          200            200            0.0030950601  -1.3964994e-37  0              0.0092851804   0.00015770122  0              761.48273      2.6109412e-16  0              2.9952178    
   1200000   169.2          200            200            0.0030972022  -1.8391245e-38  0              0.0092916066   2.3426156e-05  0              113.11653      2.6109412e-16  0              2.9952157    
   1300000   169.2          200            200            0.003097771    1.7719841e-38  0              0.0092933129   3.3360654e-06  0              16.108666      2.6109412e-16  0              2.9952151    
   1400000   169.2          200            200            0.0030978955   2.3702981e-40  0              0.0092936864   4.564469e-07   0              2.2040187      2.6109412e-16  0              2.995215     
   1500000   169.2          200            200            0.0030979092   2.0811561e-39  0              0.0092937277   6.0030274e-08  0              0.28986471     2.6109412e-16  0              2.995215     
   1600000   169.2          200            200            0.0030979024   2.3765774e-38  0              0.0092937072   7.5801011e-09  0              0.036601595    2.6109412e-16  0              2.995215     
   1700000   169.2          200            200            0.0030978956  -4.452823e-39   0              0.0092936867   9.162677e-10   0              0.0044243288   2.6109412e-16  0              2.995215     
   1800000   169.2          200            200            0.0030978915   1.340238e-38   0              0.0092936745   1.0546736e-10  0              0.00050926413  2.6109412e-16  0              2.995215     
   1900000   169.2          200            200            0.0030978895   1.0239502e-38  0              0.0092936684   1.1460206e-11  0              5.5337232e-05  2.6109412e-16  0              2.995215     
   2000000   169.2          200            200            0.0030978885   6.0641876e-39  0              0.0092936656   1.1586968e-12  0              5.594932e-06   2.6109412e-16  0              2.995215     
   2100000   169.2          200            200            0.0030978881   1.3722443e-38  0              0.0092936644   1.0632146e-13  0              5.1338827e-07  2.6109412e-16  0              2.995215     
   2200000   169.2          200            200            0.003097888   -8.6160238e-39  0              0.0092936639   8.4417637e-15  0              4.0762256e-08  2.6109412e-16  0              2.995215     
   2300000   169.2          200            200            0.0030978879   3.3827365e-38  0              0.0092936637   5.2403847e-16  0              2.5303942e-09  2.6109412e-16  0              2.995215     
   2400000   169.2          200            200            0.0030978879  -9.255093e-40   0              0.0092936636   1.6632458e-17  0              8.0312188e-11  2.6109412e-16  0              2.995215     
   2500000   169.2          200            200            0.0030978879   2.0156446e-38  0              0.0092936636   1.7284945e-20  0              8.3462813e-14  2.6109412e-16  0              2.995215     
   2600000   169.2          200            200            0.0030978879   1.3386112e-38  0              0.0092936636   5.5062675e-19  0              2.6587795e-12  2.6109412e-16  0              2.995215     
   2700000   169.2          200            200            0.0030978879   4.3554335e-39  0              0.0092936636   1.7931203e-19  0              8.6583364e-13  2.6109412e-16  0              2.995215     
   2800000   169.2          200            200            0.0030978879   1.1378569e-38  0              0.0092936636   8.2873948e-20  0              4.0016864e-13  2.6109412e-16  0              2.995215     
   2900000   169.2          200            200            0.0030978879   4.1849875e-38  0              0.0092936636   5.8932973e-20  0              2.8456624e-13  2.6109412e-16  0              2.995215     
   3000000   169.2          200            200            0.0030978879   2.0057866e-39  0              0.0092936636   3.1931902e-20  0              1.5418773e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9682 on 4 procs for 3000000 steps with 51 atoms

Performance: 40520132.685 ns/day, 0.000 hours/ns, 46898.302 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3004     | 1.5316     | 4.9694     | 160.5 |  2.39
Neigh   | 0.086701   | 0.087274   | 0.088852   |   0.3 |  0.14
Comm    | 25.606     | 32.441     | 38.227     |  86.2 | 50.71
Output  | 0.061727   | 0.061808   | 0.061873   |   0.0 |  0.10
Modify  | 15.162     | 21.08      | 28.513     | 123.2 | 32.95
Other   |            | 8.767      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 14

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.65                                                               
Lattice spacing in x,y,z = 5.65 5.65 5.65

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84.75 ${n1e1} -100 100 -100 100 units box
region box block -84.75 84.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.75 84.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84.75 -100 -100) to (84.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84.75 -100 -100) to (84.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84.75 -100 -100) to (84.75 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_14_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 110 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.86 | 18.33 | 19.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   169.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   169.5          200            200            0.0024916382  -5.7364637e-38  0              0.0074749145   12092.665      0              5.839115e+10   2.6109412e-16  0              3.3331844    
    200000   169.5          200            200            0.00082700643 -1.1485713e-36  0              0.0024810193   2658.439       0              1.283665e+10   2.6109412e-16  0              3.0870449    
    300000   169.5          200            200           -7.771794e-05   5.6651466e-38  0             -0.00023315382  59.758424      0              2.8855204e+08  2.6109412e-16  0              3.0404934    
    400000   169.5          200            200            0.0068161091  -3.4452829e-36  0              0.020448327    154.75295      0              7.4724659e+08  2.6109412e-16  0              2.9917971    
    500000   169.5          200            200            0.00090613258  7.0072969e-36  0              0.0027183977   8.1282195      0              39248263       2.6109412e-16  0              2.9979389    
    600000   169.5          200            200            0.0020974762  -7.5589357e-36  0              0.0062924286   0.3079992      0              1487217.9      2.6109412e-16  0              2.9963001    
    700000   169.5          200            200            0.0027519457   3.6283895e-36  0              0.0082558371   0.13686994     0              660895.94      2.6109412e-16  0              2.9955691    
    800000   169.5          200            200            0.0029788171  -2.5434925e-36  0              0.0089364514   0.029416851    0              142043.45      2.6109412e-16  0              2.9953311    
    900000   169.5          200            200            0.0030557075   4.4195498e-37  0              0.0091671224   0.0054221763   0              26181.749      2.6109412e-16  0              2.9952522    
   1000000   169.5          200            200            0.003081046    1.0795621e-37  0              0.009243138    0.0009210447   0              4447.3952      2.6109412e-16  0              2.9952264    
   1100000   169.5          200            200            0.0030890962   8.1234147e-38  0              0.0092672887   0.00014729658  0              711.24245      2.6109412e-16  0              2.9952183    
   1200000   169.5          200            200            0.0030915316  -7.1630306e-39  0              0.0092745947   2.2407867e-05  0              108.19957      2.6109412e-16  0              2.9952159    
   1300000   169.5          200            200            0.0030922164  -1.1256316e-38  0              0.0092766491   3.2616894e-06  0              15.749531      2.6109412e-16  0              2.9952152    
   1400000   169.5          200            200            0.0030923857  -7.2299463e-39  0              0.0092771571   4.5573903e-07  0              2.2006007      2.6109412e-16  0              2.995215     
   1500000   169.5          200            200            0.0030924164   1.4537718e-38  0              0.0092772493   6.1206527e-08  0              0.29554442     2.6109412e-16  0              2.995215     
   1600000   169.5          200            200            0.0030924159  -2.0581207e-39  0              0.0092772477   7.898752e-09   0              0.038140247    2.6109412e-16  0              2.995215     
   1700000   169.5          200            200            0.0030924113   3.5183133e-38  0              0.009277234    9.7757017e-10  0              0.0047203365   2.6109412e-16  0              2.995215     
   1800000   169.5          200            200            0.0030924081   1.8432874e-38  0              0.0092772243   1.1557237e-10  0              0.00055805762  2.6109412e-16  0              2.995215     
   1900000   169.5          200            200            0.0030924063  -2.8388124e-38  0              0.009277219    1.2965013e-11  0              6.2603405e-05  2.6109412e-16  0              2.995215     
   2000000   169.5          200            200            0.0030924055   3.7713745e-39  0              0.0092772165   1.3650208e-12  0              6.5911969e-06  2.6109412e-16  0              2.995215     
   2100000   169.5          200            200            0.0030924051   3.3197256e-38  0              0.0092772154   1.324294e-13   0              6.3945417e-07  2.6109412e-16  0              2.995215     
   2200000   169.5          200            200            0.003092405    5.4075295e-39  0              0.009277215    1.1456911e-14  0              5.5321322e-08  2.6109412e-16  0              2.995215     
   2300000   169.5          200            200            0.0030924049  -6.8033976e-39  0              0.0092772148   8.2555386e-16  0              3.9863041e-09  2.6109412e-16  0              2.995215     
   2400000   169.5          200            200            0.0030924049   2.0274344e-38  0              0.0092772147   3.9683022e-17  0              1.9161511e-10  2.6109412e-16  0              2.995215     
   2500000   169.5          200            200            0.0030924049  -2.7810109e-38  0              0.0092772147   4.8815623e-19  0              2.3571318e-12  2.6109412e-16  0              2.995215     
   2600000   169.5          200            200            0.0030924049   2.3558175e-38  0              0.0092772146   1.8169348e-19  0              8.7733279e-13  2.6109412e-16  0              2.995215     
   2700000   169.5          200            200            0.0030924049  -2.9140769e-38  0              0.0092772146   9.8503423e-20  0              4.7563778e-13  2.6109412e-16  0              2.995215     
   2800000   169.5          200            200            0.0030924049  -7.6426083e-39  0              0.0092772146   6.2425391e-20  0              3.0142987e-13  2.6109412e-16  0              2.995215     
   2900000   169.5          200            200            0.0030924049   1.9078185e-38  0              0.0092772146   2.3046782e-20  0              1.1128466e-13  2.6109412e-16  0              2.995215     
   3000000   169.5          200            200            0.0030924049  -1.3488514e-38  0              0.0092772146   8.5501087e-20  0              4.1285415e-13  2.6109412e-16  0              2.995215     
Loop time of 64.3417 on 4 procs for 3000000 steps with 51 atoms

Performance: 40284914.424 ns/day, 0.000 hours/ns, 46626.058 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28833    | 1.5686     | 5.1218     | 163.9 |  2.44
Neigh   | 0.086641   | 0.087148   | 0.088617   |   0.3 |  0.14
Comm    | 25.684     | 32.786     | 38.644     |  88.4 | 50.96
Output  | 0.061909   | 0.06199    | 0.062057   |   0.0 |  0.10
Modify  | 15.205     | 21.194     | 28.879     | 125.7 | 32.94
Other   |            | 8.644      |            |       | 13.43

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 15

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.66                                                               
Lattice spacing in x,y,z = 5.66 5.66 5.66

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -84.9 ${n1e1} -100 100 -100 100 units box
region box block -84.9 84.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -84.9 84.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-84.9 -100 -100) to (84.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-84.9 -100 -100) to (84.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-84.9 -100 -100) to (84.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_15_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 110 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.86 | 18.33 | 19.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   169.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   169.8          200            200            0.0024884155  -3.4767149e-37  0              0.0074652466   12101.024      0              5.8431513e+10  2.6109412e-16  0              3.332953     
    200000   169.8          200            200            0.00083002451  1.1745281e-36  0              0.0024900735   2681.281       0              1.2946946e+10  2.6109412e-16  0              3.0860455    
    300000   169.8          200            200           -6.9630848e-05 -3.1987754e-36  0             -0.00020889254  47.31562       0              2.284702e+08   2.6109412e-16  0              3.0411484    
    400000   169.8          200            200            0.0059338916  -3.4605378e-36  0              0.017801675    170.5418       0              8.2348532e+08  2.6109412e-16  0              2.992497     
    500000   169.8          200            200            0.00099921019  3.6640807e-35  0              0.0029976306   10.202303      0              49263272       2.6109412e-16  0              2.9977984    
    600000   169.8          200            200            0.0020761506   1.0784311e-35  0              0.0062284517   0.15715347     0              758837.84      2.6109412e-16  0              2.9963228    
    700000   169.8          200            200            0.0027326824   2.7203133e-36  0              0.0081980471   0.099341521    0              479684.65      2.6109412e-16  0              2.9955852    
    800000   169.8          200            200            0.0029664884   2.0803219e-36  0              0.0088994651   0.023435463    0              113161.46      2.6109412e-16  0              2.9953387    
    900000   169.8          200            200            0.003047192    5.6287707e-37  0              0.009141576    0.0045732045   0              22082.368      2.6109412e-16  0              2.9952555    
   1000000   169.8          200            200            0.0030742966  -1.4269948e-38  0              0.0092228898   0.00081027394  0              3912.5229      2.6109412e-16  0              2.9952278    
   1100000   169.8          200            200            0.00308311     1.9411732e-38  0              0.0092493299   0.00013404839  0              647.27169      2.6109412e-16  0              2.9952188    
   1200000   169.8          200            200            0.0030858613  -3.4648071e-38  0              0.009257584    2.0990865e-05  0              101.35738      2.6109412e-16  0              2.9952161    
   1300000   169.8          200            200            0.003086673   -1.7448585e-38  0              0.0092600189   3.1357064e-06  0              15.141204      2.6109412e-16  0              2.9952153    
   1400000   169.8          200            200            0.003086892    7.6414423e-39  0              0.0092606759   4.4891178e-07  0              2.1676343      2.6109412e-16  0              2.9952151    
   1500000   169.8          200            200            0.0030869416   1.062404e-38   0              0.0092608249   6.1736399e-08  0              0.29810298     2.6109412e-16  0              2.995215     
   1600000   169.8          200            200            0.0030869482   1.34348e-38    0              0.0092608446   8.1613432e-09  0              0.039408205    2.6109412e-16  0              2.995215     
   1700000   169.8          200            200            0.0030869463  -3.1676389e-38  0              0.0092608388   1.0361277e-09  0              0.0050030897   2.6109412e-16  0              2.995215     
   1800000   169.8          200            200            0.003086944   -1.8193466e-38  0              0.0092608319   1.2598769e-10  0              0.00060834945  2.6109412e-16  0              2.995215     
   1900000   169.8          200            200            0.0030869426   2.3295835e-38  0              0.0092608277   1.4600615e-11  0              7.0501143e-05  2.6109412e-16  0              2.995215     
   2000000   169.8          200            200            0.0030869418   7.4707664e-39  0              0.0092608255   1.5994359e-12  0              7.7231038e-06  2.6109412e-16  0              2.995215     
   2100000   169.8          200            200            0.0030869415   2.5157244e-38  0              0.0092608245   1.6340183e-13  0              7.8900896e-07  2.6109412e-16  0              2.995215     
   2200000   169.8          200            200            0.0030869414   1.4707343e-38  0              0.0092608241   1.521936e-14   0              7.3488844e-08  2.6109412e-16  0              2.995215     
   2300000   169.8          200            200            0.0030869413   3.4263632e-38  0              0.0092608239   1.235919e-15   0              5.9678105e-09  2.6109412e-16  0              2.995215     
   2400000   169.8          200            200            0.0030869413   2.2195124e-38  0              0.0092608238   7.7238907e-17  0              3.7295904e-10  2.6109412e-16  0              2.995215     
   2500000   169.8          200            200            0.0030869413   2.9392585e-38  0              0.0092608238   2.5905762e-18  0              1.2508965e-11  2.6109412e-16  0              2.995215     
   2600000   169.8          200            200            0.0030869413   1.0569298e-38  0              0.0092608238   1.2121409e-20  0              5.8529946e-14  2.6109412e-16  0              2.995215     
   2700000   169.8          200            200            0.0030869413   3.2960555e-38  0              0.0092608238   3.6271134e-20  0              1.7514033e-13  2.6109412e-16  0              2.995215     
   2800000   169.8          200            200            0.0030869413   2.7700134e-38  0              0.0092608238   4.4189116e-20  0              2.1337342e-13  2.6109412e-16  0              2.995215     
   2900000   169.8          200            200            0.0030869413   3.4815253e-38  0              0.0092608238   1.9439917e-20  0              9.3868404e-14  2.6109412e-16  0              2.995215     
   3000000   169.8          200            200            0.0030869413   1.4490625e-38  0              0.0092608238   1.0605319e-19  0              5.1209289e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9128 on 4 procs for 3000000 steps with 51 atoms

Performance: 40555272.599 ns/day, 0.000 hours/ns, 46938.973 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3255     | 1.563      | 5.0824     | 162.6 |  2.45
Neigh   | 0.086673   | 0.08722    | 0.08874    |   0.3 |  0.14
Comm    | 25.779     | 32.515     | 38.293     |  85.1 | 50.87
Output  | 0.06136    | 0.061448   | 0.061519   |   0.0 |  0.10
Modify  | 15.077     | 20.951     | 28.284     | 122.1 | 32.78
Other   |            | 8.735      |            |       | 13.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 16

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.67                                                               
Lattice spacing in x,y,z = 5.67 5.67 5.67

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.05 ${n1e1} -100 100 -100 100 units box
region box block -85.05 85.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.05 85.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.05 -100 -100) to (85.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-85.05 -100 -100) to (85.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.05 -100 -100) to (85.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_16_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 110 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.86 | 18.33 | 19.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   170.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   170.1          200            200            0.0024851668   4.6448112e-37  0              0.0074555003   12109.07       0              5.8470365e+10  2.6109412e-16  0              3.3327477    
    200000   170.1          200            200            0.00083275165 -1.1476087e-36  0              0.0024982549   2702.7137      0              1.3050437e+10  2.6109412e-16  0              3.0851423    
    300000   170.1          200            200           -6.0055588e-05  2.3693932e-36  0             -0.00018016676  34.623228      0              1.6718318e+08  2.6109412e-16  0              3.0418349    
    400000   170.1          200            200            0.0049193594   3.9988417e-36  0              0.014758078    184.31717      0              8.9000166e+08  2.6109412e-16  0              2.9933503    
    500000   170.1          200            200            0.001123349   -1.5369742e-35  0              0.003370047    12.747932      0              61555202       2.6109412e-16  0              2.9976165    
    600000   170.1          200            200            0.002060058    2.914328e-35   0              0.006180174    0.04433774     0              214091.08      2.6109412e-16  0              2.9963398    
    700000   170.1          200            200            0.0027143027  -1.705289e-37   0              0.0081429081   0.062189375    0              300290.23      2.6109412e-16  0              2.9956006    
    800000   170.1          200            200            0.0029541739   2.5270958e-36  0              0.0088625216   0.017034424    0              82253.137      2.6109412e-16  0              2.9953464    
    900000   170.1          200            200            0.0030385793   1.035963e-36   0              0.009115738    0.0036126744   0              17444.312      2.6109412e-16  0              2.9952589    
   1000000   170.1          200            200            0.0030674827   2.1539211e-37  0              0.009202448    0.00067830944  0              3275.3135      2.6109412e-16  0              2.9952293    
   1100000   170.1          200            200            0.0030770978   2.216256e-37   0              0.0092312933   0.0001173375   0              566.58079      2.6109412e-16  0              2.9952195    
   1200000   170.1          200            200            0.0030801888  -3.7443187e-38  0              0.0092405664   1.9061775e-05  0              92.042488      2.6109412e-16  0              2.9952163    
   1300000   170.1          200            200            0.0030811393  -1.039492e-37   0              0.0092434178   2.9399735e-06  0              14.19608       2.6109412e-16  0              2.9952154    
   1400000   170.1          200            200            0.0030814134   1.838324e-38   0              0.0092442402   4.3332339e-07  0              2.0923636      2.6109412e-16  0              2.9952151    
   1500000   170.1          200            200            0.0030814845  -6.1744752e-39  0              0.0092444534   6.12651e-08    0              0.29582724     2.6109412e-16  0              2.995215     
   1600000   170.1          200            200            0.0030814992  -1.6390341e-38  0              0.0092444975   8.3240067e-09  0              0.040193649    2.6109412e-16  0              2.995215     
   1700000   170.1          200            200            0.0030815002   1.0691508e-38  0              0.0092445007   1.08703e-09    0              0.0052488787   2.6109412e-16  0              2.995215     
   1800000   170.1          200            200            0.003081499   -1.6061931e-38  0              0.0092444971   1.3624094e-10  0              0.00065785874  2.6109412e-16  0              2.995215     
   1900000   170.1          200            200            0.003081498    1.4100648e-38  0              0.009244494    1.6333698e-11  0              7.886958e-05   2.6109412e-16  0              2.995215     
   2000000   170.1          200            200            0.0030814974   3.3294738e-39  0              0.0092444923   1.8626712e-12  0              8.9941728e-06  2.6109412e-16  0              2.995215     
   2100000   170.1          200            200            0.0030814971   2.779198e-38   0              0.0092444914   2.0012775e-13  0              9.6634527e-07  2.6109412e-16  0              2.995215     
   2200000   170.1          200            200            0.003081497   -1.0283958e-38  0              0.0092444911   1.9923318e-14  0              9.6202573e-08  2.6109412e-16  0              2.995215     
   2300000   170.1          200            200            0.003081497    1.2355354e-38  0              0.0092444909   1.7874043e-15  0              8.6307357e-09  2.6109412e-16  0              2.995215     
   2400000   170.1          200            200            0.0030814969   1.0634711e-38  0              0.0092444908   1.3481401e-16  0              6.5096863e-10  2.6109412e-16  0              2.995215     
   2500000   170.1          200            200            0.0030814969  -4.5023471e-39  0              0.0092444908   7.2803532e-18  0              3.515422e-11   2.6109412e-16  0              2.995215     
   2600000   170.1          200            200            0.0030814969  -5.8026398e-39  0              0.0092444908   1.0139483e-19  0              4.8959936e-13  2.6109412e-16  0              2.995215     
   2700000   170.1          200            200            0.0030814969   2.3123279e-38  0              0.0092444908   1.9109992e-21  0              9.2275313e-15  2.6109412e-16  0              2.995215     
   2800000   170.1          200            200            0.0030814969  -2.6327399e-38  0              0.0092444908   2.3116506e-20  0              1.1162134e-13  2.6109412e-16  0              2.995215     
   2900000   170.1          200            200            0.0030814969   1.7390422e-39  0              0.0092444908   3.9500165e-21  0              1.9073216e-14  2.6109412e-16  0              2.995215     
   3000000   170.1          200            200            0.0030814969  -1.2135664e-38  0              0.0092444908   1.2885766e-19  0              6.2220751e-13  2.6109412e-16  0              2.995215     
Loop time of 64.114 on 4 procs for 3000000 steps with 51 atoms

Performance: 40428016.034 ns/day, 0.000 hours/ns, 46791.685 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32292    | 1.5749     | 5.1413     | 164.1 |  2.46
Neigh   | 0.087236   | 0.087707   | 0.088862   |   0.2 |  0.14
Comm    | 25.711     | 32.608     | 38.391     |  86.7 | 50.86
Output  | 0.06262    | 0.062706   | 0.062773   |   0.0 |  0.10
Modify  | 15.171     | 21.144     | 28.672     | 124.6 | 32.98
Other   |            | 8.637      |            |       | 13.47

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 17

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.68                                                               
Lattice spacing in x,y,z = 5.68 5.68 5.68

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.2 ${n1e1} -100 100 -100 100 units box
region box block -85.2 85.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.2 85.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.2 -100 -100) to (85.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-85.2 -100 -100) to (85.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.2 -100 -100) to (85.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_17_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 110 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.86 | 18.33 | 19.49 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   170.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   170.4          200            200            0.0024818921   3.4789538e-37  0              0.0074456762   12116.807      0              5.8507725e+10  2.6109412e-16  0              3.332567     
    200000   170.4          200            200            0.00083519154  9.3701766e-37  0              0.0025055746   2722.7381      0              1.3147128e+10  2.6109412e-16  0              3.0843337    
    300000   170.4          200            200           -4.9601356e-05  5.085762e-37   0             -0.00014880407  23.202316      0              1.1203568e+08  2.6109412e-16  0              3.0424854    
    400000   170.4          200            200            0.0037766147  -4.0534263e-35  0              0.011329844    193.47246      0              9.3420928e+08  2.6109412e-16  0              2.994389     
    500000   170.4          200            200            0.0012914597   1.7985318e-35  0              0.0038743791   15.827209      0              76423927       2.6109412e-16  0              2.9973792    
    600000   170.4          200            200            0.0020526462   2.9817271e-36  0              0.0061579386   6.674002e-05   0              322.26367      2.6109412e-16  0              2.9963471    
    700000   170.4          200            200            0.0026979622  -4.7535038e-36  0              0.0080938865   0.028855806    0              139334.36      2.6109412e-16  0              2.9956141    
    800000   170.4          200            200            0.0029422339   4.3596795e-36  0              0.0088267018   0.010545548    0              50920.676      2.6109412e-16  0              2.9953538    
    900000   170.4          200            200            0.0030299724   2.3517416e-37  0              0.0090899171   0.0025637566   0              12379.463      2.6109412e-16  0              2.9952624    
   1000000   170.4          200            200            0.00306063     3.9562042e-38  0              0.0091818899   0.00052508755  0              2535.4598      2.6109412e-16  0              2.9952308    
   1100000   170.4          200            200            0.0030710644   1.6326221e-37  0              0.0092131932   9.6722847e-05  0              467.04001      2.6109412e-16  0              2.9952201    
   1200000   170.4          200            200            0.0030745139  -1.4409209e-38  0              0.0092235418   1.6507095e-05  0              79.706855      2.6109412e-16  0              2.9952166    
   1300000   170.4          200            200            0.0030756145   2.0544825e-39  0              0.0092268435   2.6530553e-06  0              12.810654      2.6109412e-16  0              2.9952155    
   1400000   170.4          200            200            0.0030759495   6.116202e-39   0              0.0092278484   4.0547784e-07  0              1.9579074      2.6109412e-16  0              2.9952151    
   1500000   170.4          200            200            0.0030760445  -7.8798333e-39  0              0.0092281336   5.9275974e-08  0              0.28622246     2.6109412e-16  0              2.995215     
   1600000   170.4          200            200            0.0030760685  -1.1143908e-38  0              0.0092282054   8.316404e-09   0              0.040156938    2.6109412e-16  0              2.995215     
   1700000   170.4          200            200            0.0030760731   1.7392188e-38  0              0.0092282192   1.1214477e-09  0              0.0054150695   2.6109412e-16  0              2.995215     
   1800000   170.4          200            200            0.0030760731   6.6516789e-39  0              0.0092282194   1.4532773e-10  0              0.00070173559  2.6109412e-16  0              2.995215     
   1900000   170.4          200            200            0.0030760726   1.4728147e-38  0              0.0092282178   1.8066278e-11  0              8.7235592e-05  2.6109412e-16  0              2.995215     
   2000000   170.4          200            200            0.0030760722   1.0856636e-38  0              0.0092282165   2.1464265e-12  0              1.0364326e-05  2.6109412e-16  0              2.995215     
   2100000   170.4          200            200            0.0030760719  -8.5042225e-39  0              0.0092282158   2.4218496e-13  0              1.1694245e-06  2.6109412e-16  0              2.995215     
   2200000   170.4          200            200            0.0030760718   1.2757222e-38  0              0.0092282155   2.5667004e-14  0              1.2393678e-07  2.6109412e-16  0              2.995215     
   2300000   170.4          200            200            0.0030760718   1.5028066e-38  0              0.0092282154   2.5095379e-15  0              1.211766e-08   2.6109412e-16  0              2.995215     
   2400000   170.4          200            200            0.0030760718  -7.0502678e-39  0              0.0092282153   2.1815534e-16  0              1.0533941e-09  2.6109412e-16  0              2.995215     
   2500000   170.4          200            200            0.0030760718   1.3503957e-38  0              0.0092282153   1.5395048e-17  0              7.4337179e-11  2.6109412e-16  0              2.995215     
   2600000   170.4          200            200            0.0030760718   2.6238464e-39  0              0.0092282153   5.9060916e-19  0              2.8518403e-12  2.6109412e-16  0              2.995215     
   2700000   170.4          200            200            0.0030760718   1.4643325e-38  0              0.0092282153   1.722507e-20   0              8.31737e-14    2.6109412e-16  0              2.995215     
   2800000   170.4          200            200            0.0030760718  -1.3642531e-38  0              0.0092282153   1.9544642e-20  0              9.4374081e-14  2.6109412e-16  0              2.995215     
   2900000   170.4          200            200            0.0030760718   2.0939203e-38  0              0.0092282153   1.6029253e-19  0              7.7399525e-13  2.6109412e-16  0              2.995215     
   3000000   170.4          200            200            0.0030760718   9.9875029e-39  0              0.0092282153   2.3290806e-22  0              1.1246297e-15  2.6109412e-16  0              2.995215     
Loop time of 63.8551 on 4 procs for 3000000 steps with 51 atoms

Performance: 40591875.331 ns/day, 0.000 hours/ns, 46981.337 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3281     | 1.5207     | 4.9479     | 160.5 |  2.38
Neigh   | 0.086228   | 0.08754    | 0.089293   |   0.4 |  0.14
Comm    | 25.687     | 32.379     | 38.122     |  85.0 | 50.71
Output  | 0.063793   | 0.063881   | 0.06395    |   0.0 |  0.10
Modify  | 15.15      | 21.055     | 28.385     | 122.2 | 32.97
Other   |            | 8.749      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 18

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.69                                                               
Lattice spacing in x,y,z = 5.69 5.69 5.69

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.35 ${n1e1} -100 100 -100 100 units box
region box block -85.35 85.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.35 85.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.35 -100 -100) to (85.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-85.35 -100 -100) to (85.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.35 -100 -100) to (85.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_18_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 111 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.88 | 18.35 | 19.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   170.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   170.7          200            200            0.0024785918  -4.0371244e-37  0              0.0074357753   12124.24       0              6.5048463e+10  2.6109412e-16  0              3.3324095    
    200000   170.7          200            200            0.00083735136 -2.2292902e-37  0              0.0025120541   2741.375       0              1.470791e+10   2.6109412e-16  0              3.0836167    
    300000   170.7          200            200           -3.8835236e-05 -2.2692448e-36  0             -0.00011650571  13.969561      0              74948900       2.6109412e-16  0              3.0430585    
    400000   170.7          200            200            0.0025382992  -1.1262695e-35  0              0.0076148975   194.34009      0              1.0426653e+09  2.6109412e-16  0              2.9956449    
    500000   170.7          200            200            0.0015226774   3.0748969e-36  0              0.0045680321   19.441604      0              1.0430728e+08  2.6109412e-16  0              2.9970674    
    600000   170.7          200            200            0.002059363    2.1179106e-35  0              0.006178089    0.070614598    0              378858.47      2.6109412e-16  0              2.996338     
    700000   170.7          200            200            0.0026855981   1.7508474e-36  0              0.0080567944   0.0054070087   0              29009.456      2.6109412e-16  0              2.9956235    
    800000   170.7          200            200            0.0029313133  -4.4787925e-37  0              0.00879394     0.0046579164   0              24990.457      2.6109412e-16  0              2.9953603    
    900000   170.7          200            200            0.0030215727   1.7435074e-36  0              0.009064718    0.0014935317   0              8013.0335      2.6109412e-16  0              2.9952658    
   1000000   170.7          200            200            0.0030537972   9.2481697e-38  0              0.0091613915   0.00035537898  0              1906.6644      2.6109412e-16  0              2.9952324    
   1100000   170.7          200            200            0.0030650252   7.425099e-38   0              0.0091950756   7.2214468e-05  0              387.44202      2.6109412e-16  0              2.9952208    
   1200000   170.7          200            200            0.0030688398   7.5411108e-38  0              0.0092065195   1.3242036e-05  0              71.045616      2.6109412e-16  0              2.9952169    
   1300000   170.7          200            200            0.0030700989  -4.5773341e-38  0              0.0092102967   2.2527204e-06  0              12.086201      2.6109412e-16  0              2.9952156    
   1400000   170.7          200            200            0.0030704998   8.2496996e-39  0              0.0092114995   3.6114681e-07  0              1.9376097      2.6109412e-16  0              2.9952152    
   1500000   170.7          200            200            0.0030706216   2.0871146e-38  0              0.0092118647   5.5076595e-08  0              0.29549463     2.6109412e-16  0              2.9952151    
   1600000   170.7          200            200            0.003070656    9.9510028e-39  0              0.0092119679   8.0358826e-09  0              0.043113779    2.6109412e-16  0              2.995215     
   1700000   170.7          200            200            0.0030706646  -7.1649865e-39  0              0.0092119937   1.1253632e-09  0              0.0060377514   2.6109412e-16  0              2.995215     
   1800000   170.7          200            200            0.0030706662  -2.1215417e-39  0              0.0092119985   1.5147865e-10  0              0.00081270689  2.6109412e-16  0              2.995215     
   1900000   170.7          200            200            0.0030706662  -1.2630317e-38  0              0.0092119985   1.9593706e-11  0              0.00010512332  2.6109412e-16  0              2.995215     
   2000000   170.7          200            200            0.003070666    2.0862015e-38  0              0.0092119979   2.430893e-12   0              1.3042125e-05  2.6109412e-16  0              2.995215     
   2100000   170.7          200            200            0.0030706658   2.0799067e-38  0              0.0092119974   2.8816977e-13  0              1.5460763e-06  2.6109412e-16  0              2.995215     
   2200000   170.7          200            200            0.0030706657  -2.7211088e-38  0              0.0092119972   3.244497e-14   0              1.7407239e-07  2.6109412e-16  0              2.995215     
   2300000   170.7          200            200            0.0030706657  -3.9651263e-39  0              0.0092119971   3.4290165e-15  0              1.8397215e-08  2.6109412e-16  0              2.995215     
   2400000   170.7          200            200            0.0030706657  -6.8810805e-39  0              0.009211997    3.3516173e-16  0              1.7981956e-09  2.6109412e-16  0              2.995215     
   2500000   170.7          200            200            0.0030706657   7.4335546e-39  0              0.009211997    2.8398892e-17  0              1.5236454e-10  2.6109412e-16  0              2.995215     
   2600000   170.7          200            200            0.0030706657   1.1422069e-39  0              0.009211997    1.701483e-18   0              9.128725e-12   2.6109412e-16  0              2.995215     
   2700000   170.7          200            200            0.0030706657   2.8479007e-38  0              0.009211997    1.1997612e-19  0              6.4369082e-13  2.6109412e-16  0              2.995215     
   2800000   170.7          200            200            0.0030706657   1.5514263e-38  0              0.009211997    2.2299951e-21  0              1.1964276e-14  2.6109412e-16  0              2.995215     
   2900000   170.7          200            200            0.0030706657   5.6628036e-39  0              0.009211997    1.0000192e-19  0              5.3652609e-13  2.6109412e-16  0              2.995215     
   3000000   170.7          200            200            0.0030706657   2.6099313e-38  0              0.009211997    2.4603988e-20  0              1.3200428e-13  2.6109412e-16  0              2.995215     
Loop time of 62.8428 on 4 procs for 3000000 steps with 50 atoms

Performance: 41245779.787 ns/day, 0.000 hours/ns, 47738.171 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28069    | 1.4854     | 4.8521     | 159.6 |  2.36
Neigh   | 0.087412   | 0.088038   | 0.089588   |   0.3 |  0.14
Comm    | 25.075     | 31.69      | 37.326     |  84.5 | 50.43
Output  | 0.061772   | 0.061855   | 0.061919   |   0.0 |  0.10
Modify  | 15.022     | 20.865     | 28.121     | 121.0 | 33.20
Other   |            | 8.653      |            |       | 13.77

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.5
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 19

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.7                                                               
Lattice spacing in x,y,z = 5.7 5.7 5.7

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.5 ${n1e1} -100 100 -100 100 units box
region box block -85.5 85.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.5 85.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.5 -100 -100) to (85.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-85.5 -100 -100) to (85.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.5 -100 -100) to (85.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_19_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 111 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.88 | 18.35 | 19.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   171            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   171            200            200            0.0024752662   2.8895548e-37  0              0.0074257986   12131.373      0              5.8578061e+10  2.6109412e-16  0              3.3322738    
    200000   171            200            200            0.00083923966  1.6257173e-36  0              0.002517719    2758.6534      0              1.332055e+10   2.6109412e-16  0              3.082988     
    300000   171            200            200           -2.8165006e-05 -4.2194947e-37  0             -8.4495018e-05  7.2187125      0              34856579       2.6109412e-16  0              3.0435401    
    400000   171            200            200            0.0012929562   4.725423e-35   0              0.0038788686   182.6596       0              8.8199785e+08  2.6109412e-16  0              2.9971393    
    500000   171            200            200            0.0018449767   1.4065591e-35  0              0.0055349302   23.423887      0              1.1310557e+08  2.6109412e-16  0              2.996656     
    600000   171            200            200            0.0020888111  -4.9520857e-36  0              0.0062664333   0.3216308      0              1553040        2.6109412e-16  0              2.9963026    
    700000   171            200            200            0.0026804157  -6.1286536e-38  0              0.0080412471   0.0018375344   0              8872.7961      2.6109412e-16  0              2.9956253    
    800000   171            200            200            0.0029225349   1.8333291e-36  0              0.0087676048   0.00065810243  0              3177.7411      2.6109412e-16  0              2.9953646    
    900000   171            200            200            0.0030137545  -1.1643448e-36  0              0.0090412636   0.00055085486  0              2659.881       2.6109412e-16  0              2.9952686    
   1000000   171            200            200            0.0030471035   4.3607918e-37  0              0.0091413104   0.00018420785  0              889.47378      2.6109412e-16  0              2.9952338    
   1100000   171            200            200            0.0030590161   1.6097994e-37  0              0.0091770482   4.4987653e-05  0              217.22927      2.6109412e-16  0              2.9952215    
   1200000   171            200            200            0.0030631766   1.5889827e-38  0              0.0091895297   9.2968917e-06  0              44.891363      2.6109412e-16  0              2.9952172    
   1300000   171            200            200            0.0030645948   1.3541309e-38  0              0.0091937843   1.725319e-06   0              8.3309478      2.6109412e-16  0              2.9952157    
   1400000   171            200            200            0.0030650649   2.7384884e-38  0              0.0091951946   2.9622588e-07  0              1.4303688      2.6109412e-16  0              2.9952152    
   1500000   171            200            200            0.0030652154   2.3460878e-38  0              0.0091956462   4.7849554e-08  0              0.23104837     2.6109412e-16  0              2.9952151    
   1600000   171            200            200            0.0030652615   1.7723646e-38  0              0.0091957844   7.3450152e-09  0              0.03546645     2.6109412e-16  0              2.995215     
   1700000   171            200            200            0.0030652746  -8.6263708e-39  0              0.0091958239   1.0780054e-09  0              0.0052053025   2.6109412e-16  0              2.995215     
   1800000   171            200            200            0.003065278   -1.8254729e-38  0              0.009195834    1.5180919e-10  0              0.00073303223  2.6109412e-16  0              2.995215     
   1900000   171            200            200            0.0030652787   1.784207e-38   0              0.009195836    2.0546159e-11  0              9.9210048e-05  2.6109412e-16  0              2.995215     
   2000000   171            200            200            0.0030652787   5.3821628e-40  0              0.0091958361   2.6725822e-12  0              1.2904943e-05  2.6109412e-16  0              2.995215     
   2100000   171            200            200            0.0030652786   1.2788395e-38  0              0.0091958359   3.3357135e-13  0              1.6106967e-06  2.6109412e-16  0              2.995215     
   2200000   171            200            200            0.0030652786   5.8061234e-40  0              0.0091958357   3.9784167e-14  0              1.921035e-07   2.6109412e-16  0              2.995215     
   2300000   171            200            200            0.0030652785  -1.0799449e-38  0              0.0091958356   4.5087796e-15  0              2.1771283e-08  2.6109412e-16  0              2.995215     
   2400000   171            200            200            0.0030652785   4.3583042e-38  0              0.0091958356   4.8095299e-16  0              2.3223498e-09  2.6109412e-16  0              2.995215     
   2500000   171            200            200            0.0030652785  -1.8212494e-38  0              0.0091958356   4.6538634e-17  0              2.2471841e-10  2.6109412e-16  0              2.995215     
   2600000   171            200            200            0.0030652785   5.256605e-38   0              0.0091958356   3.6406473e-18  0              1.7579383e-11  2.6109412e-16  0              2.995215     
   2700000   171            200            200            0.0030652785  -1.6974e-39     0              0.0091958356   3.3085729e-19  0              1.5975914e-12  2.6109412e-16  0              2.995215     
   2800000   171            200            200            0.0030652785   2.2708948e-38  0              0.0091958356   1.2281622e-21  0              5.9303556e-15  2.6109412e-16  0              2.995215     
   2900000   171            200            200            0.0030652785  -2.0092931e-38  0              0.0091958356   1.104166e-19   0              5.3316226e-13  2.6109412e-16  0              2.995215     
   3000000   171            200            200            0.0030652785   6.9457104e-39  0              0.0091958356   9.8166698e-21  0              4.7401185e-14  2.6109412e-16  0              2.995215     
Loop time of 64.225 on 4 procs for 3000000 steps with 51 atoms

Performance: 40358129.117 ns/day, 0.000 hours/ns, 46710.798 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.2932     | 1.5511     | 5.0601     | 162.8 |  2.42
Neigh   | 0.08727    | 0.087958   | 0.089533   |   0.3 |  0.14
Comm    | 25.499     | 32.626     | 38.447     |  88.3 | 50.80
Output  | 0.062157   | 0.062238   | 0.062306   |   0.0 |  0.10
Modify  | 15.279     | 21.266     | 28.974     | 125.3 | 33.11
Other   |            | 8.632      |            |       | 13.44

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 20

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.71                                                               
Lattice spacing in x,y,z = 5.71 5.71 5.71

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.65 ${n1e1} -100 100 -100 100 units box
region box block -85.65 85.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.65 85.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.65 -100 -100) to (85.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-85.65 -100 -100) to (85.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.65 -100 -100) to (85.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_20_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 111 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.88 | 18.35 | 19.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   171.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   171.3          200            200            0.0024719157   3.4595251e-37  0              0.007415747    12138.212      0              5.861108e+10   2.6109412e-16  0              3.3321587    
    200000   171.3          200            200            0.00084086695  2.4024244e-37  0              0.0025226008   2774.6147      0              1.3397622e+10  2.6109412e-16  0              3.0824434    
    300000   171.3          200            200           -1.7871365e-05 -4.2519284e-37  0             -5.3614096e-05  2.8551345      0              13786423       2.6109412e-16  0              3.0439333    
    400000   171.3          200            200            0.00023774542  5.6151834e-36  0              0.00071323626  155.48088      0              7.5076153e+08  2.6109412e-16  0              2.9988645    
    500000   171.3          200            200            0.002296956   -4.5654275e-36  0              0.0068908679   27.215463      0              1.3141373e+08  2.6109412e-16  0              2.9961149    
    600000   171.3          200            200            0.0021543405   9.4630253e-36  0              0.0064630214   0.83310468     0              4022764.3      2.6109412e-16  0              2.9962253    
    700000   171.3          200            200            0.0026875763   5.4857202e-36  0              0.0080627288   0.032933676    0              159024.94      2.6109412e-16  0              2.995614     
    800000   171.3          200            200            0.0029177887   1.7930524e-36  0              0.0087533662   0.00069841151  0              3372.3792      2.6109412e-16  0              2.9953648    
    900000   171.3          200            200            0.0030071819   4.5773845e-37  0              0.0090215458   1.9632492e-05  0              94.798279      2.6109412e-16  0              2.9952701    
   1000000   171.3          200            200            0.0030407744  -1.4326761e-37  0              0.0091223232   4.5778547e-05  0              221.04822      2.6109412e-16  0              2.9952349    
   1100000   171.3          200            200            0.0030531111   4.5946119e-38  0              0.0091593333   1.8727231e-05  0              90.427094      2.6109412e-16  0              2.9952221    
   1200000   171.3          200            200            0.0030575474   5.0443379e-38  0              0.0091726422   5.0030345e-06  0              24.157863      2.6109412e-16  0              2.9952175    
   1300000   171.3          200            200            0.0030591091  -2.5560781e-39  0              0.0091773274   1.0895296e-06  0              5.2609484      2.6109412e-16  0              2.9952158    
   1400000   171.3          200            200            0.0030596464   9.0969615e-39  0              0.0091789392   2.0950396e-07  0              1.0116196      2.6109412e-16  0              2.9952153    
   1500000   171.3          200            200            0.0030598264   2.6476798e-38  0              0.0091794793   3.6937764e-08  0              0.17835924     2.6109412e-16  0              2.9952151    
   1600000   171.3          200            200            0.0030598849   9.7515382e-39  0              0.0091796547   6.0951343e-09  0              0.029431222    2.6109412e-16  0              2.995215     
   1700000   171.3          200            200            0.0030599031  -5.8529869e-40  0              0.0091797094   9.5274732e-10  0              0.0046004758   2.6109412e-16  0              2.995215     
   1800000   171.3          200            200            0.0030599085   1.2979805e-38  0              0.0091797255   1.4211917e-10  0              0.0006862426   2.6109412e-16  0              2.995215     
   1900000   171.3          200            200            0.0030599099   7.4126583e-39  0              0.0091797298   2.0319671e-11  0              9.8116421e-05  2.6109412e-16  0              2.995215     
   2000000   171.3          200            200            0.0030599103   4.2930206e-39  0              0.0091797308   2.7910946e-12  0              1.3477197e-05  2.6109412e-16  0              2.995215     
   2100000   171.3          200            200            0.0030599103  -5.3198307e-39  0              0.0091797309   3.6852664e-13  0              1.7794833e-06  2.6109412e-16  0              2.995215     
   2200000   171.3          200            200            0.0030599103   1.81986e-38    0              0.0091797309   4.6717248e-14  0              2.2558087e-07  2.6109412e-16  0              2.995215     
   2300000   171.3          200            200            0.0030599103  -7.8455857e-39  0              0.0091797308   5.6732405e-15  0              2.7394048e-08  2.6109412e-16  0              2.995215     
   2400000   171.3          200            200            0.0030599103   1.155087e-39   0              0.0091797308   6.5717741e-16  0              3.1732745e-09  2.6109412e-16  0              2.995215     
   2500000   171.3          200            200            0.0030599103  -2.3093348e-38  0              0.0091797308   7.0416984e-17  0              3.4001841e-10  2.6109412e-16  0              2.995215     
   2600000   171.3          200            200            0.0030599103   1.6617624e-38  0              0.0091797308   6.6735738e-18  0              3.2224299e-11  2.6109412e-16  0              2.995215     
   2700000   171.3          200            200            0.0030599103  -1.962467e-39   0              0.0091797308   6.9271469e-19  0              3.3448713e-12  2.6109412e-16  0              2.995215     
   2800000   171.3          200            200            0.0030599103   1.2988635e-38  0              0.0091797308   1.4832662e-20  0              7.1621617e-14  2.6109412e-16  0              2.995215     
   2900000   171.3          200            200            0.0030599103  -1.5796156e-38  0              0.0091797308   1.0814368e-19  0              5.2218714e-13  2.6109412e-16  0              2.995215     
   3000000   171.3          200            200            0.0030599103  -1.0873546e-38  0              0.0091797308   1.7601872e-20  0              8.4993141e-14  2.6109412e-16  0              2.995215     
Loop time of 64.1791 on 4 procs for 3000000 steps with 51 atoms

Performance: 40386983.411 ns/day, 0.000 hours/ns, 46744.194 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29157    | 1.5202     | 4.9681     | 161.5 |  2.37
Neigh   | 0.087497   | 0.088054   | 0.089628   |   0.3 |  0.14
Comm    | 25.91      | 32.631     | 38.45      |  85.2 | 50.84
Output  | 0.060622   | 0.060705   | 0.06077    |   0.0 |  0.09
Modify  | 15.208     | 21.137     | 28.532     | 123.1 | 32.93
Other   |            | 8.742      |            |       | 13.62

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 21

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.72                                                               
Lattice spacing in x,y,z = 5.72 5.72 5.72

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.8 ${n1e1} -100 100 -100 100 units box
region box block -85.8 85.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.8 85.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.8 -100 -100) to (85.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-85.8 -100 -100) to (85.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.8 -100 -100) to (85.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_21_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 111 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.88 | 18.35 | 19.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   171.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   171.6          200            200            0.002468584   -1.1448775e-37  0              0.007405752    12145.121      0              5.8644442e+10  2.6109412e-16  0              3.3320349    
    200000   171.6          200            200            0.00084228797 -6.8079604e-37  0              0.0025268639   2789.5357      0              1.346967e+10   2.6109412e-16  0              3.0819652    
    300000   171.6          200            200           -8.1125264e-06 -2.2652497e-36  0             -2.4337579e-05  0.57540297     0              2778415        2.6109412e-16  0              3.0442505    
    400000   171.6          200            200           -0.00010210003 -5.9104295e-36  0             -0.00030630008  115.62098      0              5.5829231e+08  2.6109412e-16  0              3.000779     
    500000   171.6          200            200            0.0029335401   6.1001667e-36  0              0.0088006204   29.517242      0              1.425282e+08   2.6109412e-16  0              2.9954062    
    600000   171.6          200            200            0.0022777537   7.1797678e-36  0              0.0068332612   1.6782666      0              8103748.6      2.6109412e-16  0              2.9960819    
    700000   171.6          200            200            0.0027155103   1.7990909e-36  0              0.0081465309   0.11744448     0              567097.38      2.6109412e-16  0              2.9955803    
    800000   171.6          200            200            0.0029202227   1.2793681e-36  0              0.0087606681   0.0079202484   0              38244.045      2.6109412e-16  0              2.9953575    
    900000   171.6          200            200            0.0030029913  -9.1634204e-37  0              0.0090089739   0.00036661283  0              1770.2421      2.6109412e-16  0              2.9952693    
   1000000   171.6          200            200            0.0030352089   2.6155103e-38  0              0.0091056266   3.7058654e-06  0              17.894298      2.6109412e-16  0              2.9952353    
   1100000   171.6          200            200            0.0030474465   1.6191823e-37  0              0.0091423396   1.4143326e-06  0              6.8293061      2.6109412e-16  0              2.9952224    
   1200000   171.6          200            200            0.0030519976  -5.7559466e-38  0              0.0091559928   1.2701441e-06  0              6.1330714      2.6109412e-16  0              2.9952177    
   1300000   171.6          200            200            0.0030536563   3.3007663e-38  0              0.009160969    4.3571765e-07  0              2.1039246      2.6109412e-16  0              2.995216     
   1400000   171.6          200            200            0.0030542488   3.3658489e-38  0              0.0091627463   1.0782021e-07  0              0.52062521     2.6109412e-16  0              2.9952153    
   1500000   171.6          200            200            0.0030544559   3.8238828e-38  0              0.0091633676   2.2464888e-08  0              0.10847491     2.6109412e-16  0              2.9952151    
   1600000   171.6          200            200            0.0030545266   7.0953301e-39  0              0.0091635797   4.1931156e-09  0              0.020247054    2.6109412e-16  0              2.995215     
   1700000   171.6          200            200            0.00305455    -1.5304145e-39  0              0.0091636501   7.2310377e-10  0              0.0034916093   2.6109412e-16  0              2.995215     
   1800000   171.6          200            200            0.0030545576   1.1936766e-38  0              0.0091636728   1.1722298e-10  0              0.00056602782  2.6109412e-16  0              2.995215     
   1900000   171.6          200            200            0.0030545599  -2.682437e-39   0              0.0091636797   1.8049395e-11  0              8.7154069e-05  2.6109412e-16  0              2.995215     
   2000000   171.6          200            200            0.0030545606  -3.2815047e-38  0              0.0091636817   2.6564806e-12  0              1.2827194e-05  2.6109412e-16  0              2.995215     
   2100000   171.6          200            200            0.0030545607  -2.9936261e-39  0              0.0091636822   3.7513117e-13  0              1.8113742e-06  2.6109412e-16  0              2.995215     
   2200000   171.6          200            200            0.0030545608   2.5776643e-38  0              0.0091636823   5.0913301e-14  0              2.4584211e-07  2.6109412e-16  0              2.995215     
   2300000   171.6          200            200            0.0030545608   8.6554737e-39  0              0.0091636823   6.6430298e-15  0              3.2076814e-08  2.6109412e-16  0              2.995215     
   2400000   171.6          200            200            0.0030545608   2.8306309e-38  0              0.0091636823   8.3106035e-16  0              4.012893e-09   2.6109412e-16  0              2.995215     
   2500000   171.6          200            200            0.0030545608   9.3709527e-39  0              0.0091636823   9.8294554e-17  0              4.7462922e-10  2.6109412e-16  0              2.995215     
   2600000   171.6          200            200            0.0030545608  -6.7805197e-39  0              0.0091636823   1.068152e-17   0              5.1577238e-11  2.6109412e-16  0              2.995215     
   2700000   171.6          200            200            0.0030545608  -2.3666734e-38  0              0.0091636823   1.221513e-18   0              5.8982491e-12  2.6109412e-16  0              2.995215     
   2800000   171.6          200            200            0.0030545608   2.3437272e-38  0              0.0091636823   5.4734605e-20  0              2.6429382e-13  2.6109412e-16  0              2.995215     
   2900000   171.6          200            200            0.0030545608   1.7892502e-38  0              0.0091636823   1.0099529e-19  0              4.8767009e-13  2.6109412e-16  0              2.995215     
   3000000   171.6          200            200            0.0030545608   1.1865737e-38  0              0.0091636823   2.9743921e-20  0              1.4362275e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1196 on 4 procs for 3000000 steps with 51 atoms

Performance: 40424446.508 ns/day, 0.000 hours/ns, 46787.554 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29651    | 1.5167     | 4.9407     | 160.6 |  2.37
Neigh   | 0.087439   | 0.088008   | 0.089597   |   0.3 |  0.14
Comm    | 25.794     | 32.596     | 38.373     |  85.9 | 50.84
Output  | 0.063214   | 0.063296   | 0.06336    |   0.0 |  0.10
Modify  | 15.153     | 21.106     | 28.555     | 123.5 | 32.92
Other   |            | 8.749      |            |       | 13.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 22

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.73                                                               
Lattice spacing in x,y,z = 5.73 5.73 5.73

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -85.95 ${n1e1} -100 100 -100 100 units box
region box block -85.95 85.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -85.95 85.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-85.95 -100 -100) to (85.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-85.95 -100 -100) to (85.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-85.95 -100 -100) to (85.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_22_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 111 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.88 | 18.35 | 19.51 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   171.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   171.9          200            200            0.0024655584   1.7247746e-37  0              0.0073966753   12154.484      0              5.8689655e+10  2.6109412e-16  0              3.3317211    
    200000   171.9          200            200            0.0008437888   4.6803649e-37  0              0.0025313664   2804.9273      0              1.354399e+10   2.6109412e-16  0              3.0814639    
    300000   171.9          200            200            1.172785e-06  -7.3107929e-36  0              3.5183551e-06  0.013366935    0              64544.146      2.6109412e-16  0              3.0445066    
    400000   171.9          200            200           -8.2891504e-05 -4.063905e-36   0             -0.00024867451  73.005453      0              3.5251721e+08  2.6109412e-16  0              3.0027933    
    500000   171.9          200            200            0.0038071759  -2.2888001e-37  0              0.011421528    27.746458      0              1.3397771e+08  2.6109412e-16  0              2.9945074    
    600000   171.9          200            200            0.0024924069  -4.5070602e-36  0              0.0074772208   2.82129        0              13623000       2.6109412e-16  0              2.9958375    
    700000   171.9          200            200            0.0027774092   3.5561254e-36  0              0.0083322275   0.26803297     0              1294235.3      2.6109412e-16  0              2.99551      
    800000   171.9          200            200            0.0029349531  -4.1701348e-37  0              0.0088048594   0.025629412    0              123755.26      2.6109412e-16  0              2.9953372    
    900000   171.9          200            200            0.0030031182   1.5996078e-36  0              0.0090093546   0.0022130331   0              10685.945      2.6109412e-16  0              2.9952639    
   1000000   171.9          200            200            0.0030311222   1.7409873e-38  0              0.0090933666   0.00015900425  0              767.77461      2.6109412e-16  0              2.9952341    
   1100000   171.9          200            200            0.0030422811   1.8793915e-37  0              0.0091268432   7.9371685e-06  0              38.325746      2.6109412e-16  0              2.9952223    
   1200000   171.9          200            200            0.0030466186  -8.0867539e-38  0              0.0091398557   1.1938235e-07  0              0.57645464     2.6109412e-16  0              2.9952178    
   1300000   171.9          200            200            0.003048268    5.9581827e-38  0              0.009144804    1.6795357e-08  0              0.08109877     2.6109412e-16  0              2.995216     
   1400000   171.9          200            200            0.0030488826   2.2564908e-38  0              0.0091466477   1.9929877e-08  0              0.096234243    2.6109412e-16  0              2.9952154    
   1500000   171.9          200            200            0.0030491071  -2.5158745e-38  0              0.0091473212   7.2773218e-09  0              0.035139583    2.6109412e-16  0              2.9952151    
   1600000   171.9          200            200            0.0030491874  -1.3386987e-38  0              0.0091475623   1.8526161e-09  0              0.0089456199   2.6109412e-16  0              2.9952151    
   1700000   171.9          200            200            0.0030492156   1.5416299e-38  0              0.0091476468   3.9251068e-10  0              0.0018952936   2.6109412e-16  0              2.995215     
   1800000   171.9          200            200            0.0030492252   8.9359701e-39  0              0.0091476757   7.4102385e-11  0              0.0003578139   2.6109412e-16  0              2.995215     
   1900000   171.9          200            200            0.0030492285   2.996606e-38   0              0.0091476854   1.2889218e-11  0              6.2237419e-05  2.6109412e-16  0              2.995215     
   2000000   171.9          200            200            0.0030492295  -2.1862777e-38  0              0.0091476885   2.1040461e-12  0              1.0159686e-05  2.6109412e-16  0              2.995215     
   2100000   171.9          200            200            0.0030492298  -2.461599e-38   0              0.0091476895   3.2585021e-13  0              1.5734141e-06  2.6109412e-16  0              2.995215     
   2200000   171.9          200            200            0.0030492299   3.8306324e-39  0              0.0091476897   4.822212e-14   0              2.3284736e-07  2.6109412e-16  0              2.995215     
   2300000   171.9          200            200            0.0030492299   2.2297867e-38  0              0.0091476898   6.843726e-15   0              3.3045904e-08  2.6109412e-16  0              2.995215     
   2400000   171.9          200            200            0.0030492299   2.725847e-38   0              0.0091476898   9.332885e-16   0              4.5065162e-09  2.6109412e-16  0              2.995215     
   2500000   171.9          200            200            0.0030492299   3.1321702e-38  0              0.0091476898   1.2216287e-16  0              5.8988077e-10  2.6109412e-16  0              2.995215     
   2600000   171.9          200            200            0.0030492299   2.3798162e-38  0              0.0091476898   1.495364e-17   0              7.2205776e-11  2.6109412e-16  0              2.995215     
   2700000   171.9          200            200            0.0030492299   8.343942e-39   0              0.0091476898   1.8397029e-18  0              8.8832668e-12  2.6109412e-16  0              2.995215     
   2800000   171.9          200            200            0.0030492299  -1.3172117e-38  0              0.0091476898   1.0079675e-19  0              4.8671145e-13  2.6109412e-16  0              2.995215     
   2900000   171.9          200            200            0.0030492299  -2.4534812e-38  0              0.0091476898   5.4825358e-20  0              2.6473203e-13  2.6109412e-16  0              2.995215     
   3000000   171.9          200            200            0.0030492299   1.9158903e-38  0              0.0091476898   2.6944903e-20  0              1.301073e-13   2.6109412e-16  0              2.995215     
Loop time of 64.167 on 4 procs for 3000000 steps with 51 atoms

Performance: 40394612.410 ns/day, 0.000 hours/ns, 46753.024 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28714    | 1.5523     | 5.0686     | 163.0 |  2.42
Neigh   | 0.08738    | 0.087962   | 0.089546   |   0.3 |  0.14
Comm    | 25.721     | 32.673     | 38.46      |  86.7 | 50.92
Output  | 0.060792   | 0.060878   | 0.060946   |   0.0 |  0.09
Modify  | 15.159     | 21.111     | 28.683     | 124.5 | 32.90
Other   |            | 8.683      |            |       | 13.53

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 23

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.74                                                               
Lattice spacing in x,y,z = 5.74 5.74 5.74

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -86.1 ${n1e1} -100 100 -100 100 units box
region box block -86.1 86.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.1 86.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-86.1 -100 -100) to (86.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-86.1 -100 -100) to (86.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-86.1 -100 -100) to (86.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_23_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 112 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.9 | 18.37 | 19.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   172.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   172.2          200            200            0.0024628115   2.2932593e-37  0              0.0073884345   12166.063      0              6.5272847e+10  2.6109412e-16  0              3.3312442    
    200000   172.2          200            200            0.00084531939 -1.1361376e-36  0              0.0025359582   2820.5278      0              1.5132577e+10  2.6109412e-16  0              3.0809539    
    300000   172.2          200            200            9.8742991e-06  1.4046711e-36  0              2.9622897e-05  0.85583861     0              4591709.3      2.6109412e-16  0              3.0447141    
    400000   172.2          200            200           -5.7408164e-05 -3.9563914e-37  0             -0.00017222449  33.195914      0              1.7810132e+08  2.6109412e-16  0              3.004709     
    500000   172.2          200            200            0.0048905523   1.1759491e-36  0              0.014671657    18.728664      0              1.0048224e+08  2.6109412e-16  0              2.9934758    
    600000   172.2          200            200            0.0028390514   4.0034807e-37  0              0.0085171542   3.8557766      0              20686850       2.6109412e-16  0              2.9954549    
    700000   172.2          200            200            0.0028902018   2.4284625e-36  0              0.0086706055   0.45466595     0              2439354.6      2.6109412e-16  0              2.9953852    
    800000   172.2          200            200            0.0029689294   1.3539152e-37  0              0.0089067883   0.052654629    0              282500.4       2.6109412e-16  0              2.9952966    
    900000   172.2          200            200            0.0030103705   4.1324818e-37  0              0.0090311115   0.0058025543   0              31131.62       2.6109412e-16  0              2.9952511    
   1000000   172.2          200            200            0.0030296234   1.1065394e-37  0              0.0090888703   0.00059723594  0              3204.2651      2.6109412e-16  0              2.9952303    
   1100000   172.2          200            200            0.0030380427  -1.6579743e-37  0              0.0091141281   5.6128177e-05  0              301.13653      2.6109412e-16  0              2.9952213    
   1200000   172.2          200            200            0.0030415721   3.488357e-38   0              0.0091247162   4.6228463e-06  0              24.8023        2.6109412e-16  0              2.9952175    
   1300000   172.2          200            200            0.0030430039   4.6144943e-38  0              0.0091290118   3.051511e-07   0              1.6371838      2.6109412e-16  0              2.995216     
   1400000   172.2          200            200            0.0030435695  -1.9183757e-38  0              0.0091307084   1.2422452e-08  0              0.066648415    2.6109412e-16  0              2.9952154    
   1500000   172.2          200            200            0.0030437877  -2.7992575e-38  0              0.009131363    4.1478383e-11  0              0.00022253808  2.6109412e-16  0              2.9952151    
   1600000   172.2          200            200            0.0030438701   1.9162235e-38  0              0.0091316103   1.0797403e-10  0              0.00057929773  2.6109412e-16  0              2.9952151    
   1700000   172.2          200            200            0.0030439006  -6.3070761e-39  0              0.0091317018   7.125713e-11   0              0.00038230576  2.6109412e-16  0              2.995215     
   1800000   172.2          200            200            0.0030439117   8.1606286e-39  0              0.0091317351   2.249959e-11   0              0.00012071385  2.6109412e-16  0              2.995215     
   1900000   172.2          200            200            0.0030439156  -1.2595052e-38  0              0.0091317469   5.3510594e-12  0              2.8709279e-05  2.6109412e-16  0              2.995215     
   2000000   172.2          200            200            0.003043917    1.1985989e-38  0              0.009131751    1.0884545e-12  0              5.8397305e-06  2.6109412e-16  0              2.995215     
   2100000   172.2          200            200            0.0030439175   4.9831357e-39  0              0.0091317524   1.998532e-13   0              1.072244e-06   2.6109412e-16  0              2.995215     
   2200000   172.2          200            200            0.0030439176   1.118196e-38   0              0.0091317529   3.4022784e-14  0              1.8253761e-07  2.6109412e-16  0              2.995215     
   2300000   172.2          200            200            0.0030439177   7.3653961e-39  0              0.009131753    5.4641289e-15  0              2.9315914e-08  2.6109412e-16  0              2.995215     
   2400000   172.2          200            200            0.0030439177   4.3242778e-39  0              0.0091317531   8.3373304e-16  0              4.4731094e-09  2.6109412e-16  0              2.995215     
   2500000   172.2          200            200            0.0030439177   2.5378506e-38  0              0.0091317531   1.2165604e-16  0              6.5270385e-10  2.6109412e-16  0              2.995215     
   2600000   172.2          200            200            0.0030439177   2.4063084e-38  0              0.0091317531   1.705867e-17   0              9.1522459e-11  2.6109412e-16  0              2.995215     
   2700000   172.2          200            200            0.0030439177   1.8338705e-38  0              0.0091317531   2.2613496e-18  0              1.2132497e-11  2.6109412e-16  0              2.995215     
   2800000   172.2          200            200            0.0030439177   1.364466e-38   0              0.0091317531   2.5096564e-19  0              1.3464703e-12  2.6109412e-16  0              2.995215     
   2900000   172.2          200            200            0.0030439177   1.721487e-38   0              0.0091317531   4.6927521e-20  0              2.5177356e-13  2.6109412e-16  0              2.995215     
   3000000   172.2          200            200            0.0030439177   7.6572651e-39  0              0.0091317531   2.1495094e-20  0              1.1532457e-13  2.6109412e-16  0              2.995215     
Loop time of 62.8963 on 4 procs for 3000000 steps with 50 atoms

Performance: 41210701.012 ns/day, 0.000 hours/ns, 47697.571 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29397    | 1.5265     | 4.9828     | 161.6 |  2.43
Neigh   | 0.088115   | 0.088665   | 0.090158   |   0.3 |  0.14
Comm    | 25.115     | 31.667     | 37.319     |  84.0 | 50.35
Output  | 0.061576   | 0.061657   | 0.06172    |   0.0 |  0.10
Modify  | 15.045     | 20.88      | 28.092     | 120.8 | 33.20
Other   |            | 8.672      |            |       | 13.79

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 24

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.75                                                               
Lattice spacing in x,y,z = 5.75 5.75 5.75

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -86.25 ${n1e1} -100 100 -100 100 units box
region box block -86.25 86.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.25 86.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-86.25 -100 -100) to (86.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-86.25 -100 -100) to (86.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-86.25 -100 -100) to (86.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_24_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 112 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.9 | 18.37 | 19.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   172.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   172.5          200            200            0.0024602565  -1.7121032e-37  0              0.0073807696   12179.121      0              5.8808618e+10  2.6109412e-16  0              3.3306681    
    200000   172.5          200            200            0.00084677297  7.8882267e-39  0              0.0025403189   2835.7681      0              1.3692909e+10  2.6109412e-16  0              3.0804673    
    300000   172.5          200            200            1.7877339e-05  9.3855264e-37  0              5.3632018e-05  2.7622911      0              13338115       2.6109412e-16  0              3.0448866    
    400000   172.5          200            200           -2.6350099e-05  2.3406461e-36  0             -7.9050296e-05  6.5787155      0              31766263       2.6109412e-16  0              3.0060444    
    500000   172.5          200            200            0.0058900191   2.2323224e-36  0              0.017670057    4.3806353      0              21152520       2.6109412e-16  0              2.9925756    
    600000   172.5          200            200            0.0033393691  -8.416423e-36   0              0.010018107    3.7219102      0              17971772       2.6109412e-16  0              2.9949249    
    700000   172.5          200            200            0.0030665612   2.5614054e-36  0              0.0091996835   0.54267787     0              2620397.2      2.6109412e-16  0              2.9951938    
    800000   172.5          200            200            0.0030283403   8.6706095e-38  0              0.009085021    0.073227675    0              353590.23      2.6109412e-16  0              2.9952288    
    900000   172.5          200            200            0.0030276521   1.2610394e-37  0              0.0090829563   0.0094971388   0              45858.284      2.6109412e-16  0              2.9952276    
   1000000   172.5          200            200            0.0030320094  -1.69036e-38    0              0.0090960282   0.0011821844   0              5708.3453      2.6109412e-16  0              2.9952223    
   1100000   172.5          200            200            0.0030352857   2.2122935e-37  0              0.009105857    0.0001406562   0              679.17845      2.6109412e-16  0              2.9952187    
   1200000   172.5          200            200            0.0030370865   9.9761705e-39  0              0.0091112594   1.5894502e-05  0              76.748862      2.6109412e-16  0              2.9952167    
   1300000   172.5          200            200            0.0030379556  -1.0443418e-38  0              0.0091138667   1.6884003e-06  0              8.1526806      2.6109412e-16  0              2.9952157    
   1400000   172.5          200            200            0.0030383451   1.4615819e-38  0              0.0091150352   1.6571376e-07  0              0.80017244     2.6109412e-16  0              2.9952153    
   1500000   172.5          200            200            0.0030385112   9.2351812e-39  0              0.0091155337   1.4572585e-08  0              0.070365799    2.6109412e-16  0              2.9952151    
   1600000   172.5          200            200            0.0030385796   8.0686951e-39  0              0.0091157387   1.0794005e-09  0              0.0052120386   2.6109412e-16  0              2.9952151    
   1700000   172.5          200            200            0.0030386069  -1.9316467e-38  0              0.0091158206   5.7733851e-11  0              0.00027877611  2.6109412e-16  0              2.995215     
   1800000   172.5          200            200            0.0030386175  -3.2433642e-39  0              0.0091158525   1.1866614e-12  0              5.7299633e-06  2.6109412e-16  0              2.995215     
   1900000   172.5          200            200            0.0030386215  -4.4982203e-39  0              0.0091158646   5.5038569e-14  0              2.6576155e-07  2.6109412e-16  0              2.995215     
   2000000   172.5          200            200            0.0030386231   1.981666e-39   0              0.0091158692   1.0131527e-13  0              4.892152e-07   2.6109412e-16  0              2.995215     
   2100000   172.5          200            200            0.0030386236  -1.6464457e-39  0              0.0091158709   4.0055467e-14  0              1.9341351e-07  2.6109412e-16  0              2.995215     
   2200000   172.5          200            200            0.0030386238  -4.6154598e-39  0              0.0091158715   1.055253e-14   0              5.0954393e-08  2.6109412e-16  0              2.995215     
   2300000   172.5          200            200            0.0030386239   1.2769338e-38  0              0.0091158717   2.2814209e-15  0              1.1016165e-08  2.6109412e-16  0              2.995215     
   2400000   172.5          200            200            0.0030386239   2.1978585e-38  0              0.0091158717   4.4099349e-16  0              2.1293998e-09  2.6109412e-16  0              2.995215     
   2500000   172.5          200            200            0.0030386239   1.2349306e-38  0              0.0091158718   7.6909942e-17  0              3.7137059e-10  2.6109412e-16  0              2.995215     
   2600000   172.5          200            200            0.0030386239   3.5746184e-38  0              0.0091158718   1.2762554e-17  0              6.1625803e-11  2.6109412e-16  0              2.995215     
   2700000   172.5          200            200            0.0030386239  -2.0307825e-38  0              0.0091158718   1.9034524e-18  0              9.1910906e-12  2.6109412e-16  0              2.995215     
   2800000   172.5          200            200            0.0030386239   1.4568979e-39  0              0.0091158718   3.0346007e-19  0              1.4653001e-12  2.6109412e-16  0              2.995215     
   2900000   172.5          200            200            0.0030386239   6.4368756e-39  0              0.0091158718   2.2536169e-20  0              1.0881909e-13  2.6109412e-16  0              2.995215     
   3000000   172.5          200            200            0.0030386239   1.0789118e-38  0              0.0091158718   2.4199726e-20  0              1.1685182e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2935 on 4 procs for 3000000 steps with 51 atoms

Performance: 40315113.846 ns/day, 0.000 hours/ns, 46661.011 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.27523    | 1.5657     | 5.1337     | 164.7 |  2.44
Neigh   | 0.088155   | 0.088732   | 0.090303   |   0.3 |  0.14
Comm    | 25.626     | 32.65      | 38.495     |  87.4 | 50.78
Output  | 0.059354   | 0.059433   | 0.059494   |   0.0 |  0.09
Modify  | 15.227     | 21.22      | 28.864     | 124.6 | 33.00
Other   |            | 8.71       |            |       | 13.55

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 25

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.76                                                               
Lattice spacing in x,y,z = 5.76 5.76 5.76

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -86.4 ${n1e1} -100 100 -100 100 units box
region box block -86.4 86.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.4 86.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-86.4 -100 -100) to (86.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-86.4 -100 -100) to (86.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-86.4 -100 -100) to (86.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_25_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 112 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.9 | 18.37 | 19.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   172.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   172.8          200            200            0.0024578233  -1.1385549e-37  0              0.0073734699   12193.066      0              5.8875951e+10  2.6109412e-16  0              3.330044     
    200000   172.8          200            200            0.00084819585  2.3658851e-37  0              0.0025445876   2850.8939      0              1.3765947e+10  2.6109412e-16  0              3.0799891    
    300000   172.8          200            200            2.5195479e-05  2.4850751e-37  0              7.5586437e-05  5.4290645      0              26215010       2.6109412e-16  0              3.0450362    
    400000   172.8          200            200            7.1851858e-06 -3.6096924e-36  0              2.1555557e-05  0.47202387     0              2279234.3      2.6109412e-16  0              3.0064435    
    500000   172.8          200            200            0.0059665183  -4.6036671e-35  0              0.017899555    2.5672582      0              12396371       2.6109412e-16  0              2.9924698    
    600000   172.8          200            200            0.0038984813   1.7324251e-36  0              0.011695444    1.4736964      0              7115952.7      2.6109412e-16  0              2.9943551    
    700000   172.8          200            200            0.0032857693  -1.6977228e-37  0              0.0098573078   0.32101577     0              1550070.3      2.6109412e-16  0              2.9949589    
    800000   172.8          200            200            0.0031087749  -1.317553e-36   0              0.0093263247   0.05364896     0              259051.63      2.6109412e-16  0              2.9951385    
    900000   172.8          200            200            0.0030546113   1.72723e-37    0              0.0091638339   0.0083912106   0              40518.153      2.6109412e-16  0              2.9951937    
   1000000   172.8          200            200            0.0030386479   5.9471295e-38  0              0.0091159437   0.0012530807   0              6050.6784      2.6109412e-16  0              2.9952098    
   1100000   172.8          200            200            0.0030343305  -8.4433227e-40  0              0.0091029914   0.0001794469   0              866.48486      2.6109412e-16  0              2.9952141    
   1200000   172.8          200            200            0.0030333463   8.5244777e-40  0              0.0091000388   2.4691136e-05  0              119.22466      2.6109412e-16  0              2.9952151    
   1300000   172.8          200            200            0.0030332139   1.5410567e-38  0              0.0090996418   3.2659895e-06  0              15.770295      2.6109412e-16  0              2.9952152    
   1400000   172.8          200            200            0.0030332508  -7.2112877e-39  0              0.0090997523   4.1489349e-07  0              2.0033722      2.6109412e-16  0              2.9952151    
   1500000   172.8          200            200            0.0030332955  -1.3314251e-38  0              0.0090998866   5.0482782e-08  0              0.24376329     2.6109412e-16  0              2.9952151    
   1600000   172.8          200            200            0.0030333231   7.9619555e-39  0              0.0090999694   5.8547682e-09  0              0.028270581    2.6109412e-16  0              2.995215     
   1700000   172.8          200            200            0.0030333372  -4.3445935e-39  0              0.0091000116   6.4196399e-10  0              0.0030998143   2.6109412e-16  0              2.995215     
   1800000   172.8          200            200            0.0030333437   3.4620052e-39  0              0.0091000312   6.5665615e-11  0              0.00031707575  2.6109412e-16  0              2.995215     
   1900000   172.8          200            200            0.0030333466   2.7749156e-38  0              0.0091000397   6.123676e-12   0              2.956904e-05   2.6109412e-16  0              2.995215     
   2000000   172.8          200            200            0.0030333477  -6.317452e-39   0              0.0091000432   4.9867245e-13  0              2.4079108e-06  2.6109412e-16  0              2.995215     
   2100000   172.8          200            200            0.0030333482   8.2758788e-39  0              0.0091000447   3.2253491e-14  0              1.5574057e-07  2.6109412e-16  0              2.995215     
   2200000   172.8          200            200            0.0030333484   2.4018491e-40  0              0.0091000453   1.2444566e-15  0              6.0090355e-09  2.6109412e-16  0              2.995215     
   2300000   172.8          200            200            0.0030333485   1.7123653e-39  0              0.0091000455   2.0454436e-18  0              9.8767153e-12  2.6109412e-16  0              2.995215     
   2400000   172.8          200            200            0.0030333485  -1.5795899e-38  0              0.0091000456   1.3088086e-17  0              6.3197683e-11  2.6109412e-16  0              2.995215     
   2500000   172.8          200            200            0.0030333485  -2.3705747e-38  0              0.0091000456   7.7002593e-18  0              3.7181797e-11  2.6109412e-16  0              2.995215     
   2600000   172.8          200            200            0.0030333485  -1.1267236e-38  0              0.0091000456   2.7884313e-18  0              1.3464337e-11  2.6109412e-16  0              2.995215     
   2700000   172.8          200            200            0.0030333485   3.0489998e-38  0              0.0091000456   6.7501782e-19  0              3.2594195e-12  2.6109412e-16  0              2.995215     
   2800000   172.8          200            200            0.0030333485   5.3274901e-39  0              0.0091000456   1.920875e-19   0              9.275218e-13   2.6109412e-16  0              2.995215     
   2900000   172.8          200            200            0.0030333485  -2.249478e-38   0              0.0091000456   3.1227739e-23  0              1.5078758e-16  2.6109412e-16  0              2.995215     
   3000000   172.8          200            200            0.0030333485   4.1603359e-38  0              0.0091000456   1.4521892e-19  0              7.0121021e-13  2.6109412e-16  0              2.995215     
Loop time of 64.051 on 4 procs for 3000000 steps with 51 atoms

Performance: 40467734.155 ns/day, 0.000 hours/ns, 46837.655 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29438    | 1.5451     | 5.0475     | 162.8 |  2.41
Neigh   | 0.087196   | 0.087745   | 0.089256   |   0.3 |  0.14
Comm    | 25.646     | 32.555     | 38.357     |  86.6 | 50.83
Output  | 0.06137    | 0.061449   | 0.061509   |   0.0 |  0.10
Modify  | 15.136     | 21.071     | 28.562     | 123.4 | 32.90
Other   |            | 8.731      |            |       | 13.63

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 26

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.77                                                               
Lattice spacing in x,y,z = 5.77 5.77 5.77

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -86.55 ${n1e1} -100 100 -100 100 units box
region box block -86.55 86.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.55 86.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-86.55 -100 -100) to (86.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-86.55 -100 -100) to (86.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-86.55 -100 -100) to (86.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_26_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 112 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.9 | 18.37 | 19.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   173.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   173.1          200            200            0.0024554572   2.8513038e-38  0              0.0073663716   12207.434      0              5.8945329e+10  2.6109412e-16  0              3.3294104    
    200000   173.1          200            200            0.00084987084 -4.4907034e-37  0              0.0025496125   2867.4281      0              1.3845784e+10  2.6109412e-16  0              3.0794303    
    300000   173.1          200            200            3.2012751e-05 -8.9268781e-37  0              9.6038253e-05  8.6892063      0              41957067       2.6109412e-16  0              3.0451683    
    400000   173.1          200            200            4.1053861e-05 -1.3279046e-36  0              0.00012316158  14.422573      0              69641442       2.6109412e-16  0              3.0059075    
    500000   173.1          200            200            0.0040420352   1.1320175e-34  0              0.012126106    25.709829      0              1.2414357e+08  2.6109412e-16  0              2.9941496    
    600000   173.1          200            200            0.004083187   -1.4282425e-35  0              0.012249561    0.18846715     0              910040.41      2.6109412e-16  0              2.9941541    
    700000   173.1          200            200            0.0034185454  -5.1388924e-36  0              0.010255636    0.00038682736  0              1867.8509      2.6109412e-16  0              2.9948118    
    800000   173.1          200            200            0.0031684694   2.1161135e-36  0              0.0095054082   0.0023664584   0              11426.781      2.6109412e-16  0              2.9950686    
    900000   173.1          200            200            0.0030778001   1.7429686e-36  0              0.0092334003   0.00099678325  0              4813.1096      2.6109412e-16  0              2.9951631    
   1000000   173.1          200            200            0.0030453535   1.9828119e-37  0              0.0091360604   0.00026782488  0              1293.2305      2.6109412e-16  0              2.995197     
   1100000   173.1          200            200            0.0030339458  -1.4601306e-39  0              0.0091018375   5.850944e-05   0              282.52114      2.6109412e-16  0              2.9952089    
   1200000   173.1          200            200            0.003030021    1.5726658e-39  0              0.0090900631   1.1276941e-05  0              54.452312      2.6109412e-16  0              2.995213     
   1300000   173.1          200            200            0.003028705   -1.2380519e-38  0              0.0090861149   1.9919036e-06  0              9.6181897      2.6109412e-16  0              2.9952144    
   1400000   173.1          200            200            0.0030282773   3.5272042e-39  0              0.0090848318   3.2918266e-07  0              1.5895053      2.6109412e-16  0              2.9952148    
   1500000   173.1          200            200            0.0030281438  -2.3492947e-39  0              0.0090844314   5.1521959e-08  0              0.2487811      2.6109412e-16  0              2.995215     
   1600000   173.1          200            200            0.0030281044  -4.5329474e-40  0              0.0090843133   7.6942213e-09  0              0.037152641    2.6109412e-16  0              2.995215     
   1700000   173.1          200            200            0.0030280938   9.8218784e-39  0              0.0090842814   1.1012457e-09  0              0.0053175214   2.6109412e-16  0              2.995215     
   1800000   173.1          200            200            0.0030280914   4.531798e-39   0              0.0090842742   1.514146e-10   0              0.00073112693  2.6109412e-16  0              2.995215     
   1900000   173.1          200            200            0.0030280911  -1.2861806e-38  0              0.0090842733   2.0012482e-11  0              9.6633115e-05  2.6109412e-16  0              2.995215     
   2000000   173.1          200            200            0.0030280912   3.9984405e-39  0              0.0090842736   2.5402304e-12  0              1.2265863e-05  2.6109412e-16  0              2.995215     
   2100000   173.1          200            200            0.0030280913  -4.8214817e-41  0              0.0090842739   3.0876606e-13  0              1.4909208e-06  2.6109412e-16  0              2.995215     
   2200000   173.1          200            200            0.0030280914   7.0755081e-39  0              0.0090842741   3.5770672e-14  0              1.7272377e-07  2.6109412e-16  0              2.995215     
   2300000   173.1          200            200            0.0030280914  -1.7317546e-38  0              0.0090842742   3.9265816e-15  0              1.8960057e-08  2.6109412e-16  0              2.995215     
   2400000   173.1          200            200            0.0030280914   8.6987971e-39  0              0.0090842743   3.9756921e-16  0              1.9197194e-09  2.6109412e-16  0              2.995215     
   2500000   173.1          200            200            0.0030280914  -5.6224828e-39  0              0.0090842743   3.6484701e-17  0              1.7617156e-10  2.6109412e-16  0              2.995215     
   2600000   173.1          200            200            0.0030280914  -1.0391877e-38  0              0.0090842743   2.6073404e-18  0              1.2589913e-11  2.6109412e-16  0              2.995215     
   2700000   173.1          200            200            0.0030280914  -9.1216144e-39  0              0.0090842743   2.0695578e-19  0              9.9931538e-13  2.6109412e-16  0              2.995215     
   2800000   173.1          200            200            0.0030280914   8.9209169e-39  0              0.0090842743   8.0841677e-25  0              3.9035553e-18  2.6109412e-16  0              2.995215     
   2900000   173.1          200            200            0.0030280914  -1.4954713e-38  0              0.0090842743   5.7394345e-20  0              2.7713675e-13  2.6109412e-16  0              2.995215     
   3000000   173.1          200            200            0.0030280914   3.1462165e-38  0              0.0090842743   6.1650834e-20  0              2.9768981e-13  2.6109412e-16  0              2.995215     
Loop time of 63.6903 on 4 procs for 3000000 steps with 51 atoms

Performance: 40696927.880 ns/day, 0.000 hours/ns, 47102.926 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31679    | 1.5112     | 4.9078     | 159.6 |  2.37
Neigh   | 0.08708    | 0.087652   | 0.089192   |   0.3 |  0.14
Comm    | 25.659     | 32.267     | 38.009     |  84.4 | 50.66
Output  | 0.061395   | 0.061477   | 0.061546   |   0.0 |  0.10
Modify  | 15.144     | 21.018     | 28.26      | 121.7 | 33.00
Other   |            | 8.745      |            |       | 13.73

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 27

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.78                                                               
Lattice spacing in x,y,z = 5.78 5.78 5.78

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -86.7 ${n1e1} -100 100 -100 100 units box
region box block -86.7 86.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.7 86.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-86.7 -100 -100) to (86.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-86.7 -100 -100) to (86.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-86.7 -100 -100) to (86.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_27_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 112 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.9 | 18.37 | 19.53 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   173.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   173.4          200            200            0.0024531164   3.5554893e-39  0              0.0073593492   12221.874      0              5.9015054e+10  2.6109412e-16  0              3.3287956    
    200000   173.4          200            200            0.0008516203  -2.6107083e-36  0              0.0025548609   2884.423       0              1.3927846e+10  2.6109412e-16  0              3.0788471    
    300000   173.4          200            200            3.8206779e-05 -6.6501059e-37  0              0.00011462034  12.289506      0              59341627       2.6109412e-16  0              3.0452928    
    400000   173.4          200            200            7.3574088e-05  4.8760288e-37  0              0.00022072227  44.190502      0              2.1338012e+08  2.6109412e-16  0              3.0046205    
    500000   173.4          200            200            0.0012000149   9.9220855e-37  0              0.0036000446   15.086604      0              72847813       2.6109412e-16  0              2.9973609    
    600000   173.4          200            200            0.0032051199   4.2466791e-36  0              0.0096153596   3.8702819      0              18688206       2.6109412e-16  0              2.9950035    
    700000   173.4          200            200            0.0031862151   1.4059658e-35  0              0.0095586453   0.44150415     0              2131865.5      2.6109412e-16  0              2.9950368    
    800000   173.4          200            200            0.0031026564  -3.2970432e-39  0              0.0093079693   0.049485148    0              238946.07      2.6109412e-16  0              2.9951287    
    900000   173.4          200            200            0.0030580673   6.1169809e-37  0              0.0091742018   0.005293974    0              25562.706      2.6109412e-16  0              2.9951771    
   1000000   173.4          200            200            0.003037656    3.1528796e-38  0              0.009112968    0.00052735984  0              2546.4319      2.6109412e-16  0              2.9951991    
   1100000   173.4          200            200            0.0030288683  -3.0191856e-39  0              0.0090866049   4.747561e-05   0              229.24273      2.6109412e-16  0              2.9952086    
   1200000   173.4          200            200            0.0030252316   4.8237997e-39  0              0.0090756949   3.6586259e-06  0              17.666195      2.6109412e-16  0              2.9952125    
   1300000   173.4          200            200            0.0030237716  -7.4937004e-39  0              0.0090713149   2.1263457e-07  0              1.0267362      2.6109412e-16  0              2.995214     
   1400000   173.4          200            200            0.0030232002   4.4527582e-40  0              0.0090696005   5.9440732e-09  0              0.028701802    2.6109412e-16  0              2.9952146    
   1500000   173.4          200            200            0.0030229814   3.4251051e-39  0              0.0090689442   3.8866363e-11  0              0.00018767176  2.6109412e-16  0              2.9952149    
   1600000   173.4          200            200            0.0030228994   6.1504403e-39  0              0.0090686981   2.2424527e-10  0              0.0010828001   2.6109412e-16  0              2.995215     
   1700000   173.4          200            200            0.0030228692  -6.4919577e-39  0              0.0090686076   1.0131325e-10  0              0.00048920542  2.6109412e-16  0              2.995215     
   1800000   173.4          200            200            0.0030228583  -1.5377765e-39  0              0.009068575    2.8156118e-11  0              0.00013595582  2.6109412e-16  0              2.995215     
   1900000   173.4          200            200            0.0030228545   1.0887824e-38  0              0.0090685635   6.267521e-12   0              3.0263616e-05  2.6109412e-16  0              2.995215     
   2000000   173.4          200            200            0.0030228532  -8.3007273e-39  0              0.0090685595   1.2226486e-12  0              5.9037325e-06  2.6109412e-16  0              2.995215     
   2100000   173.4          200            200            0.0030228527   1.3805934e-38  0              0.0090685582   2.1783185e-13  0              1.0518321e-06  2.6109412e-16  0              2.995215     
   2200000   173.4          200            200            0.0030228526  -1.3398331e-38  0              0.0090685578   3.6251787e-14  0              1.750469e-07   2.6109412e-16  0              2.995215     
   2300000   173.4          200            200            0.0030228525  -6.3530402e-39  0              0.0090685576   5.704249e-15   0              2.7543777e-08  2.6109412e-16  0              2.995215     
   2400000   173.4          200            200            0.0030228525  -4.1195447e-39  0              0.0090685576   8.5660668e-16  0              4.1362471e-09  2.6109412e-16  0              2.995215     
   2500000   173.4          200            200            0.0030228525  -4.8818491e-39  0              0.0090685576   1.2317002e-16  0              5.9474393e-10  2.6109412e-16  0              2.995215     
   2600000   173.4          200            200            0.0030228525  -1.2153067e-38  0              0.0090685576   1.6946191e-17  0              8.1827094e-11  2.6109412e-16  0              2.995215     
   2700000   173.4          200            200            0.0030228525  -1.1672106e-38  0              0.0090685576   2.2255084e-18  0              1.0746184e-11  2.6109412e-16  0              2.995215     
   2800000   173.4          200            200            0.0030228525  -1.2276964e-38  0              0.0090685576   2.483945e-19   0              1.1994081e-12  2.6109412e-16  0              2.995215     
   2900000   173.4          200            200            0.0030228525   7.4085893e-39  0              0.0090685576   1.2857885e-19  0              6.2086127e-13  2.6109412e-16  0              2.995215     
   3000000   173.4          200            200            0.0030228525  -1.298203e-38   0              0.0090685576   2.0556102e-21  0              9.9258061e-15  2.6109412e-16  0              2.995215     
Loop time of 64.0352 on 4 procs for 3000000 steps with 51 atoms

Performance: 40477748.949 ns/day, 0.000 hours/ns, 46849.246 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29518    | 1.5209     | 4.9599     | 161.1 |  2.38
Neigh   | 0.087083   | 0.087668   | 0.089218   |   0.3 |  0.14
Comm    | 25.619     | 32.498     | 38.309     |  86.6 | 50.75
Output  | 0.062664   | 0.062749   | 0.062813   |   0.0 |  0.10
Modify  | 15.218     | 21.135     | 28.656     | 124.1 | 33.00
Other   |            | 8.731      |            |       | 13.63

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 28

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.79                                                               
Lattice spacing in x,y,z = 5.79 5.79 5.79

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -86.85 ${n1e1} -100 100 -100 100 units box
region box block -86.85 86.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -86.85 86.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-86.85 -100 -100) to (86.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-86.85 -100 -100) to (86.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-86.85 -100 -100) to (86.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_28_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 113 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.92 | 18.39 | 19.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   173.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   173.7          200            200            0.0024507696   8.8704247e-40  0              0.0073523087   12236.124      0              5.9083864e+10  2.6109412e-16  0              3.328219     
    200000   173.7          200            200            0.00085374113  4.2436647e-39  0              0.0025612234   2903.4943      0              1.4019935e+10  2.6109412e-16  0              3.0781466    
    300000   173.7          200            200            4.3984313e-05  3.8793846e-36  0              0.00013195294  16.187602      0              78164136       2.6109412e-16  0              3.0454095    
    400000   173.7          200            200            0.00010395594  2.8865829e-38  0              0.00031186783  84.775323      0              4.0934969e+08  2.6109412e-16  0              3.0028112    
    500000   173.7          200            200            0.00097390816  2.6727556e-36  0              0.0029217245   9.7565933      0              47111097       2.6109412e-16  0              2.9978016    
    600000   173.7          200            200            0.0020348499  -2.4237489e-36  0              0.0061045497   0.1458888      0              704444.8       2.6109412e-16  0              2.9963166    
    700000   173.7          200            200            0.0026724779  -4.2653701e-36  0              0.0080174337   0.094890343    0              458191.51      2.6109412e-16  0              2.9955841    
    800000   173.7          200            200            0.0029000773   2.4745176e-36  0              0.0087002319   0.022591577    0              109086.64      2.6109412e-16  0              2.9953386    
    900000   173.7          200            200            0.0029787679   8.1220769e-39  0              0.0089363037   0.0044342482   0              21411.398      2.6109412e-16  0              2.9952555    
   1000000   173.7          200            200            0.0030052402   1.353156e-37   0              0.0090157206   0.00078899813  0              3809.7896      2.6109412e-16  0              2.9952278    
   1100000   173.7          200            200            0.0030138651   6.6000179e-38  0              0.0090415952   0.00013096754  0              632.3954       2.6109412e-16  0              2.9952189    
   1200000   173.7          200            200            0.0030165646  -2.3187408e-39  0              0.0090496939   2.0566334e-05  0              99.307468      2.6109412e-16  0              2.9952161    
   1300000   173.7          200            200            0.003017364    1.8798103e-38  0              0.0090520921   3.0799514e-06  0              14.871983      2.6109412e-16  0              2.9952153    
   1400000   173.7          200            200            0.0030175811  -5.5827885e-39  0              0.0090527433   4.419463e-07   0              2.1340005      2.6109412e-16  0              2.9952151    
   1500000   173.7          200            200            0.0030176311   1.8870994e-39  0              0.0090528932   6.0913441e-08  0              0.29412921     2.6109412e-16  0              2.995215     
   1600000   173.7          200            200            0.0030176381   1.0346804e-38  0              0.0090529143   8.07048e-09    0              0.03896946     2.6109412e-16  0              2.995215     
   1700000   173.7          200            200            0.0030176364   4.958971e-39   0              0.0090529093   1.0269707e-09  0              0.0049588739   2.6109412e-16  0              2.995215     
   1800000   173.7          200            200            0.0030176343   5.9959031e-39  0              0.0090529029   1.2518967e-10  0              0.00060449613  2.6109412e-16  0              2.995215     
   1900000   173.7          200            200            0.0030176329   2.2489783e-40  0              0.0090528988   1.4549495e-11  0              7.0254307e-05  2.6109412e-16  0              2.995215     
   2000000   173.7          200            200            0.0030176323   1.2480132e-38  0              0.0090528968   1.5992687e-12  0              7.7222964e-06  2.6109412e-16  0              2.995215     
   2100000   173.7          200            200            0.0030176319  -8.2138865e-39  0              0.0090528958   1.6406949e-13  0              7.9223283e-07  2.6109412e-16  0              2.995215     
   2200000   173.7          200            200            0.0030176318   7.3564324e-39  0              0.0090528954   1.5375061e-14  0              7.4240669e-08  2.6109412e-16  0              2.995215     
   2300000   173.7          200            200            0.0030176317   1.0872118e-38  0              0.0090528952   1.2637241e-15  0              6.1020716e-09  2.6109412e-16  0              2.995215     
   2400000   173.7          200            200            0.0030176317  -1.1882258e-39  0              0.0090528952   8.5461244e-17  0              4.1266176e-10  2.6109412e-16  0              2.995215     
   2500000   173.7          200            200            0.0030176317   6.6849171e-39  0              0.0090528951   3.7263829e-18  0              1.799337e-11   2.6109412e-16  0              2.995215     
   2600000   173.7          200            200            0.0030176317  -6.2801612e-39  0              0.0090528951   3.6411254e-21  0              1.7581692e-14  2.6109412e-16  0              2.995215     
   2700000   173.7          200            200            0.0030176317   6.0745187e-39  0              0.0090528951   5.3445052e-20  0              2.5806703e-13  2.6109412e-16  0              2.995215     
   2800000   173.7          200            200            0.0030176317   1.0078097e-38  0              0.0090528951   5.9896705e-20  0              2.8921975e-13  2.6109412e-16  0              2.995215     
   2900000   173.7          200            200            0.0030176317   1.2864994e-38  0              0.0090528951   1.2905882e-21  0              6.2317883e-15  2.6109412e-16  0              2.995215     
   3000000   173.7          200            200            0.0030176317   1.80244e-38    0              0.0090528951   5.8247095e-20  0              2.8125438e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0272 on 4 procs for 3000000 steps with 51 atoms

Performance: 40482822.108 ns/day, 0.000 hours/ns, 46855.118 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30565    | 1.5056     | 4.8979     | 159.7 |  2.35
Neigh   | 0.087754   | 0.088312   | 0.089879   |   0.3 |  0.14
Comm    | 25.688     | 32.453     | 38.211     |  85.5 | 50.69
Output  | 0.061609   | 0.061689   | 0.061748   |   0.0 |  0.10
Modify  | 15.156     | 21.087     | 28.484     | 122.5 | 32.93
Other   |            | 8.832      |            |       | 13.79

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 29

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.8                                                               
Lattice spacing in x,y,z = 5.8 5.8 5.8

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87 ${n1e1} -100 100 -100 100 units box
region box block -87 87 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87 87 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87 -100 -100) to (87 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-87 -100 -100) to (87 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87 -100 -100) to (87 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_29_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 113 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.92 | 18.39 | 19.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   174            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   174            200            200            0.0024483932  -1.4123128e-38  0              0.0073451797   12249.992      0              5.9150828e+10  2.6109412e-16  0              3.3276936    
    200000   174            200            200            0.00085622874  1.2519849e-36  0              0.0025686862   2924.6365      0              1.4122023e+10  2.6109412e-16  0              3.0773326    
    300000   174            200            200            4.9328794e-05 -6.668715e-37   0              0.00014798638  20.253445      0              97796636       2.6109412e-16  0              3.0455229    
    400000   174            200            200            0.00013158168 -1.3408369e-36  0              0.00039474503  131.35182      0              6.3425093e+08  2.6109412e-16  0              3.0007073    
    500000   174            200            200            0.0057419891  -6.7202126e-05  0              0.017293169    8.5958762      0              41506410       2.6109412e-16  0              2.9928231    
    600000   174            200            200            0.0035320262  -1.1676587e-36  0              0.010596079    3.0605018      0              14778068       2.6109412e-16  0              2.9946974    
    700000   174            200            200            0.0031247103   3.6284808e-37  0              0.0093741308   0.49725201     0              2401052        2.6109412e-16  0              2.9951044    
    800000   174            200            200            0.0030337432   3.9200544e-38  0              0.0091012295   0.071687165    0              346151.66      2.6109412e-16  0              2.9951954    
    900000   174            200            200            0.0030131119   5.4868341e-38  0              0.0090393356   0.0098992143   0              47799.763      2.6109412e-16  0              2.9952154    
   1000000   174            200            200            0.003010035   -1.6850786e-38  0              0.009030105    0.0013149413   0              6349.3812      2.6109412e-16  0              2.9952179    
   1100000   174            200            200            0.0030105885  -1.245935e-38   0              0.0090317654   0.00016781779  0              810.33205      2.6109412e-16  0              2.9952171    
   1200000   174            200            200            0.0030114114   1.6631922e-38  0              0.0090342342   2.0522701e-05  0              99.096779      2.6109412e-16  0              2.9952161    
   1300000   174            200            200            0.0030119366   1.4561641e-38  0              0.0090358098   2.3937371e-06  0              11.5585        2.6109412e-16  0              2.9952156    
   1400000   174            200            200            0.0030122079  -8.5760406e-39  0              0.0090366238   2.6425732e-07  0              1.276004       2.6109412e-16  0              2.9952153    
   1500000   174            200            200            0.0030123345   1.477387e-38   0              0.0090370036   2.7264911e-08  0              0.1316525      2.6109412e-16  0              2.9952151    
   1600000   174            200            200            0.0030123901   8.2096806e-39  0              0.0090371702   2.5730679e-09  0              0.012424424    2.6109412e-16  0              2.9952151    
   1700000   174            200            200            0.0030124134  -1.6521283e-39  0              0.0090372401   2.1340809e-10  0              0.0010304713   2.6109412e-16  0              2.995215     
   1800000   174            200            200            0.0030124228  -8.6590149e-39  0              0.0090372685   1.427243e-11   0              6.8916455e-05  2.6109412e-16  0              2.995215     
   1900000   174            200            200            0.0030124266   1.3770863e-38  0              0.0090372797   6.011325e-13   0              2.9026537e-06  2.6109412e-16  0              2.995215     
   2000000   174            200            200            0.003012428    3.6582344e-39  0              0.0090372841   2.872575e-15   0              1.3870637e-08  2.6109412e-16  0              2.995215     
   2100000   174            200            200            0.0030124286   1.7511835e-39  0              0.0090372857   4.3476346e-15  0              2.0993171e-08  2.6109412e-16  0              2.995215     
   2200000   174            200            200            0.0030124288  -7.893982e-40   0              0.0090372863   3.0548331e-15  0              1.4750696e-08  2.6109412e-16  0              2.995215     
   2300000   174            200            200            0.0030124289  -7.4871063e-39  0              0.0090372866   9.7799907e-16  0              4.7224075e-09  2.6109412e-16  0              2.995215     
   2400000   174            200            200            0.0030124289   4.7003954e-39  0              0.0090372866   2.3645131e-16  0              1.1417388e-09  2.6109412e-16  0              2.995215     
   2500000   174            200            200            0.0030124289  -5.3834951e-39  0              0.0090372867   4.8737017e-17  0              2.3533361e-10  2.6109412e-16  0              2.995215     
   2600000   174            200            200            0.0030124289  -9.374525e-39   0              0.0090372867   9.0768867e-18  0              4.3829038e-11  2.6109412e-16  0              2.995215     
   2700000   174            200            200            0.0030124289   2.0641856e-38  0              0.0090372867   1.395733e-18   0              6.739495e-12   2.6109412e-16  0              2.995215     
   2800000   174            200            200            0.0030124289   4.9984905e-39  0              0.0090372867   2.7430558e-19  0              1.3245235e-12  2.6109412e-16  0              2.995215     
   2900000   174            200            200            0.0030124289   3.9485804e-40  0              0.0090372867   3.4815349e-21  0              1.6811086e-14  2.6109412e-16  0              2.995215     
   3000000   174            200            200            0.0030124289  -2.2235647e-40  0              0.0090372867   7.431785e-20   0              3.588543e-13   2.6109412e-16  0              2.995215     
Loop time of 63.8936 on 4 procs for 3000000 steps with 51 atoms

Performance: 40567419.951 ns/day, 0.000 hours/ns, 46953.032 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3345     | 1.5005     | 4.8455     | 157.7 |  2.35
Neigh   | 0.087747   | 0.088364   | 0.089923   |   0.3 |  0.14
Comm    | 25.662     | 32.414     | 38.156     |  85.7 | 50.73
Output  | 0.059751   | 0.059827   | 0.059884   |   0.0 |  0.09
Modify  | 15.172     | 21.075     | 28.451     | 122.8 | 32.98
Other   |            | 8.756      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 30

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.81                                                               
Lattice spacing in x,y,z = 5.81 5.81 5.81

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87.15 ${n1e1} -100 100 -100 100 units box
region box block -87.15 87.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.15 87.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87.15 -100 -100) to (87.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-87.15 -100 -100) to (87.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87.15 -100 -100) to (87.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_30_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 113 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.92 | 18.39 | 19.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   174.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   174.3          200            200            0.0024459701  -7.0695699e-38  0              0.0073379103   12263.339      0              5.9215275e+10  2.6109412e-16  0              3.3272271    
    200000   174.3          200            200            0.00085941071 -4.5045187e-37  0              0.0025782321   2949.6624      0              1.4242864e+10  2.6109412e-16  0              3.0763049    
    300000   174.3          200            200            5.4438879e-05  1.5965069e-36  0              0.00016331664  24.549531      0              1.185409e+08   2.6109412e-16  0              3.0456284    
    400000   174.3          200            200            0.00069165419 -5.2434719e-39  0              0.0020749626   178.0024       0              8.5950991e+08  2.6109412e-16  0              2.9984848    
    500000   174.3          200            200            0.0022285651   5.6664068e-36  0              0.0066856954   27.594949      0              1.3324613e+08  2.6109412e-16  0              2.9960218    
    600000   174.3          200            200            0.0021636223   6.5792506e-36  0              0.006490867    1.1867978      0              5730622        2.6109412e-16  0              2.9961456    
    700000   174.3          200            200            0.0027488088   1.4943178e-36  0              0.0082464265   0.29179892     0              1408992.5      2.6109412e-16  0              2.9954874    
    800000   174.3          200            200            0.0029289397   2.0361899e-37  0              0.008786819    0.05075396     0              245072.71      2.6109412e-16  0              2.995296     
    900000   174.3          200            200            0.0029848397   3.0712472e-37  0              0.008954519    0.0080851327   0              39040.212      2.6109412e-16  0              2.9952378    
   1000000   174.3          200            200            0.0030014912  -8.3856511e-39  0              0.0090044737   0.001221003    0              5895.7864      2.6109412e-16  0              2.9952207    
   1100000   174.3          200            200            0.0030060815   3.781766e-38   0              0.0090182444   0.00017639192  0              851.73345      2.6109412e-16  0              2.9952161    
   1200000   174.3          200            200            0.003007175   -2.1213192e-39  0              0.009021525    2.4464131e-05  0              118.12853      2.6109412e-16  0              2.995215     
   1300000   174.3          200            200            0.003007351   -6.7898204e-40  0              0.0090220529   3.2613007e-06  0              15.747654      2.6109412e-16  0              2.9952149    
   1400000   174.3          200            200            0.0030073312   2.105861e-39   0              0.0090219937   4.1766035e-07  0              2.0167324      2.6109412e-16  0              2.9952149    
   1500000   174.3          200            200            0.0030072931   1.4700012e-39  0              0.0090218792   5.1266598e-08  0              0.24754805     2.6109412e-16  0              2.995215     
   1600000   174.3          200            200            0.0030072679   3.1210541e-39  0              0.0090218038   6.0050523e-09  0              0.028996248    2.6109412e-16  0              2.995215     
   1700000   174.3          200            200            0.0030072548  -1.7840186e-39  0              0.0090217644   6.6629824e-10  0              0.0032173158   2.6109412e-16  0              2.995215     
   1800000   174.3          200            200            0.0030072486  -3.9437901e-39  0              0.0090217459   6.9188756e-11  0              0.00033408774  2.6109412e-16  0              2.995215     
   1900000   174.3          200            200            0.0030072459  -2.4714444e-39  0              0.0090217377   6.5869986e-12  0              3.1806259e-05  2.6109412e-16  0              2.995215     
   2000000   174.3          200            200            0.0030072448  -3.5427125e-39  0              0.0090217343   5.5369798e-13  0              2.6736094e-06  2.6109412e-16  0              2.995215     
   2100000   174.3          200            200            0.0030072443  -2.7305262e-39  0              0.0090217329   3.7928936e-14  0              1.8314526e-07  2.6109412e-16  0              2.995215     
   2200000   174.3          200            200            0.0030072441  -4.4451593e-39  0              0.0090217323   1.6994992e-15  0              8.2062735e-09  2.6109412e-16  0              2.995215     
   2300000   174.3          200            200            0.003007244    5.4659185e-39  0              0.0090217321   1.3389446e-17  0              6.4652844e-11  2.6109412e-16  0              2.995215     
   2400000   174.3          200            200            0.003007244    2.2618717e-39  0              0.009021732    9.2637789e-18  0              4.4731473e-11  2.6109412e-16  0              2.995215     
   2500000   174.3          200            200            0.003007244    1.0704257e-38  0              0.009021732    6.4747418e-18  0              3.1264211e-11  2.6109412e-16  0              2.995215     
   2600000   174.3          200            200            0.003007244    1.1357393e-38  0              0.009021732    2.3383557e-18  0              1.1291083e-11  2.6109412e-16  0              2.995215     
   2700000   174.3          200            200            0.003007244   -1.0702034e-39  0              0.009021732    5.2625791e-19  0              2.5411111e-12  2.6109412e-16  0              2.995215     
   2800000   174.3          200            200            0.003007244   -2.6983955e-39  0              0.009021732    1.6663533e-19  0              8.0462237e-13  2.6109412e-16  0              2.995215     
   2900000   174.3          200            200            0.003007244    4.7190588e-39  0              0.009021732    1.1293344e-21  0              5.4531514e-15  2.6109412e-16  0              2.995215     
   3000000   174.3          200            200            0.003007244    4.4021032e-39  0              0.009021732    7.6400734e-20  0              3.689118e-13   2.6109412e-16  0              2.995215     
Loop time of 63.95 on 4 procs for 3000000 steps with 51 atoms

Performance: 40531640.406 ns/day, 0.000 hours/ns, 46911.621 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30599    | 1.5118     | 4.9162     | 159.9 |  2.36
Neigh   | 0.087826   | 0.088419   | 0.089983   |   0.3 |  0.14
Comm    | 25.701     | 32.466     | 38.209     |  85.4 | 50.77
Output  | 0.061447   | 0.061528   | 0.061592   |   0.0 |  0.10
Modify  | 15.144     | 21.061     | 28.485     | 122.9 | 32.93
Other   |            | 8.762      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 31

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.82                                                               
Lattice spacing in x,y,z = 5.82 5.82 5.82

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87.3 ${n1e1} -100 100 -100 100 units box
region box block -87.3 87.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.3 87.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87.3 -100 -100) to (87.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-87.3 -100 -100) to (87.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87.3 -100 -100) to (87.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_31_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 113 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.92 | 18.39 | 19.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   174.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   174.6          200            200            0.0024434874  -1.693507e-37   0              0.0073304621   12276.065      0              6.5863028e+10  2.6109412e-16  0              3.3268235    
    200000   174.6          200            200            0.00086295367 -2.2452542e-37  0              0.002588861    2976.7796      0              1.5970892e+10  2.6109412e-16  0              3.0751758    
    300000   174.6          200            200            5.9454963e-05  9.1548336e-37  0              0.00017836489  29.149913      0              1.5639389e+08  2.6109412e-16  0              3.0457214    
    400000   174.6          200            200            0.0021920839   1.3259169e-36  0              0.0065762518   207.14943      0              1.1113894e+09  2.6109412e-16  0              2.9963224    
    500000   174.6          200            200            0.00081712004  3.9413522e-36  0              0.0024513601   7.6762878      0              41184496       2.6109412e-16  0              2.99804      
    600000   174.6          200            200            0.0024401076   1.3928401e-37  0              0.0073203227   2.8022562      0              15034547       2.6109412e-16  0              2.9958137    
    700000   174.6          200            200            0.0027342661  -5.765159e-36   0              0.0082027982   0.27008059     0              1449025        2.6109412e-16  0              2.9954984    
    800000   174.6          200            200            0.0029196313   2.6318864e-37  0              0.0087588938   0.047933386    0              257170.18      2.6109412e-16  0              2.9953007    
    900000   174.6          200            200            0.0029779674   2.7497169e-37  0              0.0089339023   0.0077520393   0              41590.915      2.6109412e-16  0              2.9952397    
   1000000   174.6          200            200            0.0029956465   3.3237388e-38  0              0.0089869396   0.0011858988   0              6362.5346      2.6109412e-16  0              2.9952215    
   1100000   174.6          200            200            0.0030006519   3.292588e-38   0              0.0090019558   0.00017333624  0              929.97628      2.6109412e-16  0              2.9952164    
   1200000   174.6          200            200            0.0030019085   4.0108118e-39  0              0.0090057255   2.4308686e-05  0              130.41994      2.6109412e-16  0              2.9952151    
   1300000   174.6          200            200            0.003002147    7.8151444e-41  0              0.0090064409   3.2763547e-06  0              17.57816       2.6109412e-16  0              2.9952149    
   1400000   174.6          200            200            0.0030021507  -2.1603178e-39  0              0.0090064522   4.2435869e-07  0              2.2767514      2.6109412e-16  0              2.9952149    
   1500000   174.6          200            200            0.0030021212   1.0719066e-39  0              0.0090063636   5.2724477e-08  0              0.28287514     2.6109412e-16  0              2.995215     
   1600000   174.6          200            200            0.0030020992  -5.1125413e-40  0              0.0090062975   6.2603743e-09  0              0.033587897    2.6109412e-16  0              2.995215     
   1700000   174.6          200            200            0.0030020871   5.0470779e-39  0              0.0090062614   7.0584694e-10  0              0.0037869803   2.6109412e-16  0              2.995215     
   1800000   174.6          200            200            0.0030020813   5.388007e-39   0              0.009006244    7.4777022e-11  0              0.00040119053  2.6109412e-16  0              2.995215     
   1900000   174.6          200            200            0.0030020788   5.2270135e-40  0              0.0090062363   7.3135934e-12  0              3.9238584e-05  2.6109412e-16  0              2.995215     
   2000000   174.6          200            200            0.0030020776  -1.599726e-39   0              0.0090062329   6.3985306e-13  0              3.4329127e-06  2.6109412e-16  0              2.995215     
   2100000   174.6          200            200            0.0030020772  -8.9154156e-41  0              0.0090062316   4.6993533e-14  0              2.5212773e-07  2.6109412e-16  0              2.995215     
   2200000   174.6          200            200            0.003002077   -1.1146288e-39  0              0.009006231    2.4691398e-15  0              1.3247325e-08  2.6109412e-16  0              2.995215     
   2300000   174.6          200            200            0.0030020769   1.5092249e-39  0              0.0090062308   4.6703163e-17  0              2.5056984e-10  2.6109412e-16  0              2.995215     
   2400000   174.6          200            200            0.0030020769  -7.2101778e-39  0              0.0090062308   3.4702728e-18  0              1.8618561e-11  2.6109412e-16  0              2.995215     
   2500000   174.6          200            200            0.0030020769   1.8572447e-39  0              0.0090062307   4.9532817e-18  0              2.6575139e-11  2.6109412e-16  0              2.995215     
   2600000   174.6          200            200            0.0030020769  -3.9286621e-39  0              0.0090062307   1.9617217e-18  0              1.0524947e-11  2.6109412e-16  0              2.995215     
   2700000   174.6          200            200            0.0030020769   1.9163038e-39  0              0.0090062307   3.7429322e-19  0              2.0081422e-12  2.6109412e-16  0              2.995215     
   2800000   174.6          200            200            0.0030020769   6.167258e-39   0              0.0090062307   1.0022116e-19  0              5.3770236e-13  2.6109412e-16  0              2.995215     
   2900000   174.6          200            200            0.0030020769  -3.5173763e-39  0              0.0090062307   2.0604001e-20  0              1.1054372e-13  2.6109412e-16  0              2.995215     
   3000000   174.6          200            200            0.0030020769  -2.4156806e-39  0              0.0090062307   1.5019037e-20  0              8.0579503e-14  2.6109412e-16  0              2.995215     
Loop time of 62.8751 on 4 procs for 3000000 steps with 50 atoms

Performance: 41224583.209 ns/day, 0.000 hours/ns, 47713.638 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29575    | 1.4795     | 4.7999     | 157.7 |  2.35
Neigh   | 0.087742   | 0.088331   | 0.089881   |   0.3 |  0.14
Comm    | 25.202     | 31.676     | 37.284     |  83.2 | 50.38
Output  | 0.060253   | 0.060334   | 0.060399   |   0.0 |  0.10
Modify  | 14.999     | 20.823     | 27.925     | 119.5 | 33.12
Other   |            | 8.747      |            |       | 13.91

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.58
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 32

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.83                                                               
Lattice spacing in x,y,z = 5.83 5.83 5.83

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87.45 ${n1e1} -100 100 -100 100 units box
region box block -87.45 87.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.45 87.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87.45 -100 -100) to (87.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-87.45 -100 -100) to (87.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87.45 -100 -100) to (87.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_32_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 113 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.92 | 18.39 | 19.55 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   174.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   174.9          200            200            0.002441009    3.5248741e-39  0              0.0073230271   12288.726      0              5.9337858e+10  2.6109412e-16  0              3.3264358    
    200000   174.9          200            200            0.00086656162  1.7666868e-40  0              0.0025996849   3004.3743      0              1.4507048e+10  2.6109412e-16  0              3.0740438    
    300000   174.9          200            200            6.4652302e-05  8.3243647e-39  0              0.00019395691  34.307508      0              1.6565868e+08  2.6109412e-16  0              3.0457895    
    400000   174.9          200            200            0.004376674   -0.00011323272  0              0.013243255    210.20062      0              1.0149836e+09  2.6109412e-16  0              2.9943669    
    500000   174.9          200            200            0.0062346903  -0.00038634292  0              0.019090414    12.549447      0              60596789       2.6109412e-16  0              2.9933467    
    600000   174.9          200            200            0.0019759071   1.9750416e-36  0              0.0059277213   0.0018748154   0              9052.8128      2.6109412e-16  0              2.9963756    
    700000   174.9          200            200            0.0028110895   1.59758e-37    0              0.0084332684   0.42140915     0              2034834        2.6109412e-16  0              2.9954225    
    800000   174.9          200            200            0.0029064065   4.8119075e-37  0              0.0087192195   0.043148381    0              208348.09      2.6109412e-16  0              2.9953097    
    900000   174.9          200            200            0.002952581   -3.6605796e-37  0              0.008857743    0.0022979493   0              11095.975      2.6109412e-16  0              2.9952629    
   1000000   174.9          200            200            0.0029799589   2.4182666e-37  0              0.0089398766   0.000231199    0              1116.3772      2.6109412e-16  0              2.9952333    
   1100000   174.9          200            200            0.0029903314  -7.0887016e-38  0              0.0089709941   1.4778089e-05  0              71.358102      2.6109412e-16  0              2.9952221    
   1200000   174.9          200            200            0.0029944189   1.9222017e-38  0              0.0089832566   5.5107129e-07  0              2.6609261      2.6109412e-16  0              2.9952177    
   1300000   174.9          200            200            0.0029959927  -1.047427e-38   0              0.008987978    4.2066465e-10  0              0.002031239    2.6109412e-16  0              2.995216     
   1400000   174.9          200            200            0.002996586   -2.8760725e-40  0              0.0089897579   7.3140463e-09  0              0.035316912    2.6109412e-16  0              2.9952154    
   1500000   174.9          200            200            0.0029968052   4.9660072e-39  0              0.0089904157   4.2352607e-09  0              0.020450558    2.6109412e-16  0              2.9952151    
   1600000   174.9          200            200            0.0029968847   6.3419294e-40  0              0.008990654    1.2842631e-09  0              0.0062012469   2.6109412e-16  0              2.9952151    
   1700000   174.9          200            200            0.0029969129   5.2284859e-39  0              0.0089907386   2.9929653e-10  0              0.0014451958   2.6109412e-16  0              2.995215     
   1800000   174.9          200            200            0.0029969226   1.1005901e-39  0              0.0089907679   6.0119134e-11  0              0.00029029378  2.6109412e-16  0              2.995215     
   1900000   174.9          200            200            0.002996926   -6.459602e-39   0              0.0089907779   1.0938522e-11  0              5.2818207e-05  2.6109412e-16  0              2.995215     
   2000000   174.9          200            200            0.0029969271  -7.1221574e-40  0              0.0089907812   1.8500927e-12  0              8.9334356e-06  2.6109412e-16  0              2.995215     
   2100000   174.9          200            200            0.0029969274  -1.031576e-39   0              0.0089907822   2.9514837e-13  0              1.4251658e-06  2.6109412e-16  0              2.995215     
   2200000   174.9          200            200            0.0029969275   5.8031948e-39  0              0.0089907825   4.4805281e-14  0              2.1634867e-07  2.6109412e-16  0              2.995215     
   2300000   174.9          200            200            0.0029969275   8.3477149e-39  0              0.0089907826   6.5154252e-15  0              3.1460656e-08  2.6109412e-16  0              2.995215     
   2400000   174.9          200            200            0.0029969275  -9.2463049e-39  0              0.0089907826   9.0938184e-16  0              4.3910795e-09  2.6109412e-16  0              2.995215     
   2500000   174.9          200            200            0.0029969275   1.4812348e-39  0              0.0089907826   1.2179969e-16  0              5.8812711e-10  2.6109412e-16  0              2.995215     
   2600000   174.9          200            200            0.0029969275   2.6601422e-39  0              0.0089907826   1.5479272e-17  0              7.4743862e-11  2.6109412e-16  0              2.995215     
   2700000   174.9          200            200            0.0029969275  -1.2944967e-39  0              0.0089907826   1.9324687e-18  0              9.3311996e-12  2.6109412e-16  0              2.995215     
   2800000   174.9          200            200            0.0029969275   7.2471135e-39  0              0.0089907826   1.7354389e-19  0              8.3798135e-13  2.6109412e-16  0              2.995215     
   2900000   174.9          200            200            0.0029969275  -1.6545561e-39  0              0.0089907826   6.466993e-20   0              3.1226795e-13  2.6109412e-16  0              2.995215     
   3000000   174.9          200            200            0.0029969275  -5.9633464e-39  0              0.0089907826   9.5663012e-20  0              4.6192245e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1406 on 4 procs for 3000000 steps with 51 atoms

Performance: 40411192.210 ns/day, 0.000 hours/ns, 46772.213 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29565    | 1.545      | 4.9998     | 160.6 |  2.41
Neigh   | 0.087937   | 0.088606   | 0.089822   |   0.2 |  0.14
Comm    | 25.646     | 32.605     | 38.374     |  86.8 | 50.83
Output  | 0.062523   | 0.062605   | 0.062664   |   0.0 |  0.10
Modify  | 15.189     | 21.158     | 28.72      | 124.3 | 32.99
Other   |            | 8.681      |            |       | 13.53

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 33

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.84                                                               
Lattice spacing in x,y,z = 5.84 5.84 5.84

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87.6 ${n1e1} -100 100 -100 100 units box
region box block -87.6 87.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.6 87.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87.6 -100 -100) to (87.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-87.6 -100 -100) to (87.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87.6 -100 -100) to (87.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_33_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 114 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.94 | 18.41 | 19.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   175.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   175.2          200            200            0.0024388776   2.1114282e-38  0              0.0073166327   12304.228      0              5.9412715e+10  2.6109412e-16  0              3.3258434    
    200000   175.2          200            200            0.00087031183 -9.8426554e-38  0              0.0026109355   3032.8799      0              1.4644692e+10  2.6109412e-16  0              3.072884     
    300000   175.2          200            200            7.0632369e-05  2.3482984e-37  0              0.00021189711  40.712848      0              1.9658777e+08  2.6109412e-16  0              3.0458005    
    400000   175.2          200            200            0.0085052476  -0.00075842084  0              0.026274164    168.96451      0              8.1586913e+08  2.6109412e-16  0              2.9927109    
    500000   175.2          200            200            0.0024659274  -1.8187407e-08  0              0.0073978003   33.140442      0              1.6002333e+08  2.6109412e-16  0              2.9957304    
    600000   175.2          200            200            0.0024500395   1.37936e-37    0              0.0073501184   3.7164311      0              17945316       2.6109412e-16  0              2.9958353    
    700000   175.2          200            200            0.0033399636  -6.9370554e-05  0              0.010089261    0.34641119     0              1672695.6      2.6109412e-16  0              2.9951175    
    800000   175.2          200            200            0.0028624132  -2.6372331e-05  0              0.008613612    0.049068955    0              236936.42      2.6109412e-16  0              2.9954427    
    900000   175.2          200            200            0.0029114898  -3.8173501e-05  0              0.0087726429   0.00014037764  0              677.83337      2.6109412e-16  0              2.9954028    
   1000000   175.2          200            200            0.0029655017  -3.9375948e-05  0              0.0089358811   0.0011293406   0              5453.1817      2.6109412e-16  0              2.9953644    
   1100000   175.2          200            200            0.0029819146  -3.9688462e-05  0              0.0089854322   0.00018362295  0              886.64951      2.6109412e-16  0              2.9953531    
   1200000   175.2          200            200            0.0029819625  -3.9686966e-05  0              0.0089855745   2.5506302e-06  0              12.31608       2.6109412e-16  0              2.9953532    
   1300000   175.2          200            200            0.0029797646  -3.9645165e-05  0              0.008978939    1.2264951e-06  0              5.9223059      2.6109412e-16  0              2.9953547    
   1400000   175.2          200            200            0.0029787612  -3.9626287e-05  0              0.0089759098   5.1734031e-07  0              2.4980512      2.6109412e-16  0              2.9953554    
   1500000   175.2          200            200            0.0029786025  -3.9623392e-05  0              0.0089754309   3.1341627e-08  0              0.1513375      2.6109412e-16  0              2.9953555    
   1600000   175.2          200            200            0.0029786661  -3.9624637e-05  0              0.008975623    2.8465518e-10  0              0.001374498    2.6109412e-16  0              2.9953555    
   1700000   175.2          200            200            0.0029787165  -3.9625594e-05  0              0.0089757751   1.0001199e-09  0              0.0048292213   2.6109412e-16  0              2.9953555    
   1800000   175.2          200            200            0.0029787308  -3.962586e-05   0              0.0089758183   1.4615347e-10  0              0.00070572281  2.6109412e-16  0              2.9953554    
   1900000   175.2          200            200            0.0029787305  -3.9625852e-05  0              0.0089758173   1.4756053e-12  0              7.1251698e-06  2.6109412e-16  0              2.9953554    
   2000000   175.2          200            200            0.0029787284  -3.9625812e-05  0              0.008975811    1.1747456e-12  0              5.672426e-06   2.6109412e-16  0              2.9953554    
   2100000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   4.3161083e-13  0              2.0840942e-06  2.6109412e-16  0              2.9953554    
   2200000   175.2          200            200            0.0029787274  -3.9625793e-05  0              0.0089758079   2.3047205e-14  0              1.112867e-07   2.6109412e-16  0              2.9953554    
   2300000   175.2          200            200            0.0029787274  -3.9625794e-05  0              0.0089758081   3.9386333e-16  0              1.9018251e-09  2.6109412e-16  0              2.9953554    
   2400000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   8.7129424e-16  0              4.2071681e-09  2.6109412e-16  0              2.9953554    
   2500000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   1.1667649e-16  0              5.63389e-10    2.6109412e-16  0              2.9953554    
   2600000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   1.1847754e-18  0              5.7208564e-12  2.6109412e-16  0              2.9953554    
   2700000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   1.6611136e-18  0              8.0209229e-12  2.6109412e-16  0              2.9953554    
   2800000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   2.3790242e-19  0              1.1487457e-12  2.6109412e-16  0              2.9953554    
   2900000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   1.3458489e-19  0              6.4986226e-13  2.6109412e-16  0              2.9953554    
   3000000   175.2          200            200            0.0029787275  -3.9625795e-05  0              0.0089758083   1.8474654e-20  0              8.9207491e-14  2.6109412e-16  0              2.9953554    
Loop time of 64.1781 on 4 procs for 3000000 steps with 51 atoms

Performance: 40387617.814 ns/day, 0.000 hours/ns, 46744.928 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29625    | 1.6304     | 5.3643     | 168.9 |  2.54
Neigh   | 0.088567   | 0.089077   | 0.090524   |   0.3 |  0.14
Comm    | 25.686     | 32.504     | 38.349     |  85.7 | 50.65
Output  | 0.060435   | 0.060517   | 0.060581   |   0.0 |  0.09
Modify  | 15.221     | 21.216     | 28.761     | 123.8 | 33.06
Other   |            | 8.679      |            |       | 13.52

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 34

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.85                                                               
Lattice spacing in x,y,z = 5.85 5.85 5.85

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87.75 ${n1e1} -100 100 -100 100 units box
region box block -87.75 87.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.75 87.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87.75 -100 -100) to (87.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-87.75 -100 -100) to (87.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87.75 -100 -100) to (87.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_34_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 114 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.94 | 18.41 | 19.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   175.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   175.5          200            200            0.0024369748  -2.1067012e-38  0              0.0073109244   12321.536      0              5.9496286e+10  2.6109412e-16  0              3.3251408    
    200000   175.5          200            200            0.00087388489 -1.3994006e-38  0              0.0026216547   3060.5252      0              1.4778181e+10  2.6109412e-16  0              3.0717994    
    300000   175.5          200            200            7.7811886e-05 -4.4141773e-37  0              0.00023343566  49.047837      0              2.3683445e+08  2.6109412e-16  0              3.0457249    
    400000   175.5          200            200            0.012513854   -0.0013717058   0              0.038913269    92.859689      0              4.483862e+08   2.6109412e-16  0              2.9915259    
    500000   175.5          200            200            0.00037435514 -2.1466645e-36  0              0.0011230654   0.15308955     0              739214.64      2.6109412e-16  0              2.9987939    
    600000   175.5          200            200            0.0037212905  -0.000159454    0              0.011323326    3.8437496      0              18560091       2.6109412e-16  0              2.995122     
    700000   175.5          200            200            0.0024663434  -4.0590664e-05  0              0.007439621    0.060222752    0              290794.12      2.6109412e-16  0              2.9959026    
    800000   175.5          200            200            0.0028340015  -9.0486821e-05  0              0.0085924912   0.056088184    0              270829.77      2.6109412e-16  0              2.9956406    
    900000   175.5          200            200            0.0029381445  -9.0725319e-05  0              0.0089051587   0.011328005    0              54698.883      2.6109412e-16  0              2.9955755    
   1000000   175.5          200            200            0.0029600524  -9.1186553e-05  0              0.0089713439   0.0016015085   0              7733.1113      2.6109412e-16  0              2.9955622    
   1100000   175.5          200            200            0.0029614422  -9.1209947e-05  0              0.0089755366   0.00016848451  0              813.55141      2.6109412e-16  0              2.9955615    
   1200000   175.5          200            200            0.0029594725  -9.1165827e-05  0              0.0089695834   1.2099675e-05  0              58.425001      2.6109412e-16  0              2.9955628    
   1300000   175.5          200            200            0.0029579404  -9.1132424e-05  0              0.0089649535   3.936877e-07   0              1.900977       2.6109412e-16  0              2.9955638    
   1400000   175.5          200            200            0.0029571576  -9.1115499e-05  0              0.0089625883   1.6542553e-09  0              0.0079878066   2.6109412e-16  0              2.9955642    
   1500000   175.5          200            200            0.0029568286  -9.1108425e-05  0              0.0089615942   1.2716619e-08  0              0.061404004    2.6109412e-16  0              2.9955645    
   1600000   175.5          200            200            0.002956709   -9.1105869e-05  0              0.008961233    5.151083e-09   0              0.024872736    2.6109412e-16  0              2.9955645    
   1700000   175.5          200            200            0.0029566716  -9.1105075e-05  0              0.00896112     1.1507249e-09  0              0.0055564387   2.6109412e-16  0              2.9955646    
   1800000   175.5          200            200            0.0029566622  -9.1104877e-05  0              0.0089610915   1.8315953e-10  0              0.00088441183  2.6109412e-16  0              2.9955646    
   1900000   175.5          200            200            0.0029566608  -9.1104849e-05  0              0.0089610872   2.1936485e-11  0              0.00010592344  2.6109412e-16  0              2.9955646    
   2000000   175.5          200            200            0.0029566611  -9.1104856e-05  0              0.0089610881   1.8994587e-12  0              9.1718063e-06  2.6109412e-16  0              2.9955646    
   2100000   175.5          200            200            0.0029566615  -9.1104865e-05  0              0.0089610893   9.6478878e-14  0              4.6586197e-07  2.6109412e-16  0              2.9955646    
   2200000   175.5          200            200            0.0029566617  -9.110487e-05   0              0.0089610901   6.9466429e-16  0              3.3542853e-09  2.6109412e-16  0              2.9955646    
   2300000   175.5          200            200            0.0029566618  -9.1104873e-05  0              0.0089610904   5.7995983e-16  0              2.8004184e-09  2.6109412e-16  0              2.9955646    
   2400000   175.5          200            200            0.0029566619  -9.1104874e-05  0              0.0089610905   4.0421922e-16  0              1.95183e-09    2.6109412e-16  0              2.9955646    
   2500000   175.5          200            200            0.0029566619  -9.1104874e-05  0              0.0089610905   1.1005467e-16  0              5.3141462e-10  2.6109412e-16  0              2.9955646    
   2600000   175.5          200            200            0.0029566619  -9.1104874e-05  0              0.0089610906   1.9488673e-17  0              9.4103827e-11  2.6109412e-16  0              2.9955646    
   2700000   175.5          200            200            0.0029566619  -9.1104874e-05  0              0.0089610906   2.2526507e-18  0              1.0877244e-11  2.6109412e-16  0              2.9955646    
   2800000   175.5          200            200            0.0029566619  -9.1104874e-05  0              0.0089610906   4.2138198e-20  0              2.0347028e-13  2.6109412e-16  0              2.9955646    
   2900000   175.5          200            200            0.0029566619  -9.1104874e-05  0              0.0089610906   3.2907464e-20  0              1.5889837e-13  2.6109412e-16  0              2.9955646    
   3000000   175.5          200            200            0.0029566619  -9.1104873e-05  0              0.0089610906   2.5939587e-20  0              1.2525298e-13  2.6109412e-16  0              2.9955646    
Loop time of 64.1712 on 4 procs for 3000000 steps with 51 atoms

Performance: 40391965.505 ns/day, 0.000 hours/ns, 46749.960 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28239    | 1.6276     | 5.395      | 170.6 |  2.54
Neigh   | 0.088616   | 0.089144   | 0.090627   |   0.3 |  0.14
Comm    | 25.669     | 32.561     | 38.436     |  86.1 | 50.74
Output  | 0.063907   | 0.063985   | 0.064048   |   0.0 |  0.10
Modify  | 15.138     | 21.115     | 28.735     | 124.6 | 32.90
Other   |            | 8.714      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 35

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.86                                                               
Lattice spacing in x,y,z = 5.86 5.86 5.86

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -87.9 ${n1e1} -100 100 -100 100 units box
region box block -87.9 87.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -87.9 87.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-87.9 -100 -100) to (87.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-87.9 -100 -100) to (87.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-87.9 -100 -100) to (87.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_35_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 114 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.94 | 18.41 | 19.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   175.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   175.8          200            200            0.0024351557  -1.3980991e-38  0              0.007305467    12339.392      0              5.9582507e+10  2.6109412e-16  0              3.3244331    
    200000   175.8          200            200            0.00087746043 -1.4015288e-38  0              0.0026323813   3088.3064      0              1.4912326e+10  2.6109412e-16  0              3.0707286    
    300000   175.8          200            200            8.7013268e-05  3.4022353e-37  0              0.0002610398   60.720618      0              2.9319813e+08  2.6109412e-16  0              3.0455015    
    400000   175.8          200            200            0.015315628   -0.0017333465   0              0.04768023     22.859707      0              1.1038134e+08  2.6109412e-16  0              2.9908879    
    500000   175.8          200            200            0.0014050384  -5.207912e-36   0              0.0042151151   27.672731      0              1.3362171e+08  2.6109412e-16  0              2.997182     
    600000   175.8          200            200            0.0038885107  -0.00021712064  0              0.011882653    3.4685914      0              16748586       2.6109412e-16  0              2.9952666    
    700000   175.8          200            200            0.0028713188  -0.00016290666  0              0.0087768631   0.68826305     0              3323375.9      2.6109412e-16  0              2.9958171    
    800000   175.8          200            200            0.0030261709  -0.00013874447  0              0.0092172572   0.076011734    0              367033.46      2.6109412e-16  0              2.9957381    
    900000   175.8          200            200            0.0028731126  -0.00013552035  0              0.0087548582   0.0040601743   0              19605.129      2.6109412e-16  0              2.9958262    
   1000000   175.8          200            200            0.0029648587  -0.00013756529  0              0.0090321414   1.025355e-05   0              49.510725      2.6109412e-16  0              2.9957723    
   1100000   175.8          200            200            0.0029271753  -0.0001367496   0              0.0089182756   4.4314566e-05  0              213.97918      2.6109412e-16  0              2.9957945    
   1200000   175.8          200            200            0.0029385825  -0.00013700353  0              0.008952751    2.1632604e-05  0              104.4561       2.6109412e-16  0              2.9957877    
   1300000   175.8          200            200            0.0029364507  -0.00013695531  0              0.0089463075   4.1726447e-06  0              20.148208      2.6109412e-16  0              2.995789     
   1400000   175.8          200            200            0.0029362562  -0.00013695168  0              0.0089457202   4.4065536e-07  0              2.127767       2.6109412e-16  0              2.9957891    
   1500000   175.8          200            200            0.0029366679  -0.00013696052  0              0.0089469642   2.0683264e-08  0              0.099872077    2.6109412e-16  0              2.9957888    
   1600000   175.8          200            200            0.0029364336  -0.00013695542  0              0.0089462562   1.4712612e-12  0              7.1041937e-06  2.6109412e-16  0              2.995789     
   1700000   175.8          200            200            0.0029365262  -0.00013695745  0              0.0089465361   3.4942796e-10  0              0.0016872626   2.6109412e-16  0              2.9957889    
   1800000   175.8          200            200            0.0029364993  -0.00013695685  0              0.0089464547   1.4394079e-10  0              0.00069503858  2.6109412e-16  0              2.9957889    
   1900000   175.8          200            200            0.0029365038  -0.00013695696  0              0.0089464684   2.5659099e-11  0              0.0001238986   2.6109412e-16  0              2.9957889    
   2000000   175.8          200            200            0.0029365046  -0.00013695697  0              0.0089464707   2.5065327e-12  0              1.2103149e-05  2.6109412e-16  0              2.9957889    
   2100000   175.8          200            200            0.0029365035  -0.00013695695  0              0.0089464674   1.0032449e-13  0              4.8443105e-07  2.6109412e-16  0              2.9957889    
   2200000   175.8          200            200            0.0029365041  -0.00013695696  0              0.0089464692   1.888829e-16   0              9.1204791e-10  2.6109412e-16  0              2.9957889    
   2300000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464685   2.6613569e-15  0              1.285074e-08   2.6109412e-16  0              2.9957889    
   2400000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   9.4585915e-16  0              4.5672153e-09  2.6109412e-16  0              2.9957889    
   2500000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   1.5702753e-16  0              7.5822972e-10  2.6109412e-16  0              2.9957889    
   2600000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   1.3712049e-17  0              6.6210578e-11  2.6109412e-16  0              2.9957889    
   2700000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   1.2188307e-18  0              5.8852971e-12  2.6109412e-16  0              2.9957889    
   2800000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   1.5630018e-19  0              7.5471762e-13  2.6109412e-16  0              2.9957889    
   2900000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   6.2413161e-21  0              3.0137082e-14  2.6109412e-16  0              2.9957889    
   3000000   175.8          200            200            0.0029365039  -0.00013695696  0              0.0089464687   5.9717509e-20  0              2.8835448e-13  2.6109412e-16  0              2.9957889    
Loop time of 64.0161 on 4 procs for 3000000 steps with 51 atoms

Performance: 40489783.881 ns/day, 0.000 hours/ns, 46863.176 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30573    | 1.5968     | 5.2619     | 167.5 |  2.49
Neigh   | 0.08961    | 0.090184   | 0.091648   |   0.3 |  0.14
Comm    | 25.688     | 32.358     | 38.23      |  84.6 | 50.55
Output  | 0.06275    | 0.062832   | 0.062898   |   0.0 |  0.10
Modify  | 15.17      | 21.107     | 28.528     | 123.1 | 32.97
Other   |            | 8.801      |            |       | 13.75

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 36

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.87                                                               
Lattice spacing in x,y,z = 5.87 5.87 5.87

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.05 ${n1e1} -100 100 -100 100 units box
region box block -88.05 88.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.05 88.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.05 -100 -100) to (88.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.05 -100 -100) to (88.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.05 -100 -100) to (88.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_36_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 114 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.94 | 18.41 | 19.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   176.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   176.1          200            200            0.0024333214  -3.4986165e-38  0              0.0072999642   12356.95       0              5.9667291e+10  2.6109412e-16  0              3.3237859    
    200000   176.1          200            200            0.00088104051  2.957881e-42   0              0.0026431215   3116.2363      0              1.504719e+10   2.6109412e-16  0              3.0696698    
    300000   176.1          200            200            9.7134927e-05 -6.6415206e-37  0              0.00029140478  74.836589      0              3.6135911e+08  2.6109412e-16  0              3.0451823    
    400000   176.1          200            200            0.016144215   -0.0017661147   0              0.05019876     1.4049371      0              6783938.3      2.6109412e-16  0              2.9908928    
    500000   176.1          200            200            0.0068152466  -0.00058285895  0              0.021028599    12.947435      0              62518532       2.6109412e-16  0              2.9941686    
    600000   176.1          200            200            0.0023032851  -7.4123856e-05  0              0.006983979    4.3925881      0              21210236       2.6109412e-16  0              2.9964191    
    700000   176.1          200            200            0.0024250682  -0.00013504207  0              0.0074102466   0.15591795     0              752871.97      2.6109412e-16  0              2.9963177    
    800000   176.1          200            200            0.0027341203  -0.00016974025  0              0.0083721011   0.02323105     0              112174.43      2.6109412e-16  0              2.9961235    
    900000   176.1          200            200            0.0028555371  -0.00017277885  0              0.0087393903   0.0044596715   0              21534.158      2.6109412e-16  0              2.9960524    
   1000000   176.1          200            200            0.0028980488  -0.00017375074  0              0.0088678973   0.00081188146  0              3920.285       2.6109412e-16  0              2.9960278    
   1100000   176.1          200            200            0.0029124043  -0.00017406944  0              0.0089112824   0.00013868437  0              669.65719      2.6109412e-16  0              2.9960196    
   1200000   176.1          200            200            0.0029171131  -0.00017417322  0              0.0089255126   2.2486672e-05  0              108.58009      2.6109412e-16  0              2.9960168    
   1300000   176.1          200            200            0.0029186072  -0.00017420618  0              0.0089300278   3.4916527e-06  0              16.859941      2.6109412e-16  0              2.996016     
   1400000   176.1          200            200            0.0029190608  -0.00017421624  0              0.0089313987   5.22209e-07    0              2.5215604      2.6109412e-16  0              2.9960157    
   1500000   176.1          200            200            0.0029191899  -0.00017421913  0              0.0089317887   7.5501446e-08  0              0.36456946     2.6109412e-16  0              2.9960156    
   1600000   176.1          200            200            0.0029192227  -0.00017421987  0              0.0089318879   1.0576051e-08  0              0.051067966    2.6109412e-16  0              2.9960156    
   1700000   176.1          200            200            0.0029192292  -0.00017422003  0              0.0089319076   1.4368892e-09  0              0.0069382237   2.6109412e-16  0              2.9960156    
   1800000   176.1          200            200            0.0029192295  -0.00017422004  0              0.0089319086   1.8936822e-10  0              0.00091439136  2.6109412e-16  0              2.9960156    
   1900000   176.1          200            200            0.0029192289  -0.00017422003  0              0.0089319066   2.4188764e-11  0              0.00011679889  2.6109412e-16  0              2.9960156    
   2000000   176.1          200            200            0.0029192283  -0.00017422002  0              0.0089319051   2.9893616e-12  0              1.4434557e-05  2.6109412e-16  0              2.9960156    
   2100000   176.1          200            200            0.0029192281  -0.00017422001  0              0.0089319042   3.5622292e-13  0              1.720073e-06   2.6109412e-16  0              2.9960156    
   2200000   176.1          200            200            0.0029192279  -0.00017422001  0              0.0089319038   4.0723567e-14  0              1.9663953e-07  2.6109412e-16  0              2.9960156    
   2300000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319036   4.4293016e-15  0              2.1387512e-08  2.6109412e-16  0              2.9960156    
   2400000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319035   4.5860453e-16  0              2.2144372e-09  2.6109412e-16  0              2.9960156    
   2500000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319034   4.519963e-17   0              2.1825284e-10  2.6109412e-16  0              2.9960156    
   2600000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319034   3.6752741e-18  0              1.7746583e-11  2.6109412e-16  0              2.9960156    
   2700000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319034   9.4272924e-19  0              4.5521021e-12  2.6109412e-16  0              2.9960156    
   2800000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319034   2.7973197e-19  0              1.3507256e-12  2.6109412e-16  0              2.9960156    
   2900000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319034   2.1378299e-21  0              1.0322816e-14  2.6109412e-16  0              2.9960156    
   3000000   176.1          200            200            0.0029192278  -0.00017422001  0              0.0089319034   2.3014933e-21  0              1.1113087e-14  2.6109412e-16  0              2.9960156    
Loop time of 64.191 on 4 procs for 3000000 steps with 51 atoms

Performance: 40379511.315 ns/day, 0.000 hours/ns, 46735.546 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28923    | 1.6562     | 5.4733     | 171.3 |  2.58
Neigh   | 0.089646   | 0.090237   | 0.091791   |   0.3 |  0.14
Comm    | 25.535     | 32.52      | 38.447     |  86.9 | 50.66
Output  | 0.061853   | 0.061934   | 0.061993   |   0.0 |  0.10
Modify  | 15.195     | 21.203     | 28.9       | 125.4 | 33.03
Other   |            | 8.66       |            |       | 13.49

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 37

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.88                                                               
Lattice spacing in x,y,z = 5.88 5.88 5.88

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.2 ${n1e1} -100 100 -100 100 units box
region box block -88.2 88.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.2 88.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.2 -100 -100) to (88.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.2 -100 -100) to (88.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.2 -100 -100) to (88.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_37_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 114 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.94 | 18.41 | 19.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   176.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   176.4          200            200            0.0024314652   1.3192867e-42  0              0.0072943957   12374.17       0              5.975044e+10   2.6109412e-16  0              3.323197     
    200000   176.4          200            200            0.00088501822 -5.2398936e-39  0              0.0026550547   3146.5383      0              1.5193507e+10  2.6109412e-16  0              3.0684944    
    300000   176.4          200            200            0.00010716482  6.1605571e-37  0              0.00032149446  90.124611      0              4.3517949e+08  2.6109412e-16  0              3.0448318    
    400000   176.4          200            200            0.013935168   -0.0016252473   0              0.043430752    63.118145      0              3.0477493e+08  2.6109412e-16  0              2.9918037    
    500000   176.4          200            200            0.006095457   -0.00066296056  0              0.018949331    20.751981      0              1.0020389e+08  2.6109412e-16  0              2.9946584    
    600000   176.4          200            200            0.0019121307  -0.00011001598  0              0.0058464081   3.1526635      0              15223084       2.6109412e-16  0              2.9968424    
    700000   176.4          200            200            0.0023793168  -0.00017390809  0              0.0073118586   0.12250258     0              591521.12      2.6109412e-16  0              2.9965471    
    800000   176.4          200            200            0.003072227   -0.00020391371  0              0.0094205948   0.043564613    0              210357.93      2.6109412e-16  0              2.9961479    
    900000   176.4          200            200            0.0029250295  -0.00020120728  0              0.0089762956   0.01229777     0              59381.53       2.6109412e-16  0              2.9962265    
   1000000   176.4          200            200            0.0028764514  -0.00020017758  0              0.0088295318   9.4574456e-05  0              456.6662       2.6109412e-16  0              2.9962541    
   1100000   176.4          200            200            0.0029128665  -0.00020093382  0              0.0089395333   0.00013543357  0              653.96022      2.6109412e-16  0              2.9962339    
   1200000   176.4          200            200            0.0029069419  -0.00020081624  0              0.0089216421   2.8349835e-05  0              136.89121      2.6109412e-16  0              2.9962371    
   1300000   176.4          200            200            0.00290405    -0.00020075554  0              0.0089129057   6.7520211e-08  0              0.32603094     2.6109412e-16  0              2.9962387    
   1400000   176.4          200            200            0.0029058481  -0.00020079245  0              0.0089183366   3.9806933e-07  0              1.9221343      2.6109412e-16  0              2.9962377    
   1500000   176.4          200            200            0.00290562    -0.00020078796  0              0.0089176481   6.3761698e-08  0              0.30788242     2.6109412e-16  0              2.9962378    
   1600000   176.4          200            200            0.0029054553  -0.00020078451  0              0.0089171503   2.604351e-12   0              1.2575479e-05  2.6109412e-16  0              2.9962379    
   1700000   176.4          200            200            0.0029055429  -0.00020078631  0              0.008917415    1.129829e-09   0              0.0054555398   2.6109412e-16  0              2.9962379    
   1800000   176.4          200            200            0.002905535   -0.00020078616  0              0.0089173912   1.3918706e-10  0              0.00067208448  2.6109412e-16  0              2.9962379    
   1900000   176.4          200            200            0.0029055259  -0.00020078597  0              0.0089173636   2.3442925e-13  0              1.1319749e-06  2.6109412e-16  0              2.9962379    
   2000000   176.4          200            200            0.0029055301  -0.00020078605  0              0.0089173763   3.1089144e-12  0              1.5011835e-05  2.6109412e-16  0              2.9962379    
   2100000   176.4          200            200            0.0029055299  -0.00020078605  0              0.0089173756   2.9365107e-13  0              1.4179359e-06  2.6109412e-16  0              2.9962379    
   2200000   176.4          200            200            0.0029055294  -0.00020078604  0              0.0089173742   2.6960236e-15  0              1.3018133e-08  2.6109412e-16  0              2.9962379    
   2300000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173748   8.3164236e-15  0              4.0157033e-08  2.6109412e-16  0              2.9962379    
   2400000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173747   5.9277456e-16  0              2.8622962e-09  2.6109412e-16  0              2.9962379    
   2500000   176.4          200            200            0.0029055295  -0.00020078604  0              0.0089173747   1.5558036e-17  0              7.5124188e-11  2.6109412e-16  0              2.9962379    
   2600000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173747   2.1588522e-17  0              1.0424325e-10  2.6109412e-16  0              2.9962379    
   2700000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173747   3.7937306e-19  0              1.8318568e-12  2.6109412e-16  0              2.9962379    
   2800000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173747   3.6332028e-19  0              1.7543436e-12  2.6109412e-16  0              2.9962379    
   2900000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173747   1.012039e-19   0              4.886774e-13   2.6109412e-16  0              2.9962379    
   3000000   176.4          200            200            0.0029055296  -0.00020078604  0              0.0089173747   7.5023086e-20  0              3.6225963e-13  2.6109412e-16  0              2.9962379    
Loop time of 64.1101 on 4 procs for 3000000 steps with 51 atoms

Performance: 40430436.728 ns/day, 0.000 hours/ns, 46794.487 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29178    | 1.6112     | 5.3214     | 168.8 |  2.51
Neigh   | 0.089709   | 0.090242   | 0.091763   |   0.3 |  0.14
Comm    | 25.672     | 32.447     | 38.316     |  85.4 | 50.61
Output  | 0.063584   | 0.063666   | 0.063726   |   0.0 |  0.10
Modify  | 15.169     | 21.149     | 28.666     | 123.9 | 32.99
Other   |            | 8.748      |            |       | 13.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 38

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.89                                                               
Lattice spacing in x,y,z = 5.89 5.89 5.89

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.35 ${n1e1} -100 100 -100 100 units box
region box block -88.35 88.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.35 88.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.35 -100 -100) to (88.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.35 -100 -100) to (88.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.35 -100 -100) to (88.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_38_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 114 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.94 | 18.41 | 19.57 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   176.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   176.7          200            200            0.0024299655   1.3079558e-39  0              0.0072898964   12394.303      0              5.9847654e+10  2.6109412e-16  0              3.3224187    
    200000   176.7          200            200            0.0008898882   1.7441572e-39  0              0.0026696646   3182.0481      0              1.5364971e+10  2.6109412e-16  0              3.0670456    
    300000   176.7          200            200            0.00011691898 -4.4445328e-37  0              0.00035075693  106.20777      0              5.1283929e+08  2.6109412e-16  0              3.0444663    
    400000   176.7          200            200            0.007308257   -0.0010950654   0              0.023019836    194.85486      0              9.4088437e+08  2.6109412e-16  0              2.9943207    
    500000   176.7          200            200            0.0012610155  -5.5629738e-05  0              0.0038386762   32.583774      0              1.5733538e+08  2.6109412e-16  0              2.9974812    
    600000   176.7          200            200            0.0040055297  -0.00026996373  0              0.012286553    3.2724099      0              15801296       2.6109412e-16  0              2.9958896    
    700000   176.7          200            200            0.0025994629  -0.00021133689  0              0.0080097256   0.55773342     0              2693095.1      2.6109412e-16  0              2.9966115    
    800000   176.7          200            200            0.0030450728  -0.00022028479  0              0.0093555032   0.056223556    0              271483.43      2.6109412e-16  0              2.9963722    
    900000   176.7          200            200            0.0028238964  -0.00021621358  0              0.0086879029   0.003534451    0              17066.599      2.6109412e-16  0              2.9964902    
   1000000   176.7          200            200            0.0029249006  -0.00021818033  0              0.0089928822   9.2873517e-05  0              448.45298      2.6109412e-16  0              2.9964355    
   1100000   176.7          200            200            0.0028839131  -0.00021739824  0              0.0088691374   1.8377103e-06  0              8.8736453      2.6109412e-16  0              2.9964577    
   1200000   176.7          200            200            0.0028988738  -0.00021768823  0              0.0089143095   5.0708749e-06  0              24.48544       2.6109412e-16  0              2.9964495    
   1300000   176.7          200            200            0.0028939483  -0.00021759265  0              0.0088994374   1.9350359e-06  0              9.3435958      2.6109412e-16  0              2.9964522    
   1400000   176.7          200            200            0.0028953674  -0.00021762044  0              0.0089037225   4.4653514e-07  0              2.1561584      2.6109412e-16  0              2.9964515    
   1500000   176.7          200            200            0.0028950413  -0.00021761396  0              0.0089027379   7.7886639e-08  0              0.37608671     2.6109412e-16  0              2.9964516    
   1600000   176.7          200            200            0.0028950773  -0.00021761474  0              0.0089028467   1.0973654e-08  0              0.05298785     2.6109412e-16  0              2.9964516    
   1700000   176.7          200            200            0.0028950963  -0.00021761507  0              0.0089029039   1.2599979e-09  0              0.006084079    2.6109412e-16  0              2.9964516    
   1800000   176.7          200            200            0.0028950781  -0.00021761473  0              0.0089028491   1.1340971e-10  0              0.0005476149   2.6109412e-16  0              2.9964516    
   1900000   176.7          200            200            0.0028950882  -0.00021761492  0              0.0089028797   6.9930785e-12  0              3.3767073e-05  2.6109412e-16  0              2.9964516    
   2000000   176.7          200            200            0.0028950836  -0.00021761484  0              0.0089028657   1.6679195e-13  0              8.0537865e-07  2.6109412e-16  0              2.9964516    
   2100000   176.7          200            200            0.0028950855  -0.00021761487  0              0.0089028713   5.216023e-15   0              2.5186308e-08  2.6109412e-16  0              2.9964516    
   2200000   176.7          200            200            0.0028950848  -0.00021761486  0              0.0089028693   1.1182453e-14  0              5.3996065e-08  2.6109412e-16  0              2.9964516    
   2300000   176.7          200            200            0.002895085   -0.00021761486  0              0.00890287     4.1228043e-15  0              1.9907546e-08  2.6109412e-16  0              2.9964516    
   2400000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   9.3900675e-16  0              4.5341275e-09  2.6109412e-16  0              2.9964516    
   2500000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   1.6253937e-16  0              7.8484446e-10  2.6109412e-16  0              2.9964516    
   2600000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   2.2517646e-17  0              1.0872966e-10  2.6109412e-16  0              2.9964516    
   2700000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   3.0345186e-18  0              1.4652604e-11  2.6109412e-16  0              2.9964516    
   2800000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   2.6027497e-19  0              1.2567747e-12  2.6109412e-16  0              2.9964516    
   2900000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   8.2582475e-20  0              3.9876122e-13  2.6109412e-16  0              2.9964516    
   3000000   176.7          200            200            0.002895085   -0.00021761486  0              0.0089028698   4.1004739e-20  0              1.9799721e-13  2.6109412e-16  0              2.9964516    
Loop time of 64.3156 on 4 procs for 3000000 steps with 51 atoms

Performance: 40301255.682 ns/day, 0.000 hours/ns, 46644.972 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28547    | 1.6588     | 5.4782     | 171.3 |  2.58
Neigh   | 0.08964    | 0.090223   | 0.091781   |   0.3 |  0.14
Comm    | 25.775     | 32.596     | 38.45      |  85.4 | 50.68
Output  | 0.060997   | 0.061079   | 0.061146   |   0.0 |  0.09
Modify  | 15.257     | 21.226     | 28.768     | 123.8 | 33.00
Other   |            | 8.683      |            |       | 13.50

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 39

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.9                                                               
Lattice spacing in x,y,z = 5.9 5.9 5.9

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.5 ${n1e1} -100 100 -100 100 units box
region box block -88.5 88.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.5 88.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.5 -100 -100) to (88.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.5 -100 -100) to (88.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.5 -100 -100) to (88.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_39_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 115 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.96 | 18.43 | 19.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   177            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   177            200            200            0.0024286313   2.786924e-38   0              0.007285894    12415.658      0              5.9950769e+10  2.6109412e-16  0              3.3216001    
    200000   177            200            200            0.00089489747 -1.3926961e-38  0              0.0026846924   3218.5241      0              1.5541101e+10  2.6109412e-16  0              3.0655833    
    300000   177            200            200            0.00012654245 -2.785329e-38   0              0.00037962736  123.21999      0              5.9498524e+08  2.6109412e-16  0              3.0440762    
    400000   177            200            200            0.00051378092 -1.8112464e-06  0              0.001543154    213.28584      0              1.029881e+09   2.6109412e-16  0              2.9982832    
    500000   177            200            200            0.00010038365 -1.393832e-37   0              0.00030115096  2.9864232      0              14420369       2.6109412e-16  0              2.9994429    
    600000   177            200            200            0.0022751457  -0.00022770602  0              0.0070531432   4.79338        0              23145516       2.6109412e-16  0              2.9969813    
    700000   177            200            200            0.0034557936  -0.00023176504  0              0.010599146    0.15424415     0              744789.8       2.6109412e-16  0              2.9963617    
    800000   177            200            200            0.002730357   -0.00022080728  0              0.0084118784   0.050915008    0              245850.35      2.6109412e-16  0              2.9967406    
    900000   177            200            200            0.0028434308  -0.00022302548  0              0.0087533178   0.0097690148   0              47171.077      2.6109412e-16  0              2.9966773    
   1000000   177            200            200            0.0029176149  -0.00022431964  0              0.0089771643   0.00017159683  0              828.57968      2.6109412e-16  0              2.996638     
   1100000   177            200            200            0.0028890662  -0.00022381878  0              0.0088910174   0.00024653254  0              1190.4174      2.6109412e-16  0              2.9966534    
   1200000   177            200            200            0.0028840608  -0.00022373389  0              0.0088759162   9.5863301e-07  0              4.6288957      2.6109412e-16  0              2.996656     
   1300000   177            200            200            0.0028887952  -0.00022381734  0              0.0088902031   3.8149107e-06  0              18.420839      2.6109412e-16  0              2.9966534    
   1400000   177            200            200            0.0028886444  -0.00022381424  0              0.0088897475   2.2511424e-07  0              1.0869961      2.6109412e-16  0              2.9966535    
   1500000   177            200            200            0.0028880301  -0.0002238035   0              0.0088878937   3.2842825e-08  0              0.15858625     2.6109412e-16  0              2.9966539    
   1600000   177            200            200            0.002888158   -0.0002238058   0              0.0088882799   9.2023067e-09  0              0.044434646    2.6109412e-16  0              2.9966538    
   1700000   177            200            200            0.0028882188  -0.00022380685  0              0.0088884631   5.9730571e-11  0              0.00028841755  2.6109412e-16  0              2.9966538    
   1800000   177            200            200            0.0028881908  -0.00022380636  0              0.0088883788   2.0545682e-10  0              0.00099207744  2.6109412e-16  0              2.9966538    
   1900000   177            200            200            0.0028881875  -0.0002238063   0              0.0088883688   2.1424903e-12  0              1.0345319e-05  2.6109412e-16  0              2.9966538    
   2000000   177            200            200            0.0028881919  -0.00022380638  0              0.0088883819   2.8335771e-12  0              1.368233e-05   2.6109412e-16  0              2.9966538    
   2100000   177            200            200            0.0028881915  -0.00022380637  0              0.008888381    2.4286178e-13  0              1.1726926e-06  2.6109412e-16  0              2.9966538    
   2200000   177            200            200            0.002888191   -0.00022380636  0              0.0088883794   2.0032073e-14  0              9.6727709e-08  2.6109412e-16  0              2.9966538    
   2300000   177            200            200            0.0028881911  -0.00022380637  0              0.0088883798   8.3635849e-15  0              4.0384758e-08  2.6109412e-16  0              2.9966538    
   2400000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883799   1.1419966e-17  0              5.5142929e-11  2.6109412e-16  0              2.9966538    
   2500000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883799   1.6806705e-16  0              8.1153565e-10  2.6109412e-16  0              2.9966538    
   2600000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883798   3.3980673e-18  0              1.6408051e-11  2.6109412e-16  0              2.9966538    
   2700000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883799   1.1835626e-18  0              5.7150004e-12  2.6109412e-16  0              2.9966538    
   2800000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883799   2.2862314e-19  0              1.1039393e-12  2.6109412e-16  0              2.9966538    
   2900000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883799   1.0250671e-19  0              4.9496823e-13  2.6109412e-16  0              2.9966538    
   3000000   177            200            200            0.0028881912  -0.00022380637  0              0.0088883799   2.2090905e-20  0              1.0666907e-13  2.6109412e-16  0              2.9966538    
Loop time of 64.0768 on 4 procs for 3000000 steps with 51 atoms

Performance: 40451485.015 ns/day, 0.000 hours/ns, 46818.848 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31318    | 1.5889     | 5.2433     | 167.4 |  2.48
Neigh   | 0.090482   | 0.091006   | 0.092532   |   0.3 |  0.14
Comm    | 25.714     | 32.44      | 38.319     |  85.1 | 50.63
Output  | 0.05867    | 0.058749   | 0.058813   |   0.0 |  0.09
Modify  | 15.212     | 21.152     | 28.639     | 123.7 | 33.01
Other   |            | 8.746      |            |       | 13.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 40

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.91                                                               
Lattice spacing in x,y,z = 5.91 5.91 5.91

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.65 ${n1e1} -100 100 -100 100 units box
region box block -88.65 88.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.65 88.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.65 -100 -100) to (88.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.65 -100 -100) to (88.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.65 -100 -100) to (88.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_40_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 115 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.96 | 18.43 | 19.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   177.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   177.3          200            200            0.0024273473   5.5644892e-38  0              0.007282042    12437.237      0              6.0054967e+10  2.6109412e-16  0              3.3208203    
    200000   177.3          200            200            0.00090000167  2.0865324e-38  0              0.002700005    3255.7218      0              1.5720716e+10  2.6109412e-16  0              3.064123     
    300000   177.3          200            200            0.00013720386  6.9532775e-38  0              0.00041161158  143.31442      0              6.9201406e+08  2.6109412e-16  0              3.0435561    
    400000   177.3          200            200           -0.00010902545 -5.5437422e-37  0             -0.00032707635  144.34659      0              6.9699803e+08  2.6109412e-16  0              3.001871     
    500000   177.3          200            200            0.00035109038 -8.9813508e-36  0              0.0010532712   16.678077      0              80532467       2.6109412e-16  0              2.9989415    
    600000   177.3          200            200            0.0023121705  -0.0001203063   0              0.0070568177   4.7987485      0              23171439       2.6109412e-16  0              2.9971888    
    700000   177.3          200            200            0.0022981017  -0.0002090024   0              0.0071033074   0.061698951    0              297922.15      2.6109412e-16  0              2.9971651    
    800000   177.3          200            200            0.0028515072  -0.00021992293  0              0.0087744445   0.099335813    0              479657.09      2.6109412e-16  0              2.996858     
    900000   177.3          200            200            0.0029540274  -0.00022145531  0              0.0090835376   0.0044909289   0              21685.088      2.6109412e-16  0              2.996805     
   1000000   177.3          200            200            0.0029124229  -0.00022081669  0              0.0089580854   0.00038873695  0              1877.0716      2.6109412e-16  0              2.9968274    
   1100000   177.3          200            200            0.002884737   -0.00022039056  0              0.0088746015   0.00025075076  0              1210.7857      2.6109412e-16  0              2.9968421    
   1200000   177.3          200            200            0.0028808115  -0.00022033151  0              0.008862766    7.8781294e-06  0              38.040668      2.6109412e-16  0              2.9968441    
   1300000   177.3          200            200            0.0028831945  -0.00022036937  0              0.008869953    1.3746029e-06  0              6.6374653      2.6109412e-16  0              2.9968428    
   1400000   177.3          200            200            0.0028845502  -0.00022039043  0              0.008874041    6.1638603e-07  0              2.9763076      2.6109412e-16  0              2.9968421    
   1500000   177.3          200            200            0.0028846962  -0.00022039259  0              0.0088744813   1.2699437e-08  0              0.061321038    2.6109412e-16  0              2.996842     
   1600000   177.3          200            200            0.0028845633  -0.00022039049  0              0.0088740803   4.5277279e-09  0              0.021862777    2.6109412e-16  0              2.9968421    
   1700000   177.3          200            200            0.0028844975  -0.00022038947  0              0.0088738821   1.4826589e-09  0              0.0071592293   2.6109412e-16  0              2.9968421    
   1800000   177.3          200            200            0.0028844928  -0.0002203894   0              0.0088738679   1.7665603e-11  0              8.5300875e-05  2.6109412e-16  0              2.9968421    
   1900000   177.3          200            200            0.0028845001  -0.00022038951  0              0.0088738898   1.4119816e-11  0              6.817954e-05   2.6109412e-16  0              2.9968421    
   2000000   177.3          200            200            0.0028845032  -0.00022038956  0              0.0088738992   3.4873654e-12  0              1.6839239e-05  2.6109412e-16  0              2.9968421    
   2100000   177.3          200            200            0.0028845033  -0.00022038957  0              0.0088738996   1.8769192e-14  0              9.062971e-08   2.6109412e-16  0              2.9968421    
   2200000   177.3          200            200            0.0028845029  -0.00022038956  0              0.0088738984   4.2131861e-14  0              2.0343968e-07  2.6109412e-16  0              2.9968421    
   2300000   177.3          200            200            0.0028845028  -0.00022038956  0              0.0088738979   8.0138132e-15  0              3.8695836e-08  2.6109412e-16  0              2.9968421    
   2400000   177.3          200            200            0.0028845028  -0.00022038956  0              0.0088738979   1.0412219e-17  0              5.027688e-11   2.6109412e-16  0              2.9968421    
   2500000   177.3          200            200            0.0028845028  -0.00022038956  0              0.008873898    1.2323475e-16  0              5.9505648e-10  2.6109412e-16  0              2.9968421    
   2600000   177.3          200            200            0.0028845028  -0.00022038956  0              0.008873898    1.7411403e-17  0              8.4073433e-11  2.6109412e-16  0              2.9968421    
   2700000   177.3          200            200            0.0028845028  -0.00022038956  0              0.008873898    3.0140015e-19  0              1.4553535e-12  2.6109412e-16  0              2.9968421    
   2800000   177.3          200            200            0.0028845028  -0.00022038956  0              0.008873898    1.2331567e-19  0              5.9544726e-13  2.6109412e-16  0              2.9968421    
   2900000   177.3          200            200            0.0028845028  -0.00022038956  0              0.008873898    5.8884997e-20  0              2.8433458e-13  2.6109412e-16  0              2.9968421    
   3000000   177.3          200            200            0.0028845028  -0.00022038956  0              0.008873898    2.6219546e-20  0              1.266048e-13   2.6109412e-16  0              2.9968421    
Loop time of 64.0948 on 4 procs for 3000000 steps with 51 atoms

Performance: 40440117.660 ns/day, 0.000 hours/ns, 46805.692 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31356    | 1.6371     | 5.3793     | 168.9 |  2.55
Neigh   | 0.091553   | 0.092108   | 0.093614   |   0.3 |  0.14
Comm    | 25.587     | 32.476     | 38.335     |  86.3 | 50.67
Output  | 0.060886   | 0.060969   | 0.061033   |   0.0 |  0.10
Modify  | 15.172     | 21.13      | 28.687     | 124.1 | 32.97
Other   |            | 8.699      |            |       | 13.57

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 41

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.92                                                               
Lattice spacing in x,y,z = 5.92 5.92 5.92

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.8 ${n1e1} -100 100 -100 100 units box
region box block -88.8 88.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.8 88.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.8 -100 -100) to (88.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.8 -100 -100) to (88.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.8 -100 -100) to (88.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_41_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 115 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.96 | 18.43 | 19.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   177.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   177.6          200            200            0.0024264273  -3.4683696e-39  0              0.007279282    12461.739      0              6.017328e+10   2.6109412e-16  0              3.3198803    
    200000   177.6          200            200            0.00090586811  1.3883573e-38  0              0.0027176043   3297.5042      0              1.5922468e+10  2.6109412e-16  0              3.0624417    
    300000   177.6          200            200            0.00014985225 -3.4669966e-39  0              0.00044955674  168.76451      0              8.1490343e+08  2.6109412e-16  0              3.0428049    
    400000   177.6          200            200           -8.8543129e-05  2.2611637e-37  0             -0.00026562939  90.558013      0              4.3727224e+08  2.6109412e-16  0              3.0046745    
    500000   177.6          200            200            0.007929553   -0.0006517789   0              0.024440438    5.980868       0              28879471       2.6109412e-16  0              2.9949339    
    600000   177.6          200            200            0.0032377676  -0.00024898364  0              0.0099622866   5.3230512      0              25703109       2.6109412e-16  0              2.9968139    
    700000   177.6          200            200            0.0035068564  -0.00021473488  0              0.010735304    0.05354997     0              258573.64      2.6109412e-16  0              2.9966961    
    800000   177.6          200            200            0.003103432   -0.00021077318  0              0.0095210691   0.013208083    0              63777.108      2.6109412e-16  0              2.996901     
    900000   177.6          200            200            0.0029346317  -0.00020873575  0              0.0090126307   0.0090624774   0              43759.46       2.6109412e-16  0              2.9969886    
   1000000   177.6          200            200            0.0028858799  -0.00020810506  0              0.0088657446   0.0018646793   0              9003.869       2.6109412e-16  0              2.997014     
   1100000   177.6          200            200            0.0028782185  -0.00020800692  0              0.0088426625   0.00019336295  0              933.68047      2.6109412e-16  0              2.9970179    
   1200000   177.6          200            200            0.0028800438  -0.00020803294  0              0.0088481643   7.7371565e-06  0              37.35996       2.6109412e-16  0              2.9970169    
   1300000   177.6          200            200            0.0028822145  -0.00020806236  0              0.0088547057   2.4612729e-08  0              0.11884606     2.6109412e-16  0              2.9970157    
   1400000   177.6          200            200            0.002883314   -0.00020807708  0              0.0088580192   2.2441853e-07  0              1.0836368      2.6109412e-16  0              2.9970151    
   1500000   177.6          200            200            0.0028837022  -0.00020808223  0              0.0088591887   7.4277549e-08  0              0.3586597      2.6109412e-16  0              2.9970149    
   1600000   177.6          200            200            0.0028837941  -0.00020808343  0              0.0088594656   1.1004329e-08  0              0.053135968    2.6109412e-16  0              2.9970149    
   1700000   177.6          200            200            0.0028837985  -0.00020808348  0              0.008859479    7.9364709e-10  0              0.0038322378   2.6109412e-16  0              2.9970149    
   1800000   177.6          200            200            0.0028837889  -0.00020808335  0              0.0088594499   1.0723935e-11  0              5.1782045e-05  2.6109412e-16  0              2.9970149    
   1900000   177.6          200            200            0.0028837823  -0.00020808326  0              0.00885943     3.1732397e-12  0              1.5322439e-05  2.6109412e-16  0              2.9970149    
   2000000   177.6          200            200            0.0028837795  -0.00020808322  0              0.0088594216   2.3956376e-12  0              1.1567677e-05  2.6109412e-16  0              2.9970149    
   2100000   177.6          200            200            0.0028837786  -0.00020808321  0              0.0088594191   5.1647539e-13  0              2.4938748e-06  2.6109412e-16  0              2.9970149    
   2200000   177.6          200            200            0.0028837785  -0.00020808321  0              0.0088594187   5.5820543e-14  0              2.6953742e-07  2.6109412e-16  0              2.9970149    
   2300000   177.6          200            200            0.0028837785  -0.00020808321  0              0.0088594188   2.4366907e-15  0              1.1765907e-08  2.6109412e-16  0              2.9970149    
   2400000   177.6          200            200            0.0028837786  -0.00020808321  0              0.0088594189   2.158648e-18   0              1.0423338e-11  2.6109412e-16  0              2.9970149    
   2500000   177.6          200            200            0.0028837786  -0.00020808321  0              0.0088594189   5.7062588e-17  0              2.7553482e-10  2.6109412e-16  0              2.9970149    
   2600000   177.6          200            200            0.0028837786  -0.00020808321  0              0.008859419    2.0480307e-17  0              9.8892071e-11  2.6109412e-16  0              2.9970149    
   2700000   177.6          200            200            0.0028837786  -0.00020808321  0              0.008859419    2.658248e-18   0              1.2835728e-11  2.6109412e-16  0              2.9970149    
   2800000   177.6          200            200            0.0028837786  -0.00020808321  0              0.008859419    1.5319829e-19  0              7.397397e-13   2.6109412e-16  0              2.9970149    
   2900000   177.6          200            200            0.0028837786  -0.00020808321  0              0.008859419    1.3632466e-19  0              6.58263e-13    2.6109412e-16  0              2.9970149    
   3000000   177.6          200            200            0.0028837786  -0.00020808321  0              0.008859419    5.1344632e-22  0              2.4792485e-15  2.6109412e-16  0              2.9970149    
Loop time of 63.8154 on 4 procs for 3000000 steps with 51 atoms

Performance: 40617124.030 ns/day, 0.000 hours/ns, 47010.560 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3082     | 1.6264     | 5.3507     | 168.7 |  2.55
Neigh   | 0.091422   | 0.091986   | 0.093551   |   0.3 |  0.14
Comm    | 25.677     | 32.26      | 38.089     |  83.7 | 50.55
Output  | 0.062944   | 0.063023   | 0.063084   |   0.0 |  0.10
Modify  | 15.147     | 21.031     | 28.336     | 122.1 | 32.96
Other   |            | 8.743      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 42

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.93                                                               
Lattice spacing in x,y,z = 5.93 5.93 5.93

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -88.95 ${n1e1} -100 100 -100 100 units box
region box block -88.95 88.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -88.95 88.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-88.95 -100 -100) to (88.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-88.95 -100 -100) to (88.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-88.95 -100 -100) to (88.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_42_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 115 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.96 | 18.43 | 19.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   177.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   177.9          200            200            0.0024255061   1.3882378e-38  0              0.0072765184   12485.954      0              6.0290202e+10  2.6109412e-16  0              3.3190435    
    200000   177.9          200            200            0.00091212867 -3.4636637e-38  0              0.002736386    3341.7827      0              1.6136273e+10  2.6109412e-16  0              3.0606804    
    300000   177.9          200            200            0.00016276831  3.4652592e-39  0              0.00048830494  196.56294      0              9.4913208e+08  2.6109412e-16  0              3.0419803    
    400000   177.9          200            200           -6.6170441e-05  4.3304523e-40  0             -0.00019851132  48.102183      0              2.3226823e+08  2.6109412e-16  0              3.0069982    
    500000   177.9          200            200            0.0010359823  -9.6491847e-05  0              0.0032044389   33.636097      0              1.6241668e+08  2.6109412e-16  0              2.9982763    
    600000   177.9          200            200            0.0039115586  -0.00022398284  0              0.011958659    3.7707482      0              18207594       2.6109412e-16  0              2.9966518    
    700000   177.9          200            200            0.0033444376  -0.00019183915  0              0.010225152    0.37283        0              1800262.7      2.6109412e-16  0              2.9969324    
    800000   177.9          200            200            0.0030933489  -0.00018968983  0              0.0094697365   0.02257646     0              109013.65      2.6109412e-16  0              2.9970619    
    900000   177.9          200            200            0.0029690871  -0.00018846943  0              0.0090957309   0.00090939676  0              4391.1515      2.6109412e-16  0              2.9971268    
   1000000   177.9          200            200            0.0029174406  -0.00018792964  0              0.0089402514   2.8081337e-06  0              13.559472      2.6109412e-16  0              2.9971539    
   1100000   177.9          200            200            0.0028972577  -0.0001877137   0              0.0088794869   8.1386848e-06  0              39.298796      2.6109412e-16  0              2.9971645    
   1200000   177.9          200            200            0.0028897435  -0.00018763273  0              0.0088568634   5.1729392e-06  0              24.978272      2.6109412e-16  0              2.9971684    
   1300000   177.9          200            200            0.0028870754  -0.00018760397  0              0.00884883     1.5565401e-06  0              7.5159751      2.6109412e-16  0              2.9971698    
   1400000   177.9          200            200            0.0028861753  -0.00018759429  0              0.0088461202   3.4621399e-07  0              1.6717435      2.6109412e-16  0              2.9971703    
   1500000   177.9          200            200            0.0028858898  -0.00018759123  0              0.0088452606   6.4426963e-08  0              0.31109475     2.6109412e-16  0              2.9971705    
   1600000   177.9          200            200            0.0028858065  -0.00018759035  0              0.0088450099   1.0547579e-08  0              0.050930483    2.6109412e-16  0              2.9971705    
   1700000   177.9          200            200            0.0028857853  -0.00018759012  0              0.0088449461   1.5541999e-09  0              0.0075046752   2.6109412e-16  0              2.9971705    
   1800000   177.9          200            200            0.0028857814  -0.00018759008  0              0.0088449342   2.0794455e-10  0              0.0010040898   2.6109412e-16  0              2.9971705    
   1900000   177.9          200            200            0.0028857814  -0.00018759009  0              0.0088449343   2.5235674e-11  0              0.00012185404  2.6109412e-16  0              2.9971705    
   2000000   177.9          200            200            0.002885782   -0.00018759009  0              0.008844936    2.7458333e-12  0              1.3258646e-05  2.6109412e-16  0              2.9971705    
   2100000   177.9          200            200            0.0028857824  -0.0001875901   0              0.0088449371   2.6062291e-13  0              1.2584548e-06  2.6109412e-16  0              2.9971705    
   2200000   177.9          200            200            0.0028857826  -0.0001875901   0              0.0088449378   2.0303549e-14  0              9.8038573e-08  2.6109412e-16  0              2.9971705    
   2300000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449381   1.1059775e-15  0              5.3403693e-09  2.6109412e-16  0              2.9971705    
   2400000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449382   1.95649e-17    0              9.4471899e-11  2.6109412e-16  0              2.9971705    
   2500000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449382   1.386456e-18   0              6.6946998e-12  2.6109412e-16  0              2.9971705    
   2600000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449383   2.4437216e-18  0              1.1799857e-11  2.6109412e-16  0              2.9971705    
   2700000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449383   1.728462e-18   0              8.3461244e-12  2.6109412e-16  0              2.9971705    
   2800000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449383   2.6699415e-19  0              1.2892192e-12  2.6109412e-16  0              2.9971705    
   2900000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449383   1.1642244e-19  0              5.6216232e-13  2.6109412e-16  0              2.9971705    
   3000000   177.9          200            200            0.0028857827  -0.0001875901   0              0.0088449383   5.6826799e-20  0              2.7439628e-13  2.6109412e-16  0              2.9971705    
Loop time of 64.1686 on 4 procs for 3000000 steps with 51 atoms

Performance: 40393590.262 ns/day, 0.000 hours/ns, 46751.841 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30361    | 1.5864     | 5.2004     | 165.7 |  2.47
Neigh   | 0.0915     | 0.09206    | 0.093705   |   0.3 |  0.14
Comm    | 25.639     | 32.409     | 38.306     |  85.7 | 50.51
Output  | 0.062878   | 0.062959   | 0.063022   |   0.0 |  0.10
Modify  | 15.315     | 21.286     | 28.76      | 123.4 | 33.17
Other   |            | 8.732      |            |       | 13.61

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 43

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.94                                                               
Lattice spacing in x,y,z = 5.94 5.94 5.94

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -89.1 ${n1e1} -100 100 -100 100 units box
region box block -89.1 89.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.1 89.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-89.1 -100 -100) to (89.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-89.1 -100 -100) to (89.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-89.1 -100 -100) to (89.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_43_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 115 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.96 | 18.43 | 19.59 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   178.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   178.2          200            200            0.00242432     1.2105151e-38  0              0.00727296     12507.654      0              6.7105538e+10  2.6109412e-16  0              3.318458     
    200000   178.2          200            200            0.0009184367   4.1505948e-38  0              0.0027553101   3386.5555      0              1.8169405e+10  2.6109412e-16  0              3.0589658    
    300000   178.2          200            200            0.00017667133 -1.0374244e-38  0              0.00053001399  228.42741      0              1.2255491e+09  2.6109412e-16  0              3.041        
    400000   178.2          200            200           -3.7910345e-05 -6.9163721e-39  0             -0.00011373103  14.885831      0              79864833       2.6109412e-16  0              3.0089451    
    500000   178.2          200            200            1.7156296e-05  6.9201375e-38  0              5.1468888e-05  2.7945096      0              14992985       2.6109412e-16  0              3.0001901    
    600000   178.2          200            200            0.0013421311  -0.00012927469  0              0.0041556681   0.88149685     0              4729369.8      2.6109412e-16  0              2.9982159    
    700000   178.2          200            200            0.0029464953  -0.00020308625  0              0.009042572    0.82433369     0              4422680.4      2.6109412e-16  0              2.9973114    
    800000   178.2          200            200            0.0026323227  -0.00016676602  0              0.008063734    0.007534275    0              40422.575      2.6109412e-16  0              2.997459     
    900000   178.2          200            200            0.0029040618  -0.00018381513  0              0.0088960005   0.014402636    0              77272.418      2.6109412e-16  0              2.9973366    
   1000000   178.2          200            200            0.0029078927  -0.00018391861  0              0.0089075968   0.0010192194   0              5468.273       2.6109412e-16  0              2.9973343    
   1100000   178.2          200            200            0.0028693864  -0.00018314904  0              0.0087913084   1.3159617e-05  0              70.603423      2.6109412e-16  0              2.9973511    
   1200000   178.2          200            200            0.002884085   -0.00018344829  0              0.0088357033   3.3029382e-05  0              177.20785      2.6109412e-16  0              2.9973448    
   1300000   178.2          200            200            0.0028834673  -0.0001834375   0              0.0088338394   3.194774e-06   0              17.140467      2.6109412e-16  0              2.997345     
   1400000   178.2          200            200            0.002881722   -0.00018340193  0              0.0088285678   4.7219686e-09  0              0.025334107    2.6109412e-16  0              2.9973458    
   1500000   178.2          200            200            0.0028824979  -0.00018341753  0              0.0088309113   7.2411045e-08  0              0.38849669     2.6109412e-16  0              2.9973454    
   1600000   178.2          200            200            0.0028824263  -0.00018341617  0              0.0088306952   9.4918295e-09  0              0.050925164    2.6109412e-16  0              2.9973454    
   1700000   178.2          200            200            0.0028823497  -0.0001834146   0              0.0088304638   4.9676322e-12  0              2.6652131e-05  2.6109412e-16  0              2.9973455    
   1800000   178.2          200            200            0.0028823898  -0.0001834154   0              0.0088305848   1.5126194e-10  0              0.00081154419  2.6109412e-16  0              2.9973455    
   1900000   178.2          200            200            0.0028823843  -0.0001834153   0              0.0088305681   2.6826282e-11  0              0.00014392724  2.6109412e-16  0              2.9973455    
   2000000   178.2          200            200            0.0028823811  -0.00018341523  0              0.0088305584   1.5211734e-13  0              8.1613353e-07  2.6109412e-16  0              2.9973455    
   2100000   178.2          200            200            0.0028823831  -0.00018341527  0              0.0088305645   2.9828954e-13  0              1.6003705e-06  2.6109412e-16  0              2.9973455    
   2200000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305634   7.2559446e-14  0              3.8929288e-07  2.6109412e-16  0              2.9973455    
   2300000   178.2          200            200            0.0028823826  -0.00018341526  0              0.008830563    1.0916076e-15  0              5.856647e-09   2.6109412e-16  0              2.9973455    
   2400000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305633   5.3812356e-16  0              2.8871179e-09  2.6109412e-16  0              2.9973455    
   2500000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305632   1.8859409e-16  0              1.0118371e-09  2.6109412e-16  0              2.9973455    
   2600000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305632   5.2209341e-18  0              2.8011136e-11  2.6109412e-16  0              2.9973455    
   2700000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305632   1.6259332e-18  0              8.7233886e-12  2.6109412e-16  0              2.9973455    
   2800000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305632   4.4408184e-20  0              2.3825692e-13  2.6109412e-16  0              2.9973455    
   2900000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305632   6.5473073e-20  0              3.5127337e-13  2.6109412e-16  0              2.9973455    
   3000000   178.2          200            200            0.0028823827  -0.00018341526  0              0.0088305632   2.2810911e-20  0              1.2238414e-13  2.6109412e-16  0              2.9973455    
Loop time of 63.2134 on 4 procs for 3000000 steps with 50 atoms

Performance: 41003985.649 ns/day, 0.000 hours/ns, 47458.317 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28918    | 1.7079     | 5.6645     | 174.9 |  2.70
Neigh   | 0.091501   | 0.092102   | 0.093854   |   0.3 |  0.15
Comm    | 25.128     | 31.751     | 37.631     |  84.0 | 50.23
Output  | 0.060215   | 0.060296   | 0.06036    |   0.0 |  0.10
Modify  | 15.029     | 20.913     | 28.305     | 122.4 | 33.08
Other   |            | 8.689      |            |       | 13.75

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.62
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 44

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.95                                                               
Lattice spacing in x,y,z = 5.95 5.95 5.95

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -89.25 ${n1e1} -100 100 -100 100 units box
region box block -89.25 89.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.25 89.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-89.25 -100 -100) to (89.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-89.25 -100 -100) to (89.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-89.25 -100 -100) to (89.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_44_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 116 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.98 | 18.45 | 19.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   178.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   178.5          200            200            0.0024227439   1.3994432e-42  0              0.0072682318   12525.896      0              6.0483067e+10  2.6109412e-16  0              3.3181461    
    200000   178.5          200            200            0.00092374297  3.2368763e-40  0              0.0027712289   3425.6416      0              1.6541198e+10  2.6109412e-16  0              3.0576671    
    300000   178.5          200            200            0.00019114073  2.071821e-38   0              0.00057342219  263.66762      0              1.2731566e+09  2.6109412e-16  0              3.0399145    
    400000   178.5          200            200           -8.042296e-06   6.9059925e-39  0             -2.4126888e-05  0.6267326      0              3026267.4      2.6109412e-16  0              3.0100614    
    500000   178.5          200            200            0.0071465355  -0.00062599239  0              0.022065599    24.088727      0              1.1631584e+08  2.6109412e-16  0              2.9962054    
    600000   178.5          200            200            0.0019757777  -0.00012829842  0              0.0060556314   5.1009537      0              24630680       2.6109412e-16  0              2.9980119    
    700000   178.5          200            200            0.003642877   -0.00026881349  0              0.011197444    0.045332911    0              218896.41      2.6109412e-16  0              2.997313     
    800000   178.5          200            200            0.0026231904  -0.00022582692  0              0.0080953982   0.034121226    0              164759.19      2.6109412e-16  0              2.9977065    
    900000   178.5          200            200            0.0029104544  -0.00023245268  0              0.008963816    0.012493305    0              60325.697      2.6109412e-16  0              2.9975901    
   1000000   178.5          200            200            0.0028633742  -0.00023149493  0              0.0088216176   0.0021533501   0              10397.757      2.6109412e-16  0              2.9976093    
   1100000   178.5          200            200            0.0028538743  -0.00023131518  0              0.0087929381   0.00020683057  0              998.71078      2.6109412e-16  0              2.9976128    
   1200000   178.5          200            200            0.0028663883  -0.00023156526  0              0.0088307302   8.1376627e-06  0              39.293861      2.6109412e-16  0              2.9976079    
   1300000   178.5          200            200            0.0028597416  -0.00023143148  0              0.0088106563   1.8721734e-08  0              0.090400554    2.6109412e-16  0              2.9976105    
   1400000   178.5          200            200            0.0028622666  -0.00023148279  0              0.0088182826   2.2350306e-07  0              1.0792163      2.6109412e-16  0              2.9976095    
   1500000   178.5          200            200            0.0028615633  -0.00023146838  0              0.0088161584   7.9241087e-08  0              0.38262685     2.6109412e-16  0              2.9976098    
   1600000   178.5          200            200            0.002861668   -0.00023147059  0              0.0088164744   1.3150861e-08  0              0.063500803    2.6109412e-16  0              2.9976098    
   1700000   178.5          200            200            0.0028616967  -0.00023147114  0              0.0088165613   1.2031619e-09  0              0.0058096381   2.6109412e-16  0              2.9976098    
   1800000   178.5          200            200            0.0028616643  -0.00023147049  0              0.0088164634   4.2194663e-11  0              0.00020374293  2.6109412e-16  0              2.9976098    
   1900000   178.5          200            200            0.002861681   -0.00023147083  0              0.0088165138   3.2620141e-13  0              1.5751099e-06  2.6109412e-16  0              2.9976098    
   2000000   178.5          200            200            0.0028616748  -0.0002314707   0              0.0088164951   1.5411668e-12  0              7.4417429e-06  2.6109412e-16  0              2.9976098    
   2100000   178.5          200            200            0.0028616765  -0.00023147074  0              0.0088165001   5.0485187e-13  0              2.437749e-06   2.6109412e-16  0              2.9976098    
   2200000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   8.0110115e-14  0              3.8682308e-07  2.6109412e-16  0              2.9976098    
   2300000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164992   6.9670423e-15  0              3.3641354e-08  2.6109412e-16  0              2.9976098    
   2400000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   2.1822292e-16  0              1.0537204e-09  2.6109412e-16  0              2.9976098    
   2500000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164993   3.8938917e-18  0              1.880221e-11   2.6109412e-16  0              2.9976098    
   2600000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   1.1366238e-17  0              5.4883494e-11  2.6109412e-16  0              2.9976098    
   2700000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   3.1091497e-18  0              1.5012971e-11  2.6109412e-16  0              2.9976098    
   2800000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   1.2587119e-19  0              6.0778691e-13  2.6109412e-16  0              2.9976098    
   2900000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   8.5841837e-21  0              4.1449951e-14  2.6109412e-16  0              2.9976098    
   3000000   178.5          200            200            0.0028616762  -0.00023147073  0              0.0088164994   1.5699469e-19  0              7.5807116e-13  2.6109412e-16  0              2.9976098    
Loop time of 64.0778 on 4 procs for 3000000 steps with 51 atoms

Performance: 40450835.247 ns/day, 0.000 hours/ns, 46818.096 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31645    | 1.7252     | 5.734      | 176.3 |  2.69
Neigh   | 0.09225    | 0.092886   | 0.094398   |   0.3 |  0.14
Comm    | 25.653     | 32.36      | 38.296     |  84.8 | 50.50
Output  | 0.060659   | 0.060743   | 0.060809   |   0.0 |  0.09
Modify  | 15.23      | 21.165     | 28.627     | 123.4 | 33.03
Other   |            | 8.674      |            |       | 13.54

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 45

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.96                                                               
Lattice spacing in x,y,z = 5.96 5.96 5.96

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -89.4 ${n1e1} -100 100 -100 100 units box
region box block -89.4 89.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.4 89.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-89.4 -100 -100) to (89.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-89.4 -100 -100) to (89.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-89.4 -100 -100) to (89.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_45_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 116 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.98 | 18.45 | 19.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   178.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   178.8          200            200            0.0024207239   2.278472e-43   0              0.0072621717   12540.389      0              6.055305e+10   2.6109412e-16  0              3.3180675    
    200000   178.8          200            200            0.00092693835  6.8977612e-39  0              0.0027808151   3452.4471      0              1.6670632e+10  2.6109412e-16  0              3.0571228    
    300000   178.8          200            200            0.0002046529   1.7241554e-39  0              0.00061395869  298.49887      0              1.4413442e+09  2.6109412e-16  0              3.0389217    
    400000   178.8          200            200            2.6366546e-05  4.3093447e-40  0              7.9099639e-05  6.4822293      0              31300365       2.6109412e-16  0              3.0102855    
    500000   178.8          200            200            6.8707263e-05 -5.4529616e-06  0              0.00021157475  25.427202      0              1.2277886e+08  2.6109412e-16  0              2.999565     
    600000   178.8          200            200            0.0031543766  -0.0003173583   0              0.0097804882   6.5119671      0              31443959       2.6109412e-16  0              2.9977307    
    700000   178.8          200            200            0.0026119522  -0.00022865759  0              0.0080645141   0.81237719     0              3922678.7      2.6109412e-16  0              2.9979526    
    800000   178.8          200            200            0.0027225558  -0.00023052285  0              0.0083981903   0.096590167    0              466399.35      2.6109412e-16  0              2.9979117    
    900000   178.8          200            200            0.0027822152  -0.00023147038  0              0.0085781159   0.0088220346   0              42598.448      2.6109412e-16  0              2.9978895    
   1000000   178.8          200            200            0.0028217461  -0.00023208155  0              0.0086973197   0.00055314536  0              2670.941       2.6109412e-16  0              2.9978746    
   1100000   178.8          200            200            0.0028421749  -0.00023239099  0              0.0087589156   1.4066116e-05  0              67.920238      2.6109412e-16  0              2.9978668    
   1200000   178.8          200            200            0.0028512011  -0.00023252644  0              0.0087861298   3.0879679e-07  0              1.4910692      2.6109412e-16  0              2.9978634    
   1300000   178.8          200            200            0.0028547702  -0.00023257989  0              0.0087968906   8.059085e-07   0              3.8914437      2.6109412e-16  0              2.997862     
   1400000   178.8          200            200            0.0028560524  -0.00023259912  0              0.0088007564   3.0759086e-07  0              1.4852462      2.6109412e-16  0              2.9978615    
   1500000   178.8          200            200            0.0028564689  -0.00023260539  0              0.0088020121   7.1609618e-08  0              0.34577722     2.6109412e-16  0              2.9978614    
   1600000   178.8          200            200            0.0028565876  -0.00023260719  0              0.0088023698   1.2697506e-08  0              0.061311712    2.6109412e-16  0              2.9978613    
   1700000   178.8          200            200            0.0028566144  -0.0002326076   0              0.0088024509   1.835374e-09   0              0.0088623644   2.6109412e-16  0              2.9978613    
   1800000   178.8          200            200            0.0028566173  -0.00023260765  0              0.0088024594   2.1924973e-10  0              0.0010586785   2.6109412e-16  0              2.9978613    
   1900000   178.8          200            200            0.0028566156  -0.00023260762  0              0.0088024544   2.1074071e-11  0              0.00010175915  2.6109412e-16  0              2.9978613    
   2000000   178.8          200            200            0.002856614   -0.0002326076   0              0.0088024497   1.480988e-12   0              7.1511608e-06  2.6109412e-16  0              2.9978613    
   2100000   178.8          200            200            0.0028566132  -0.00023260759  0              0.0088024471   5.4034929e-14  0              2.6091533e-07  2.6109412e-16  0              2.9978613    
   2200000   178.8          200            200            0.0028566128  -0.00023260758  0              0.0088024459   2.0846795e-18  0              1.0066171e-11  2.6109412e-16  0              2.9978613    
   2300000   178.8          200            200            0.0028566126  -0.00023260758  0              0.0088024454   1.053446e-15   0              5.0867139e-09  2.6109412e-16  0              2.9978613    
   2400000   178.8          200            200            0.0028566126  -0.00023260758  0              0.0088024453   5.0439781e-16  0              2.4355565e-09  2.6109412e-16  0              2.9978613    
   2500000   178.8          200            200            0.0028566125  -0.00023260758  0              0.0088024452   1.298638e-16   0              6.2706583e-10  2.6109412e-16  0              2.9978613    
   2600000   178.8          200            200            0.0028566125  -0.00023260758  0              0.0088024452   2.5160248e-17  0              1.2148983e-10  2.6109412e-16  0              2.9978613    
   2700000   178.8          200            200            0.0028566125  -0.00023260758  0              0.0088024452   3.8556957e-18  0              1.8617774e-11  2.6109412e-16  0              2.9978613    
   2800000   178.8          200            200            0.0028566125  -0.00023260758  0              0.0088024452   2.776376e-19   0              1.3406126e-12  2.6109412e-16  0              2.9978613    
   2900000   178.8          200            200            0.0028566125  -0.00023260758  0              0.0088024452   1.6731592e-19  0              8.0790869e-13  2.6109412e-16  0              2.9978613    
   3000000   178.8          200            200            0.0028566125  -0.00023260758  0              0.0088024452   1.5556005e-20  0              7.5114381e-14  2.6109412e-16  0              2.9978613    
Loop time of 64.4454 on 4 procs for 3000000 steps with 51 atoms

Performance: 40220083.949 ns/day, 0.000 hours/ns, 46551.023 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28456    | 1.7487     | 5.8553     | 179.4 |  2.71
Neigh   | 0.092225   | 0.09294    | 0.094492   |   0.3 |  0.14
Comm    | 25.791     | 32.63      | 38.615     |  85.4 | 50.63
Output  | 0.061209   | 0.06129    | 0.06136    |   0.0 |  0.10
Modify  | 15.244     | 21.219     | 28.847     | 124.6 | 32.92
Other   |            | 8.694      |            |       | 13.49

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 46

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.97                                                               
Lattice spacing in x,y,z = 5.97 5.97 5.97

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -89.55 ${n1e1} -100 100 -100 100 units box
region box block -89.55 89.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.55 89.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-89.55 -100 -100) to (89.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-89.55 -100 -100) to (89.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-89.55 -100 -100) to (89.55 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_46_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 116 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.98 | 18.45 | 19.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   179.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   179.1          200            200            0.0024182415  -1.0321263e-38  0              0.0072547246   12551.162      0              6.0605067e+10  2.6109412e-16  0              3.3181559    
    200000   179.1          200            200            0.00092806435  8.1466266e-42  0              0.0027841931   3467.1754      0              1.6741749e+10  2.6109412e-16  0              3.0572275    
    300000   179.1          200            200            0.0002124502   6.8827908e-39  0              0.0006373506   319.75264      0              1.543971e+09   2.6109412e-16  0              3.0386472    
    400000   179.1          200            200            5.9846635e-05  4.3016479e-40  0              0.0001795399   31.661798      0              1.5288349e+08  2.6109412e-16  0              3.0096491    
    500000   179.1          200            200            0.00024846596 -9.0094997e-10  0              0.00074539877  33.34954       0              1.6103299e+08  2.6109412e-16  0              2.9995358    
    600000   179.1          200            200            0.0052782695  -0.00051007733  0              0.016344886    1.3366687      0              6454294.6      2.6109412e-16  0              2.9974616    
    700000   179.1          200            200            0.0019767015  -0.00018614029  0              0.0061162449   0.0010756696   0              5194.0235      2.6109412e-16  0              2.9984489    
    800000   179.1          200            200            0.0027572271  -0.00025284416  0              0.0085245254   0.12470928     0              602176.46      2.6109412e-16  0              2.998175     
    900000   179.1          200            200            0.0029421717  -0.00025641116  0              0.0090829263   0.0072276921   0              34899.938      2.6109412e-16  0              2.9981177    
   1000000   179.1          200            200            0.0028872609  -0.00025541022  0              0.0089171928   0.00039428785  0              1903.8749      2.6109412e-16  0              2.9981351    
   1100000   179.1          200            200            0.0028458637  -0.00025461724  0              0.0087922084   0.00032838301  0              1585.644       2.6109412e-16  0              2.9981481    
   1200000   179.1          200            200            0.0028393132  -0.00025449054  0              0.00877243     1.2070032e-05  0              58.281867      2.6109412e-16  0              2.9981501    
   1300000   179.1          200            200            0.0028426682  -0.00025455824  0              0.0087825627   1.6133924e-06  0              7.7904943      2.6109412e-16  0              2.998149     
   1400000   179.1          200            200            0.002844697   -0.00025459832  0              0.0087886894   8.1374565e-07  0              3.9292865      2.6109412e-16  0              2.9981484    
   1500000   179.1          200            200            0.0028449329  -0.00025460281  0              0.0087894014   1.8176276e-08  0              0.087766732    2.6109412e-16  0              2.9981483    
   1600000   179.1          200            200            0.0028447385  -0.00025459893  0              0.0087888144   5.8092724e-09  0              0.028050897    2.6109412e-16  0              2.9981484    
   1700000   179.1          200            200            0.0028446405  -0.000254597    0              0.0087885185   1.9496493e-09  0              0.0094141589   2.6109412e-16  0              2.9981484    
   1800000   179.1          200            200            0.0028446335  -0.00025459687  0              0.0087884973   2.2086502e-11  0              0.00010664781  2.6109412e-16  0              2.9981484    
   1900000   179.1          200            200            0.0028446443  -0.00025459708  0              0.0087885301   1.9153765e-11  0              9.2486679e-05  2.6109412e-16  0              2.9981484    
   2000000   179.1          200            200            0.002844649   -0.00025459717  0              0.0087885442   4.5106169e-12  0              2.1780155e-05  2.6109412e-16  0              2.9981484    
   2100000   179.1          200            200            0.0028446491  -0.00025459718  0              0.0087885445   1.6887624e-14  0              8.1544291e-08  2.6109412e-16  0              2.9981484    
   2200000   179.1          200            200            0.0028446485  -0.00025459716  0              0.0087885427   5.9141534e-14  0              2.855733e-07   2.6109412e-16  0              2.9981484    
   2300000   179.1          200            200            0.0028446483  -0.00025459716  0              0.008788542    1.0060077e-14  0              4.8576511e-08  2.6109412e-16  0              2.9981484    
   2400000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885421   1.5383573e-18  0              7.4281766e-12  2.6109412e-16  0              2.9981484    
   2500000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885422   1.7339112e-16  0              8.3724366e-10  2.6109412e-16  0              2.9981484    
   2600000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885422   2.0749652e-17  0              1.0019264e-10  2.6109412e-16  0              2.9981484    
   2700000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885422   1.1753901e-19  0              5.6755382e-13  2.6109412e-16  0              2.9981484    
   2800000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885422   4.9049041e-19  0              2.3684026e-12  2.6109412e-16  0              2.9981484    
   2900000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885422   5.0809793e-20  0              2.4534231e-13  2.6109412e-16  0              2.9981484    
   3000000   179.1          200            200            0.0028446483  -0.00025459716  0              0.0087885422   2.3128102e-20  0              1.1167733e-13  2.6109412e-16  0              2.9981484    
Loop time of 64.1911 on 4 procs for 3000000 steps with 51 atoms

Performance: 40379439.245 ns/day, 0.000 hours/ns, 46735.462 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30679    | 1.7908     | 5.9971     | 181.5 |  2.79
Neigh   | 0.094402   | 0.09501    | 0.096659   |   0.3 |  0.15
Comm    | 25.605     | 32.314     | 38.398     |  84.9 | 50.34
Output  | 0.060172   | 0.060256   | 0.060322   |   0.0 |  0.09
Modify  | 15.262     | 21.24      | 28.838     | 124.5 | 33.09
Other   |            | 8.69       |            |       | 13.54

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 47

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.98                                                               
Lattice spacing in x,y,z = 5.98 5.98 5.98

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -89.7 ${n1e1} -100 100 -100 100 units box
region box block -89.7 89.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.7 89.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-89.7 -100 -100) to (89.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-89.7 -100 -100) to (89.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-89.7 -100 -100) to (89.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_47_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 116 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.98 | 18.45 | 19.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   179.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   179.4          200            200            0.0024152978  -8.5854453e-40  0              0.0072458933   12558.407      0              6.0640054e+10  2.6109412e-16  0              3.3183332    
    200000   179.4          200            200            0.0009276083   1.0307695e-38  0              0.0027828249   3472.7361      0              1.67686e+10    2.6109412e-16  0              3.0577064    
    300000   179.4          200            200            0.00021445839  2.7693874e-38  0              0.00064337518  325.96006      0              1.5739445e+09  2.6109412e-16  0              3.0390487    
    400000   179.4          200            200            7.6074245e-05 -5.4426968e-38  0              0.00022822274  50.045186      0              2.416503e+08   2.6109412e-16  0              3.0093526    
    500000   179.4          200            200            0.0048549888  -0.0011181399   0              0.015683106    48.525094      0              2.3431031e+08  2.6109412e-16  0              2.9979633    
    600000   179.4          200            200            0.00089725522 -9.186433e-05   0              0.00278363     2.8583353      0              13801878       2.6109412e-16  0              2.9991412    
    700000   179.4          200            200            0.0029349561  -0.00026334504  0              0.0090682133   1.077789       0              5204257.4      2.6109412e-16  0              2.9984639    
    800000   179.4          200            200            0.0025800854  -0.00027931943  0              0.0080195756   0.086284969    0              416639.23      2.6109412e-16  0              2.9985529    
    900000   179.4          200            200            0.0029727978  -0.00028729022  0              0.0092056836   0.00072325745  0              3492.3514      2.6109412e-16  0              2.9984494    
   1000000   179.4          200            200            0.0027848282  -0.00028399932  0              0.008638484    0.00072212254  0              3486.8713      2.6109412e-16  0              2.9984986    
   1100000   179.4          200            200            0.0028353007  -0.00028498681  0              0.0087908891   0.00033522872  0              1618.6995      2.6109412e-16  0              2.9984852    
   1200000   179.4          200            200            0.0028332174  -0.00028494278  0              0.0087845949   3.9370201e-05  0              190.10461      2.6109412e-16  0              2.9984858    
   1300000   179.4          200            200            0.0028275112  -0.00028483705  0              0.0087673706   8.4702826e-07  0              4.0899963      2.6109412e-16  0              2.9984873    
   1400000   179.4          200            200            0.0028308854  -0.00028490045  0              0.0087775568   1.22814e-07    0              0.59302487     2.6109412e-16  0              2.9984864    
   1500000   179.4          200            200            0.0028298305  -0.00028488048  0              0.008774372    9.8772727e-08  0              0.47693815     2.6109412e-16  0              2.9984867    
   1600000   179.4          200            200            0.0028299451  -0.00028488273  0              0.0087747181   1.5069865e-08  0              0.072766986    2.6109412e-16  0              2.9984866    
   1700000   179.4          200            200            0.0028300258  -0.00028488422  0              0.0087749616   5.7349599e-10  0              0.0027692069   2.6109412e-16  0              2.9984866    
   1800000   179.4          200            200            0.0028299666  -0.00028488311  0              0.0087747829   1.3267041e-11  0              6.4061794e-05  2.6109412e-16  0              2.9984866    
   1900000   179.4          200            200            0.0028299877  -0.00028488351  0              0.0087748467   2.7167969e-11  0              0.0001311844   2.6109412e-16  0              2.9984866    
   2000000   179.4          200            200            0.0028299843  -0.00028488344  0              0.0087748364   5.4263371e-12  0              2.620184e-05   2.6109412e-16  0              2.9984866    
   2100000   179.4          200            200            0.0028299833  -0.00028488342  0              0.0087748333   3.0925575e-13  0              1.4932853e-06  2.6109412e-16  0              2.9984866    
   2200000   179.4          200            200            0.0028299843  -0.00028488344  0              0.0087748364   1.9517884e-16  0              9.4244875e-10  2.6109412e-16  0              2.9984866    
   2300000   179.4          200            200            0.0028299839  -0.00028488343  0              0.0087748351   6.8530612e-15  0              3.309098e-08   2.6109412e-16  0              2.9984866    
   2400000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   1.8441103e-15  0              8.9045487e-09  2.6109412e-16  0              2.9984866    
   2500000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   1.47525e-16    0              7.1234541e-10  2.6109412e-16  0              2.9984866    
   2600000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   7.4449632e-19  0              3.5949063e-12  2.6109412e-16  0              2.9984866    
   2700000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   2.528979e-18   0              1.2211534e-11  2.6109412e-16  0              2.9984866    
   2800000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   5.7365937e-20  0              2.7699958e-13  2.6109412e-16  0              2.9984866    
   2900000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   8.3725995e-20  0              4.0428287e-13  2.6109412e-16  0              2.9984866    
   3000000   179.4          200            200            0.002829984   -0.00028488344  0              0.0087748354   1.1347294e-19  0              5.4792023e-13  2.6109412e-16  0              2.9984866    
Loop time of 64.1309 on 4 procs for 3000000 steps with 51 atoms

Performance: 40417308.716 ns/day, 0.000 hours/ns, 46779.292 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30452    | 1.8745     | 6.3681     | 189.5 |  2.92
Neigh   | 0.094514   | 0.095421   | 0.0973     |   0.4 |  0.15
Comm    | 25.678     | 32.214     | 38.357     |  83.5 | 50.23
Output  | 0.061673   | 0.061755   | 0.061818   |   0.0 |  0.10
Modify  | 15.197     | 21.157     | 28.647     | 123.6 | 32.99
Other   |            | 8.728      |            |       | 13.61

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 48

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 5.99                                                               
Lattice spacing in x,y,z = 5.99 5.99 5.99

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -89.85 ${n1e1} -100 100 -100 100 units box
region box block -89.85 89.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -89.85 89.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-89.85 -100 -100) to (89.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-89.85 -100 -100) to (89.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-89.85 -100 -100) to (89.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_48_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 116 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 14.98 | 18.45 | 19.6 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   179.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   179.7          200            200            0.002411905   -1.286073e-39   0              0.007235715    12562.414      0              6.7399337e+10  2.6109412e-16  0              3.3185167    
    200000   179.7          200            200            0.00092618944 -4.2869759e-40  0              0.0027785683   3472.8676      0              1.8632483e+10  2.6109412e-16  0              3.0582436    
    300000   179.7          200            200            0.00021336326 -1.3710525e-38  0              0.00064008978  323.89892      0              1.7377688e+09  2.6109412e-16  0              3.0396538    
    400000   179.7          200            200            7.7144107e-05  2.7491067e-38  0              0.00023143232  51.528717      0              2.7645971e+08  2.6109412e-16  0              3.0097369    
    500000   179.7          200            200           -5.8699585e-05 -5.1442817e-39  0             -0.00017609876  38.238398      0              2.0515504e+08  2.6109412e-16  0              3.000047     
    600000   179.7          200            200            0.0016002663  -5.409525e-05   0              0.0048548941   7.1499745      0              38360742       2.6109412e-16  0              2.9991968    
    700000   179.7          200            200            0.002368122   -0.00019116761  0              0.0072955335   0.991132       0              5317579.7      2.6109412e-16  0              2.9989859    
    800000   179.7          200            200            0.0032759156  -0.00019089448  0              0.010018641    0.025189292    0              135144.53      2.6109412e-16  0              2.9987802    
    900000   179.7          200            200            0.0026926453  -0.00019231096  0              0.0082702469   0.00022032817  0              1182.0954      2.6109412e-16  0              2.9989083    
   1000000   179.7          200            200            0.0029080679  -0.00019223335  0              0.0089164369   0.00084593879  0              4538.5952      2.6109412e-16  0              2.9988602    
   1100000   179.7          200            200            0.0028444891  -0.00019231443  0              0.0087257817   0.00029019582  0              1556.9464      2.6109412e-16  0              2.9988742    
   1200000   179.7          200            200            0.0028571681  -0.00019230217  0              0.0087638064   5.3716905e-05  0              288.19968      2.6109412e-16  0              2.9988714    
   1300000   179.7          200            200            0.0028573856  -0.00019230182  0              0.0087644587   6.4345481e-06  0              34.522367      2.6109412e-16  0              2.9988713    
   1400000   179.7          200            200            0.0028555294  -0.00019230381  0              0.008758892    4.6841097e-07  0              2.5130988      2.6109412e-16  0              2.9988718    
   1500000   179.7          200            200            0.0028567269  -0.00019230255  0              0.0087624833   1.1892453e-08  0              0.063804888    2.6109412e-16  0              2.9988715    
   1600000   179.7          200            200            0.0028561868  -0.00019230312  0              0.0087608636   4.2205446e-10  0              0.0022643888   2.6109412e-16  0              2.9988716    
   1700000   179.7          200            200            0.0028563817  -0.00019230291  0              0.0087614479   8.0247861e-10  0              0.0043054245   2.6109412e-16  0              2.9988716    
   1800000   179.7          200            200            0.002856326   -0.00019230297  0              0.008761281    2.5401321e-10  0              0.001362821    2.6109412e-16  0              2.9988716    
   1900000   179.7          200            200            0.0028563364  -0.00019230296  0              0.0087613122   4.4864736e-11  0              0.00024070639  2.6109412e-16  0              2.9988716    
   2000000   179.7          200            200            0.0028563371  -0.00019230296  0              0.0087613142   5.150226e-12   0              2.7631776e-05  2.6109412e-16  0              2.9988716    
   2100000   179.7          200            200            0.0028563352  -0.00019230296  0              0.0087613087   3.5202527e-13  0              1.8886712e-06  2.6109412e-16  0              2.9988716    
   2200000   179.7          200            200            0.0028563364  -0.00019230296  0              0.008761312    7.2007481e-15  0              3.8633151e-08  2.6109412e-16  0              2.9988716    
   2300000   179.7          200            200            0.0028563359  -0.00019230296  0              0.0087613106   5.8081937e-16  0              3.1161876e-09  2.6109412e-16  0              2.9988716    
   2400000   179.7          200            200            0.002856336   -0.00019230296  0              0.0087613111   7.4698392e-16  0              4.0076867e-09  2.6109412e-16  0              2.9988716    
   2500000   179.7          200            200            0.002856336   -0.00019230296  0              0.0087613109   2.1950881e-16  0              1.1776994e-09  2.6109412e-16  0              2.9988716    
   2600000   179.7          200            200            0.002856336   -0.00019230296  0              0.008761311    3.7204191e-17  0              1.9960636e-10  2.6109412e-16  0              2.9988716    
   2700000   179.7          200            200            0.002856336   -0.00019230296  0              0.008761311    4.4219076e-18  0              2.3724233e-11  2.6109412e-16  0              2.9988716    
   2800000   179.7          200            200            0.002856336   -0.00019230296  0              0.008761311    4.7353602e-19  0              2.5405955e-12  2.6109412e-16  0              2.9988716    
   2900000   179.7          200            200            0.002856336   -0.00019230296  0              0.008761311    6.7681304e-21  0              3.6312088e-14  2.6109412e-16  0              2.9988716    
   3000000   179.7          200            200            0.002856336   -0.00019230296  0              0.008761311    8.366659e-23   0              4.4888447e-16  2.6109412e-16  0              2.9988716    
Loop time of 62.9185 on 4 procs for 3000000 steps with 50 atoms

Performance: 41196156.919 ns/day, 0.000 hours/ns, 47680.737 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29435    | 1.9204     | 6.5594     | 193.3 |  3.05
Neigh   | 0.094386   | 0.095169   | 0.096614   |   0.3 |  0.15
Comm    | 25.035     | 31.266     | 37.335     |  81.4 | 49.69
Output  | 0.063417   | 0.063495   | 0.063558   |   0.0 |  0.10
Modify  | 15.043     | 20.89      | 28.15      | 121.3 | 33.20
Other   |            | 8.683      |            |       | 13.80

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.62
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 49

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6                                                               
Lattice spacing in x,y,z = 6 6 6

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90 ${n1e1} -100 100 -100 100 units box
region box block -90 90 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90 90 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90 -100 -100) to (90 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90 -100 -100) to (90 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90 -100 -100) to (90 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_49_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15 | 18.47 | 19.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   180            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   180            200            200            0.0024081006   2.811639e-42   0              0.0072243017   12563.793      0              6.066606e+10   2.6109412e-16  0              3.3185686    
    200000   180            200            200            0.00092472586  5.48727e-38    0              0.0027741776   3473.1315      0              1.6770509e+10  2.6109412e-16  0              3.0584095    
    300000   180            200            200            0.00021269564  1.3012636e-37  0              0.00063808691  323.03281      0              1.5598098e+09  2.6109412e-16  0              3.039872     
    400000   180            200            200            7.6314032e-05  2.1916182e-37  0              0.0002289421   50.642482      0              2.4453442e+08  2.6109412e-16  0              3.0099478    
    500000   180            200            200           -5.8392665e-05  6.6872622e-41  0             -0.00017517799  37.943278      0              1.8321451e+08  2.6109412e-16  0              3.0002228    
    600000   180            200            200            0.0038613017  -2.6529328e-40  0              0.011583905    8.1463906      0              39336005       2.6109412e-16  0              2.9988392    
    700000   180            200            200            0.0040825783  -1.0989107e-37  0              0.012247735    0.20344381     0              982357.34      2.6109412e-16  0              2.99879      
    800000   180            200            200            0.0025229844   2.73061e-38    0              0.0075689532   0.036897151    0              178163.14      2.6109412e-16  0              2.9991211    
    900000   180            200            200            0.0030745173   1.1900015e-38  0              0.009223552    0.0022753454   0              10986.828      2.6109412e-16  0              2.9989979    
   1000000   180            200            200            0.0028549756   2.1829203e-41  0              0.0085649267   3.449885e-05   0              166.5826       2.6109412e-16  0              2.999046     
   1100000   180            200            200            0.0029381047   5.4870884e-38  0              0.008814314    5.2239034e-06  0              25.22436       2.6109412e-16  0              2.9990276    
   1200000   180            200            200            0.0029079223  -2.1903603e-37  0              0.008723767    5.9520655e-06  0              28.740394      2.6109412e-16  0              2.9990343    
   1300000   180            200            200            0.0029183017  -1.3683316e-37  0              0.0087549052   2.0803943e-06  0              10.04548       2.6109412e-16  0              2.999032     
   1400000   180            200            200            0.0029149343  -1.3578118e-38  0              0.008744803    4.9646082e-07  0              2.3972316      2.6109412e-16  0              2.9990327    
   1500000   180            200            200            0.0029159458  -6.8375548e-38  0              0.0087478373   9.6372545e-08  0              0.46534853     2.6109412e-16  0              2.9990325    
   1600000   180            200            200            0.0029156756   9.7794489e-41  0              0.0087470269   1.6231966e-08  0              0.078378354    2.6109412e-16  0              2.9990326    
   1700000   180            200            200            0.0029157326   4.3834454e-37  0              0.0087471978   2.4415341e-09  0              0.011789295    2.6109412e-16  0              2.9990326    
   1800000   180            200            200            0.0029157283  -2.7278347e-38  0              0.0087471848   3.3180971e-10  0              0.0016021903   2.6109412e-16  0              2.9990326    
   1900000   180            200            200            0.0029157237   5.4877723e-38  0              0.008747171    4.0759164e-11  0              0.00019681142  2.6109412e-16  0              2.9990326    
   2000000   180            200            200            0.0029157276  -1.0948676e-37  0              0.0087471827   4.4785878e-12  0              2.1625498e-05  2.6109412e-16  0              2.9990326    
   2100000   180            200            200            0.0029157254  -2.1905654e-37  0              0.0087471762   4.2880727e-13  0              2.0705568e-06  2.6109412e-16  0              2.9990326    
   2200000   180            200            200            0.0029157264   2.1921208e-37  0              0.0087471793   3.3676235e-14  0              1.6261049e-07  2.6109412e-16  0              2.9990326    
   2300000   180            200            200            0.002915726    9.226342e-41   0              0.0087471779   1.8543354e-15  0              8.9539218e-09  2.6109412e-16  0              2.9990326    
   2400000   180            200            200            0.0029157262   8.2265349e-38  0              0.0087471785   3.8768477e-17  0              1.871991e-10   2.6109412e-16  0              2.9990326    
   2500000   180            200            200            0.0029157261  -1.0949956e-37  0              0.0087471783   1.908008e-18   0              9.2130876e-12  2.6109412e-16  0              2.9990326    
   2600000   180            200            200            0.0029157261  -2.7289399e-38  0              0.0087471784   3.7946438e-18  0              1.8322977e-11  2.6109412e-16  0              2.9990326    
   2700000   180            200            200            0.0029157261   1.0964624e-37  0              0.0087471783   1.6407557e-18  0              7.9226221e-12  2.6109412e-16  0              2.9990326    
   2800000   180            200            200            0.0029157261  -2.1906602e-37  0              0.0087471783   4.8048156e-19  0              2.3200735e-12  2.6109412e-16  0              2.9990326    
   2900000   180            200            200            0.0029157261   2.2919245e-40  0              0.0087471783   1.039817e-19   0              5.0209041e-13  2.6109412e-16  0              2.9990326    
   3000000   180            200            200            0.0029157261   7.3976309e-40  0              0.0087471783   1.5184581e-19  0              7.3320908e-13  2.6109412e-16  0              2.9990326    
Loop time of 63.929 on 4 procs for 3000000 steps with 51 atoms

Performance: 40544967.511 ns/day, 0.000 hours/ns, 46927.046 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31528    | 1.9264     | 6.5415     | 192.0 |  3.01
Neigh   | 0.095192   | 0.095855   | 0.097394   |   0.3 |  0.15
Comm    | 25.534     | 32.073     | 38.257     |  83.6 | 50.17
Output  | 0.060895   | 0.060977   | 0.061041   |   0.0 |  0.10
Modify  | 15.177     | 21.121     | 28.642     | 124.1 | 33.04
Other   |            | 8.652      |            |       | 13.53

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 50

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.01                                                               
Lattice spacing in x,y,z = 6.01 6.01 6.01

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90.15 ${n1e1} -100 100 -100 100 units box
region box block -90.15 90.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.15 90.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90.15 -100 -100) to (90.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90.15 -100 -100) to (90.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90.15 -100 -100) to (90.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_50_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15 | 18.47 | 19.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   180.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   180.3          200            200            0.0024038787   1.2818444e-39  0              0.0072116361   12562.414      0              6.0659403e+10  2.6109412e-16  0              3.3185167    
    200000   180.3          200            200            0.00092310728 -4.2726549e-40  0              0.0027693218   3472.8676      0              1.6769235e+10  2.6109412e-16  0              3.0582436    
    300000   180.3          200            200            0.00021265323  6.8388944e-38  0              0.00063795969  323.89892      0              1.5639919e+09  2.6109412e-16  0              3.0396538    
    400000   180.3          200            200            7.6887388e-05  1.3691452e-38  0              0.00023066216  51.528717      0              2.4881373e+08  2.6109412e-16  0              3.0097369    
    500000   180.3          200            200           -5.8504245e-05 -2.5634669e-39  0             -0.00017551274  38.238398      0              1.8463954e+08  2.6109412e-16  0              3.000047     
    600000   180.3          200            200            0.0016309446   5.4095573e-05  0              0.0048387381   7.1499745      0              34524668       2.6109412e-16  0              2.9991968    
    700000   180.3          200            200            0.0024874744   0.00019116764  0              0.0072712555   0.991132       0              4785821.7      2.6109412e-16  0              2.9989859    
    800000   180.3          200            200            0.0033920653   0.00019089448  0              0.0099853015   0.025189292    0              121630.08      2.6109412e-16  0              2.9987802    
    900000   180.3          200            200            0.0028116788   0.00019231096  0              0.0082427253   0.00022032817  0              1063.8859      2.6109412e-16  0              2.9989083    
   1000000   180.3          200            200            0.0030263328   0.00019223335  0              0.0088867649   0.00084593879  0              4084.7357      2.6109412e-16  0              2.9988602    
   1100000   180.3          200            200            0.0029630195   0.00019231443  0              0.0086967441   0.00029019582  0              1401.2517      2.6109412e-16  0              2.9988742    
   1200000   180.3          200            200            0.0029756482   0.00019230217  0              0.0087346423   5.3716906e-05  0              259.37971      2.6109412e-16  0              2.9988714    
   1300000   180.3          200            200            0.0029758648   0.00019230182  0              0.0087352925   6.4345479e-06  0              31.070129      2.6109412e-16  0              2.9988713    
   1400000   180.3          200            200            0.002974016    0.00019230381  0              0.0087297443   4.6841089e-07  0              2.2617886      2.6109412e-16  0              2.9988718    
   1500000   180.3          200            200            0.0029752087   0.00019230255  0              0.0087333236   1.1892444e-08  0              0.057424355    2.6109412e-16  0              2.9988715    
   1600000   180.3          200            200            0.0029746708   0.00019230312  0              0.0087317093   4.2205346e-10  0              0.0020379451   2.6109412e-16  0              2.9988716    
   1700000   180.3          200            200            0.0029748649   0.00019230291  0              0.0087322917   8.0248155e-10  0              0.0038748962   2.6109412e-16  0              2.9988716    
   1800000   180.3          200            200            0.0029748094   0.00019230297  0              0.0087321253   2.5401422e-10  0              0.0012265437   2.6109412e-16  0              2.9988716    
   1900000   180.3          200            200            0.0029748198   0.00019230296  0              0.0087321565   4.4865009e-11  0              0.00021663707  2.6109412e-16  0              2.9988716    
   2000000   180.3          200            200            0.0029748204   0.00019230296  0              0.0087321584   5.1501338e-12  0              2.4868153e-05  2.6109412e-16  0              2.9988716    
   2100000   180.3          200            200            0.0029748186   0.00019230296  0              0.0087321529   3.5203294e-13  0              1.6998411e-06  2.6109412e-16  0              2.9988716    
   2200000   180.3          200            200            0.0029748197   0.00019230296  0              0.0087321563   7.2118029e-15  0              3.4823215e-08  2.6109412e-16  0              2.9988716    
   2300000   180.3          200            200            0.0029748192   0.00019230296  0              0.0087321548   5.7877814e-16  0              2.7947125e-09  2.6109412e-16  0              2.9988716    
   2400000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321553   7.4675364e-16  0              3.6058061e-09  2.6109412e-16  0              2.9988716    
   2500000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321552   2.1972318e-16  0              1.0609646e-09  2.6109412e-16  0              2.9988716    
   2600000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321552   3.7540431e-17  0              1.8126931e-10  2.6109412e-16  0              2.9988716    
   2700000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321552   4.4515754e-18  0              2.1495065e-11  2.6109412e-16  0              2.9988716    
   2800000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321552   3.646541e-19   0              1.7607842e-12  2.6109412e-16  0              2.9988716    
   2900000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321552   1.4972104e-20  0              7.229493e-14   2.6109412e-16  0              2.9988716    
   3000000   180.3          200            200            0.0029748194   0.00019230296  0              0.0087321552   5.8711475e-20  0              2.834967e-13   2.6109412e-16  0              2.9988716    
Loop time of 64.1557 on 4 procs for 3000000 steps with 51 atoms

Performance: 40401733.302 ns/day, 0.000 hours/ns, 46761.265 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28637    | 1.9358     | 6.6043     | 193.8 |  3.02
Neigh   | 0.095239   | 0.095812   | 0.097447   |   0.3 |  0.15
Comm    | 25.575     | 32.202     | 38.413     |  84.1 | 50.19
Output  | 0.063358   | 0.063442   | 0.063506   |   0.0 |  0.10
Modify  | 15.17      | 21.158     | 28.794     | 125.2 | 32.98
Other   |            | 8.701      |            |       | 13.56

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 51

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.02                                                               
Lattice spacing in x,y,z = 6.02 6.02 6.02

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90.3 ${n1e1} -100 100 -100 100 units box
region box block -90.3 90.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.3 90.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90.3 -100 -100) to (90.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90.3 -100 -100) to (90.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90.3 -100 -100) to (90.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_51_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15 | 18.47 | 19.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   180.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   180.6          200            200            0.0023992493   3.4127554e-39  0              0.0071977478   12558.407      0              6.0640054e+10  2.6109412e-16  0              3.3183332    
    200000   180.6          200            200            0.00092144479  1.7065615e-38  0              0.0027643344   3472.7361      0              1.67686e+10    2.6109412e-16  0              3.0577064    
    300000   180.6          200            200            0.00021303342 -1.3631244e-37  0              0.00063910027  325.96006      0              1.5739445e+09  2.6109412e-16  0              3.0390487    
    400000   180.6          200            200            7.5568769e-05 -3.8137733e-37  0              0.00022670631  50.045186      0              2.416503e+08   2.6109412e-16  0              3.0093526    
    500000   180.6          200            200            0.0055656737   0.0011181212   0              0.0155789      48.525094      0              2.3431031e+08  2.6109412e-16  0              2.9979633    
    600000   180.6          200            200            0.00095233255  9.1863538e-05  0              0.0027651341   2.8583353      0              13801878       2.6109412e-16  0              2.9991412    
    700000   180.6          200            200            0.003090435    0.00026334552  0              0.0090079594   1.077789       0              5204257.4      2.6109412e-16  0              2.9984639    
    800000   180.6          200            200            0.0027485362   0.00027931938  0              0.0079662893   0.086284969    0              416639.23      2.6109412e-16  0              2.9985529    
    900000   180.6          200            200            0.0031439355   0.00028729023  0              0.0091445163   0.00072325745  0              3492.3514      2.6109412e-16  0              2.9984494    
   1000000   180.6          200            200            0.0029550283   0.00028399932  0              0.0085810855   0.00072212254  0              3486.8713      2.6109412e-16  0              2.9984986    
   1100000   180.6          200            200            0.0030058215   0.00028498681  0              0.0087324778   0.00033522872  0              1618.6995      2.6109412e-16  0              2.9984852    
   1200000   180.6          200            200            0.0030037228   0.00028494278  0              0.0087262255   3.9370201e-05  0              190.10461      2.6109412e-16  0              2.9984858    
   1300000   180.6          200            200            0.0029979842   0.00028483705  0              0.0087091157   8.4702826e-07  0              4.0899963      2.6109412e-16  0              2.9984873    
   1400000   180.6          200            200            0.0030013782   0.00028490045  0              0.0087192342   1.22814e-07    0              0.59302487     2.6109412e-16  0              2.9984864    
   1500000   180.6          200            200            0.003000317    0.00028488048  0              0.0087160705   9.8772727e-08  0              0.47693815     2.6109412e-16  0              2.9984867    
   1600000   180.6          200            200            0.0030004324   0.00028488273  0              0.0087164144   1.5069865e-08  0              0.072766986    2.6109412e-16  0              2.9984866    
   1700000   180.6          200            200            0.0030005135   0.00028488422  0              0.0087166562   5.7349599e-10  0              0.0027692069   2.6109412e-16  0              2.9984866    
   1800000   180.6          200            200            0.0030004539   0.00028488311  0              0.0087164787   1.3267041e-11  0              6.4061794e-05  2.6109412e-16  0              2.9984866    
   1900000   180.6          200            200            0.0030004752   0.00028488351  0              0.0087165421   2.7167969e-11  0              0.0001311844   2.6109412e-16  0              2.9984866    
   2000000   180.6          200            200            0.0030004717   0.00028488344  0              0.0087165318   5.4263371e-12  0              2.620184e-05   2.6109412e-16  0              2.9984866    
   2100000   180.6          200            200            0.0030004707   0.00028488342  0              0.0087165288   3.0925575e-13  0              1.4932853e-06  2.6109412e-16  0              2.9984866    
   2200000   180.6          200            200            0.0030004718   0.00028488344  0              0.0087165318   1.9517884e-16  0              9.4244875e-10  2.6109412e-16  0              2.9984866    
   2300000   180.6          200            200            0.0030004713   0.00028488343  0              0.0087165306   6.8530612e-15  0              3.309098e-08   2.6109412e-16  0              2.9984866    
   2400000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165308   1.8441103e-15  0              8.9045487e-09  2.6109412e-16  0              2.9984866    
   2500000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165309   1.47525e-16    0              7.1234541e-10  2.6109412e-16  0              2.9984866    
   2600000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165308   7.4449631e-19  0              3.5949062e-12  2.6109412e-16  0              2.9984866    
   2700000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165308   2.528979e-18   0              1.2211535e-11  2.6109412e-16  0              2.9984866    
   2800000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165308   5.7365938e-20  0              2.7699958e-13  2.6109412e-16  0              2.9984866    
   2900000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165308   8.3725986e-20  0              4.0428282e-13  2.6109412e-16  0              2.9984866    
   3000000   180.6          200            200            0.0030004714   0.00028488344  0              0.0087165308   1.1347294e-19  0              5.4792022e-13  2.6109412e-16  0              2.9984866    
Loop time of 64.0977 on 4 procs for 3000000 steps with 51 atoms

Performance: 40438271.439 ns/day, 0.000 hours/ns, 46803.555 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29443    | 1.8903     | 6.4071     | 189.7 |  2.95
Neigh   | 0.095256   | 0.095838   | 0.097436   |   0.3 |  0.15
Comm    | 25.638     | 32.278     | 38.45      |  84.1 | 50.36
Output  | 0.061295   | 0.061376   | 0.061437   |   0.0 |  0.10
Modify  | 15.086     | 21.116     | 28.773     | 125.5 | 32.94
Other   |            | 8.657      |            |       | 13.51

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 52

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.03                                                               
Lattice spacing in x,y,z = 6.03 6.03 6.03

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90.45 ${n1e1} -100 100 -100 100 units box
region box block -90.45 90.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.45 90.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90.45 -100 -100) to (90.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90.45 -100 -100) to (90.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90.45 -100 -100) to (90.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_52_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15 | 18.47 | 19.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   180.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   180.9          200            200            0.0023941794   1.7036636e-38  0              0.0071825383   12551.162      0              6.0605067e+10  2.6109412e-16  0              3.3181559    
    200000   180.9          200            200            0.00091882988 -4.0801907e-38  0              0.0027564897   3467.1754      0              1.6741749e+10  2.6109412e-16  0              3.0572275    
    300000   180.9          200            200            0.00021033627  5.1108822e-39  0              0.0006310088   319.75264      0              1.543971e+09   2.6109412e-16  0              3.0386472    
    400000   180.9          200            200            5.9251146e-05  1.7035104e-39  0              0.00017775344  31.661798      0              1.5288349e+08  2.6109412e-16  0              3.0096491    
    500000   180.9          200            200            0.00024599426  9.0105014e-10  0              0.00073798187  33.34954       0              1.6103299e+08  2.6109412e-16  0              2.9995358    
    600000   180.9          200            200            0.0055641091   0.00051007697  0              0.01618225     1.3366687      0              6454294.6      2.6109412e-16  0              2.9974616    
    700000   180.9          200            200            0.002080509    0.00018614029  0              0.0060553868   0.0010756696   0              5194.0235      2.6109412e-16  0              2.9984489    
    800000   180.9          200            200            0.0028975161   0.0002528441   0              0.0084397042   0.12470928     0              602176.46      2.6109412e-16  0              2.998175     
    900000   180.9          200            200            0.0030829867   0.00025641114  0              0.0089925489   0.0072276921   0              34899.938      2.6109412e-16  0              2.9981177    
   1000000   180.9          200            200            0.0030279582   0.00025541022  0              0.0088284645   0.00039428785  0              1903.8749      2.6109412e-16  0              2.9981351    
   1100000   180.9          200            200            0.002986447    0.00025461725  0              0.0087047237   0.00032838301  0              1585.644       2.6109412e-16  0              2.9981481    
   1200000   180.9          200            200            0.0029798776   0.00025449054  0              0.0086851422   1.2070032e-05  0              58.281867      2.6109412e-16  0              2.9981501    
   1300000   180.9          200            200            0.0029832441   0.00025455824  0              0.008695174    1.6133924e-06  0              7.7904943      2.6109412e-16  0              2.998149     
   1400000   180.9          200            200            0.0029852794   0.00025459832  0              0.0087012398   8.1374565e-07  0              3.9292865      2.6109412e-16  0              2.9981484    
   1500000   180.9          200            200            0.0029855158   0.00025460281  0              0.0087019447   1.8176276e-08  0              0.087766732    2.6109412e-16  0              2.9981483    
   1600000   180.9          200            200            0.0029853208   0.00025459893  0              0.0087013635   5.8092724e-09  0              0.028050897    2.6109412e-16  0              2.9981484    
   1700000   180.9          200            200            0.0029852225   0.000254597    0              0.0087010705   1.9496493e-09  0              0.0094141589   2.6109412e-16  0              2.9981484    
   1800000   180.9          200            200            0.0029852155   0.00025459687  0              0.0087010496   2.2086502e-11  0              0.00010664781  2.6109412e-16  0              2.9981484    
   1900000   180.9          200            200            0.0029852264   0.00025459708  0              0.0087010821   1.9153765e-11  0              9.2486679e-05  2.6109412e-16  0              2.9981484    
   2000000   180.9          200            200            0.002985231    0.00025459717  0              0.008701096    4.5106169e-12  0              2.1780155e-05  2.6109412e-16  0              2.9981484    
   2100000   180.9          200            200            0.0029852312   0.00025459718  0              0.0087010963   1.6887624e-14  0              8.1544291e-08  2.6109412e-16  0              2.9981484    
   2200000   180.9          200            200            0.0029852306   0.00025459716  0              0.0087010945   5.9141534e-14  0              2.855733e-07   2.6109412e-16  0              2.9981484    
   2300000   180.9          200            200            0.0029852303   0.00025459716  0              0.0087010939   1.0060077e-14  0              4.8576511e-08  2.6109412e-16  0              2.9981484    
   2400000   180.9          200            200            0.0029852303   0.00025459716  0              0.0087010939   1.5383573e-18  0              7.4281766e-12  2.6109412e-16  0              2.9981484    
   2500000   180.9          200            200            0.0029852304   0.00025459716  0              0.008701094    1.7339112e-16  0              8.3724366e-10  2.6109412e-16  0              2.9981484    
   2600000   180.9          200            200            0.0029852304   0.00025459716  0              0.008701094    2.0749652e-17  0              1.0019265e-10  2.6109412e-16  0              2.9981484    
   2700000   180.9          200            200            0.0029852304   0.00025459716  0              0.008701094    1.1753902e-19  0              5.6755386e-13  2.6109412e-16  0              2.9981484    
   2800000   180.9          200            200            0.0029852304   0.00025459716  0              0.008701094    4.9049038e-19  0              2.3684025e-12  2.6109412e-16  0              2.9981484    
   2900000   180.9          200            200            0.0029852304   0.00025459716  0              0.008701094    5.0809807e-20  0              2.4534238e-13  2.6109412e-16  0              2.9981484    
   3000000   180.9          200            200            0.0029852304   0.00025459716  0              0.008701094    2.31281e-20    0              1.1167732e-13  2.6109412e-16  0              2.9981484    
Loop time of 64.1542 on 4 procs for 3000000 steps with 51 atoms

Performance: 40402629.842 ns/day, 0.000 hours/ns, 46762.303 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31145    | 1.7888     | 6.0008     | 181.9 |  2.79
Neigh   | 0.095252   | 0.095835   | 0.097455   |   0.3 |  0.15
Comm    | 25.765     | 32.285     | 38.336     |  83.1 | 50.32
Output  | 0.061118   | 0.0612     | 0.061263   |   0.0 |  0.10
Modify  | 15.234     | 21.154     | 28.567     | 122.9 | 32.97
Other   |            | 8.769      |            |       | 13.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 172
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 53

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.04                                                               
Lattice spacing in x,y,z = 6.04 6.04 6.04

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90.6 ${n1e1} -100 100 -100 100 units box
region box block -90.6 90.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.6 90.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90.6 -100 -100) to (90.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90.6 -100 -100) to (90.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90.6 -100 -100) to (90.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_53_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 117 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15 | 18.47 | 19.62 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   181.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   181.2          200            200            0.0023886613  -1.7002616e-39  0              0.007165984    12540.389      0              6.055305e+10   2.6109412e-16  0              3.3180675    
    200000   181.2          200            200            0.00091466102  1.8013577e-42  0              0.0027439831   3452.4471      0              1.6670632e+10  2.6109412e-16  0              3.0571228    
    300000   181.2          200            200            0.00020194226 -3.400645e-39   0              0.00060582679  298.49887      0              1.4413442e+09  2.6109412e-16  0              3.0389217    
    400000   181.2          200            200            2.6017321e-05 -8.5021505e-39  0              7.8051962e-05  6.4822293      0              31300365       2.6109412e-16  0              3.0102855    
    500000   181.2          200            200            7.1408166e-05  5.4520644e-06  0              0.00020877243  25.427202      0              1.2277886e+08  2.6109412e-16  0              2.999565     
    600000   181.2          200            200            0.0033227677   0.00031735772  0              0.0096509453   6.5119671      0              31443959       2.6109412e-16  0              2.9977307    
    700000   181.2          200            200            0.0027287856   0.00022865743  0              0.0079576993   0.81237719     0              3922678.7      2.6109412e-16  0              2.9979526    
    800000   181.2          200            200            0.0028391596   0.0002305228   0              0.008286956    0.096590167    0              466399.35      2.6109412e-16  0              2.9979117    
    900000   181.2          200            200            0.0028986563   0.00023147037  0              0.0084644985   0.0088220346   0              42598.448      2.6109412e-16  0              2.9978895    
   1000000   181.2          200            200            0.0029380683   0.00023208155  0              0.0085821235   0.00055314536  0              2670.941       2.6109412e-16  0              2.9978746    
   1100000   181.2          200            200            0.0029584315   0.00023239099  0              0.0086429034   1.4066116e-05  0              67.920239      2.6109412e-16  0              2.9978668    
   1200000   181.2          200            200            0.0029674279   0.00023252644  0              0.0086697572   3.0879674e-07  0              1.491069       2.6109412e-16  0              2.9978634    
   1300000   181.2          200            200            0.0029709851   0.00023257989  0              0.0086803755   8.0590864e-07  0              3.8914444      2.6109412e-16  0              2.997862     
   1400000   181.2          200            200            0.0029722631   0.00023259912  0              0.0086841901   3.0759087e-07  0              1.4852462      2.6109412e-16  0              2.9978615    
   1500000   181.2          200            200            0.0029726782   0.00023260539  0              0.0086854291   7.1609594e-08  0              0.3457771      2.6109412e-16  0              2.9978614    
   1600000   181.2          200            200            0.0029727965   0.00023260719  0              0.0086857822   1.2697507e-08  0              0.061311718    2.6109412e-16  0              2.9978613    
   1700000   181.2          200            200            0.0029728233   0.0002326076   0              0.0086858622   1.835379e-09   0              0.0088623882   2.6109412e-16  0              2.9978613    
   1800000   181.2          200            200            0.0029728261   0.00023260765  0              0.0086858705   2.1925131e-10  0              0.0010586861   2.6109412e-16  0              2.9978613    
   1900000   181.2          200            200            0.0029728244   0.00023260762  0              0.0086858656   2.1074246e-11  0              0.00010175999  2.6109412e-16  0              2.9978613    
   2000000   181.2          200            200            0.0029728229   0.0002326076   0              0.008685861    1.480951e-12   0              7.1509826e-06  2.6109412e-16  0              2.9978613    
   2100000   181.2          200            200            0.002972822    0.00023260759  0              0.0086858584   5.4038567e-14  0              2.609329e-07   2.6109412e-16  0              2.9978613    
   2200000   181.2          200            200            0.0029728216   0.00023260758  0              0.0086858572   2.068648e-18   0              9.988761e-12   2.6109412e-16  0              2.9978613    
   2300000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858568   1.0519055e-15  0              5.0792753e-09  2.6109412e-16  0              2.9978613    
   2400000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858566   5.0469489e-16  0              2.436991e-09   2.6109412e-16  0              2.9978613    
   2500000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858565   1.2942799e-16  0              6.2496145e-10  2.6109412e-16  0              2.9978613    
   2600000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858565   2.5140132e-17  0              1.213927e-10   2.6109412e-16  0              2.9978613    
   2700000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858565   3.8501027e-18  0              1.8590768e-11  2.6109412e-16  0              2.9978613    
   2800000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858565   2.5299872e-19  0              1.2216403e-12  2.6109412e-16  0              2.9978613    
   2900000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858565   7.4755035e-20  0              3.6096531e-13  2.6109412e-16  0              2.9978613    
   3000000   181.2          200            200            0.0029728214   0.00023260758  0              0.0086858565   1.5021898e-20  0              7.2535368e-14  2.6109412e-16  0              2.9978613    
Loop time of 64.1857 on 4 procs for 3000000 steps with 51 atoms

Performance: 40382803.642 ns/day, 0.000 hours/ns, 46739.356 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31072    | 1.7322     | 5.7627     | 176.9 |  2.70
Neigh   | 0.092898   | 0.093507   | 0.095127   |   0.3 |  0.15
Comm    | 25.707     | 32.427     | 38.382     |  84.7 | 50.52
Output  | 0.062555   | 0.062634   | 0.062695   |   0.0 |  0.10
Modify  | 15.206     | 21.153     | 28.669     | 124.0 | 32.96
Other   |            | 8.717      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 54

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.05                                                               
Lattice spacing in x,y,z = 6.05 6.05 6.05

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90.75 ${n1e1} -100 100 -100 100 units box
region box block -90.75 90.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.75 90.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90.75 -100 -100) to (90.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90.75 -100 -100) to (90.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90.75 -100 -100) to (90.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_54_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 118 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.02 | 18.49 | 19.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   181.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   181.5          200            200            0.0023826986   3.3976019e-39  0              0.0071480957   12525.896      0              6.0483067e+10  2.6109412e-16  0              3.3181461    
    200000   181.5          200            200            0.00090847449 -1.5279668e-38  0              0.0027254235   3425.6416      0              1.6541198e+10  2.6109412e-16  0              3.0576671    
    300000   181.5          200            200            0.00018798138  6.7916321e-39  0              0.00056394414  263.66762      0              1.2731566e+09  2.6109412e-16  0              3.0399145    
    400000   181.5          200            200           -7.9093655e-06 -8.4858409e-40  0             -2.3728096e-05  0.6267326      0              3026267.4      2.6109412e-16  0              3.0100614    
    500000   181.5          200            200            0.0074422942   0.00062600429  0              0.021700878    24.088727      0              1.1631584e+08  2.6109412e-16  0              2.9962054    
    600000   181.5          200            200            0.0020279461   0.00012829996  0              0.0059555383   5.1009537      0              24630680       2.6109412e-16  0              2.9980119    
    700000   181.5          200            200            0.0037603921   0.00026881346  0              0.011012363    0.045332911    0              218896.41      2.6109412e-16  0              2.997313     
    800000   181.5          200            200            0.002729139    0.00022582697  0              0.00796159     0.034121226    0              164759.19      2.6109412e-16  0              2.9977065    
    900000   181.5          200            200            0.0030160355   0.00023245266  0              0.0088156538   0.012493305    0              60325.697      2.6109412e-16  0              2.9975901    
   1000000   181.5          200            200            0.0029691002   0.00023149494  0              0.0086758057   0.0021533501   0              10397.757      2.6109412e-16  0              2.9976093    
   1100000   181.5          200            200            0.0029596385   0.00023131517  0              0.0086476003   0.00020683057  0              998.71078      2.6109412e-16  0              2.9976128    
   1200000   181.5          200            200            0.002972111    0.00023156526  0              0.0086847677   8.1376627e-06  0              39.293861      2.6109412e-16  0              2.9976079    
   1300000   181.5          200            200            0.0029654857   0.00023143148  0              0.0086650256   1.8721734e-08  0              0.090400554    2.6109412e-16  0              2.9976105    
   1400000   181.5          200            200            0.0029680029   0.00023148279  0              0.0086725258   2.2350306e-07  0              1.0792163      2.6109412e-16  0              2.9976095    
   1500000   181.5          200            200            0.0029673017   0.00023146838  0              0.0086704368   7.9241087e-08  0              0.38262685     2.6109412e-16  0              2.9976098    
   1600000   181.5          200            200            0.0029674061   0.00023147059  0              0.0086707476   1.3150861e-08  0              0.063500803    2.6109412e-16  0              2.9976098    
   1700000   181.5          200            200            0.0029674347   0.00023147114  0              0.008670833    1.2031619e-09  0              0.0058096381   2.6109412e-16  0              2.9976098    
   1800000   181.5          200            200            0.0029674024   0.00023147049  0              0.0086707367   4.2194663e-11  0              0.00020374293  2.6109412e-16  0              2.9976098    
   1900000   181.5          200            200            0.002967419    0.00023147083  0              0.0086707863   3.2620141e-13  0              1.5751099e-06  2.6109412e-16  0              2.9976098    
   2000000   181.5          200            200            0.0029674129   0.0002314707   0              0.0086707679   1.5411668e-12  0              7.4417429e-06  2.6109412e-16  0              2.9976098    
   2100000   181.5          200            200            0.0029674145   0.00023147074  0              0.0086707729   5.0485187e-13  0              2.437749e-06   2.6109412e-16  0              2.9976098    
   2200000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707722   8.0110115e-14  0              3.8682308e-07  2.6109412e-16  0              2.9976098    
   2300000   181.5          200            200            0.0029674142   0.00023147073  0              0.0086707719   6.9670423e-15  0              3.3641354e-08  2.6109412e-16  0              2.9976098    
   2400000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707722   2.1822292e-16  0              1.0537204e-09  2.6109412e-16  0              2.9976098    
   2500000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707721   3.8938919e-18  0              1.880221e-11   2.6109412e-16  0              2.9976098    
   2600000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707721   1.1366238e-17  0              5.4883495e-11  2.6109412e-16  0              2.9976098    
   2700000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707721   3.1091497e-18  0              1.5012971e-11  2.6109412e-16  0              2.9976098    
   2800000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707721   1.2587119e-19  0              6.0778691e-13  2.6109412e-16  0              2.9976098    
   2900000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707721   8.5841839e-21  0              4.1449952e-14  2.6109412e-16  0              2.9976098    
   3000000   181.5          200            200            0.0029674143   0.00023147073  0              0.0086707721   1.5699468e-19  0              7.5807114e-13  2.6109412e-16  0              2.9976098    
Loop time of 64.0594 on 4 procs for 3000000 steps with 51 atoms

Performance: 40462443.727 ns/day, 0.000 hours/ns, 46831.532 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29336    | 1.7059     | 5.6754     | 175.5 |  2.66
Neigh   | 0.09377    | 0.094417   | 0.095946   |   0.3 |  0.15
Comm    | 25.622     | 32.406     | 38.387     |  85.2 | 50.59
Output  | 0.061306   | 0.061388   | 0.061452   |   0.0 |  0.10
Modify  | 15.137     | 21.105     | 28.686     | 124.6 | 32.95
Other   |            | 8.686      |            |       | 13.56

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 55

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.06                                                               
Lattice spacing in x,y,z = 6.06 6.06 6.06

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -90.9 ${n1e1} -100 100 -100 100 units box
region box block -90.9 90.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -90.9 90.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-90.9 -100 -100) to (90.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-90.9 -100 -100) to (90.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-90.9 -100 -100) to (90.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_55_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 118 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.02 | 18.49 | 19.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   181.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   181.8          200            200            0.0023763137   3.3905036e-39  0              0.007128941    12507.654      0              6.0394984e+10  2.6109412e-16  0              3.318458     
    200000   181.8          200            200            0.00090024984 -1.6945482e-38  0              0.0027007495   3386.5555      0              1.6352465e+10  2.6109412e-16  0              3.0589658    
    300000   181.8          200            200            0.00017317289 -5.0844744e-39  0              0.00051951867  228.42741      0              1.1029942e+09  2.6109412e-16  0              3.041        
    400000   181.8          200            200           -3.7159645e-05  6.7825017e-39  0             -0.00011147893  14.885831      0              71878350       2.6109412e-16  0              3.0089451    
    500000   181.8          200            200            1.6816567e-05 -1.3526089e-38  0              5.0449702e-05  2.7945096      0              13493687       2.6109412e-16  0              3.0001901    
    600000   181.8          200            200            0.0014008838   0.00012927383  0              0.0040733776   0.88149685     0              4256432.8      2.6109412e-16  0              2.9982159    
    700000   181.8          200            200            0.0030221987   0.00020308483  0              0.0088635112   0.82433369     0              3980412.4      2.6109412e-16  0              2.9973114    
    800000   181.8          200            200            0.002690274    0.00016676593  0              0.0079040561   0.007534275    0              36380.317      2.6109412e-16  0              2.997459     
    900000   181.8          200            200            0.0029678857   0.00018381516  0              0.0087198421   0.014402636    0              69545.176      2.6109412e-16  0              2.9973366    
   1000000   181.8          200            200            0.0029717091   0.0001839186   0              0.0087312087   0.0010192194   0              4921.4457      2.6109412e-16  0              2.9973343    
   1100000   181.8          200            200            0.0029334574   0.00018314904  0              0.0086172231   1.3159617e-05  0              63.54308       2.6109412e-16  0              2.9973511    
   1200000   181.8          200            200            0.0029480624   0.00018344829  0              0.0086607389   3.3029382e-05  0              159.48707      2.6109412e-16  0              2.9973448    
   1300000   181.8          200            200            0.0029474498   0.0001834375   0              0.0086589119   3.194774e-06   0              15.42642       2.6109412e-16  0              2.997345     
   1400000   181.8          200            200            0.0029457156   0.00018340193  0              0.0086537447   4.7219686e-09  0              0.022800697    2.6109412e-16  0              2.9973458    
   1500000   181.8          200            200            0.0029464864   0.00018341753  0              0.0086560418   7.2411045e-08  0              0.34964702     2.6109412e-16  0              2.9973454    
   1600000   181.8          200            200            0.0029464154   0.00018341617  0              0.0086558299   9.4918295e-09  0              0.045832648    2.6109412e-16  0              2.9973454    
   1700000   181.8          200            200            0.0029463392   0.0001834146   0              0.0086556031   4.9676322e-12  0              2.3986918e-05  2.6109412e-16  0              2.9973455    
   1800000   181.8          200            200            0.0029463791   0.0001834154   0              0.0086557218   1.5126194e-10  0              0.00073038977  2.6109412e-16  0              2.9973455    
   1900000   181.8          200            200            0.0029463736   0.0001834153   0              0.0086557054   2.6826282e-11  0              0.00012953452  2.6109412e-16  0              2.9973455    
   2000000   181.8          200            200            0.0029463704   0.00018341523  0              0.0086556958   1.5211734e-13  0              7.3452018e-07  2.6109412e-16  0              2.9973455    
   2100000   181.8          200            200            0.0029463724   0.00018341527  0              0.0086557018   2.9828954e-13  0              1.4403334e-06  2.6109412e-16  0              2.9973455    
   2200000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557008   7.2559446e-14  0              3.5036359e-07  2.6109412e-16  0              2.9973455    
   2300000   181.8          200            200            0.0029463719   0.00018341526  0              0.0086557004   1.0916076e-15  0              5.2709823e-09  2.6109412e-16  0              2.9973455    
   2400000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557007   5.3812356e-16  0              2.5984061e-09  2.6109412e-16  0              2.9973455    
   2500000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557006   1.8859409e-16  0              9.1065337e-10  2.6109412e-16  0              2.9973455    
   2600000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557006   5.2209342e-18  0              2.5210023e-11  2.6109412e-16  0              2.9973455    
   2700000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557006   1.6259332e-18  0              7.8510496e-12  2.6109412e-16  0              2.9973455    
   2800000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557006   4.4408183e-20  0              2.1443122e-13  2.6109412e-16  0              2.9973455    
   2900000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557006   6.5473071e-20  0              3.1614603e-13  2.6109412e-16  0              2.9973455    
   3000000   181.8          200            200            0.002946372    0.00018341526  0              0.0086557006   2.2810917e-20  0              1.1014576e-13  2.6109412e-16  0              2.9973455    
Loop time of 64.0132 on 4 procs for 3000000 steps with 51 atoms

Performance: 40491654.552 ns/day, 0.000 hours/ns, 46865.341 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31556    | 1.6781     | 5.5581     | 173.0 |  2.62
Neigh   | 0.093859   | 0.094398   | 0.09595    |   0.3 |  0.15
Comm    | 25.707     | 32.278     | 38.197     |  83.9 | 50.42
Output  | 0.061695   | 0.061775   | 0.06184    |   0.0 |  0.10
Modify  | 15.228     | 21.147     | 28.473     | 122.4 | 33.04
Other   |            | 8.754      |            |       | 13.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 56

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.07                                                               
Lattice spacing in x,y,z = 6.07 6.07 6.07

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.05 ${n1e1} -100 100 -100 100 units box
region box block -91.05 91.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.05 91.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.05 -100 -100) to (91.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-91.05 -100 -100) to (91.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.05 -100 -100) to (91.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_56_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 118 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.02 | 18.49 | 19.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   182.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   182.1          200            200            0.0023695636   6.7711013e-38  0              0.0071086909   12485.954      0              6.6989113e+10  2.6109412e-16  0              3.3190435    
    200000   182.1          200            200            0.0008910911  -6.7543896e-39  0              0.0026732733   3341.7827      0              1.7929192e+10  2.6109412e-16  0              3.0606804    
    300000   182.1          200            200            0.00015901418  6.7693964e-39  0              0.00047704255  196.56294      0              1.0545912e+09  2.6109412e-16  0              3.0419803    
    400000   182.1          200            200           -6.464427e-05   1.0153692e-38  0             -0.00019393281  48.102183      0              2.5807581e+08  2.6109412e-16  0              3.0069982    
    500000   182.1          200            200            0.0010756723   9.6485878e-05  0              0.0031305309   33.636097      0              1.8046297e+08  2.6109412e-16  0              2.9982763    
    600000   182.1          200            200            0.0039689406   0.00022398066  0              0.011682841    3.7707482      0              20230660       2.6109412e-16  0              2.9966518    
    700000   182.1          200            200            0.0033937185   0.00019183909  0              0.0099893166   0.37283        0              2000291.8      2.6109412e-16  0              2.9969324    
    800000   182.1          200            200            0.0031470046   0.00018968981  0              0.0092513241   0.02257646     0              121126.28      2.6109412e-16  0              2.9970619    
    900000   182.1          200            200            0.0030248047   0.00018846943  0              0.0088859446   0.00090939676  0              4879.0572      2.6109412e-16  0              2.9971268    
   1000000   182.1          200            200            0.0029739936   0.00018792964  0              0.0087340512   2.8081337e-06  0              15.066081      2.6109412e-16  0              2.9971539    
   1100000   182.1          200            200            0.002954134    0.0001877137   0              0.0086746881   8.1386848e-06  0              43.665329      2.6109412e-16  0              2.9971645    
   1200000   182.1          200            200            0.0029467397   0.00018763273  0              0.0086525864   5.1729392e-06  0              27.753636      2.6109412e-16  0              2.9971684    
   1300000   182.1          200            200            0.0029441141   0.00018760397  0              0.0086447384   1.5565401e-06  0              8.3510834      2.6109412e-16  0              2.9971698    
   1400000   182.1          200            200            0.0029432284   0.00018759429  0              0.008642091    3.4621399e-07  0              1.8574927      2.6109412e-16  0              2.9971703    
   1500000   182.1          200            200            0.0029429475   0.00018759123  0              0.0086412513   6.4426963e-08  0              0.34566083     2.6109412e-16  0              2.9971705    
   1600000   182.1          200            200            0.0029428656   0.00018759035  0              0.0086410064   1.0547579e-08  0              0.056589426    2.6109412e-16  0              2.9971705    
   1700000   182.1          200            200            0.0029428447   0.00018759012  0              0.008640944    1.5542009e-09  0              0.008338533    2.6109412e-16  0              2.9971705    
   1800000   182.1          200            200            0.0029428408   0.00018759008  0              0.0086409324   2.0794631e-10  0              0.0011156648   2.6109412e-16  0              2.9971705    
   1900000   182.1          200            200            0.0029428409   0.00018759009  0              0.0086409325   2.5235989e-11  0              0.00013539507  2.6109412e-16  0              2.9971705    
   2000000   182.1          200            200            0.0029428414   0.00018759009  0              0.0086409341   2.7457115e-12  0              1.4731176e-05  2.6109412e-16  0              2.9971705    
   2100000   182.1          200            200            0.0029428418   0.0001875901   0              0.0086409353   2.6056067e-13  0              1.3979491e-06  2.6109412e-16  0              2.9971705    
   2200000   182.1          200            200            0.002942842    0.0001875901   0              0.0086409359   2.029102e-14   0              1.0886452e-07  2.6109412e-16  0              2.9971705    
   2300000   182.1          200            200            0.0029428421   0.0001875901   0              0.0086409362   1.1064924e-15  0              5.9365066e-09  2.6109412e-16  0              2.9971705    
   2400000   182.1          200            200            0.0029428421   0.0001875901   0              0.0086409363   1.9614737e-17  0              1.0523616e-10  2.6109412e-16  0              2.9971705    
   2500000   182.1          200            200            0.0029428422   0.0001875901   0              0.0086409364   1.365379e-18   0              7.3254738e-12  2.6109412e-16  0              2.9971705    
   2600000   182.1          200            200            0.0029428422   0.0001875901   0              0.0086409364   2.449647e-18   0              1.3142743e-11  2.6109412e-16  0              2.9971705    
   2700000   182.1          200            200            0.0029428422   0.0001875901   0              0.0086409364   1.7348079e-18  0              9.3075182e-12  2.6109412e-16  0              2.9971705    
   2800000   182.1          200            200            0.0029428422   0.0001875901   0              0.0086409364   2.6825289e-19  0              1.4392191e-12  2.6109412e-16  0              2.9971705    
   2900000   182.1          200            200            0.0029428422   0.0001875901   0              0.0086409364   1.6685075e-19  0              8.9518061e-13  2.6109412e-16  0              2.9971705    
   3000000   182.1          200            200            0.0029428422   0.0001875901   0              0.0086409364   1.3100265e-19  0              7.0284988e-13  2.6109412e-16  0              2.9971705    
Loop time of 63.1503 on 4 procs for 3000000 steps with 50 atoms

Performance: 41044964.558 ns/day, 0.000 hours/ns, 47505.746 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32897    | 1.6213     | 5.3261     | 168.0 |  2.57
Neigh   | 0.09389    | 0.094436   | 0.095959   |   0.3 |  0.15
Comm    | 25.042     | 31.655     | 37.403     |  84.5 | 50.13
Output  | 0.062637   | 0.062717   | 0.062781   |   0.0 |  0.10
Modify  | 15.162     | 21.035     | 28.379     | 121.6 | 33.31
Other   |            | 8.682      |            |       | 13.75

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.62
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 57

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.08                                                               
Lattice spacing in x,y,z = 6.08 6.08 6.08

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.2 ${n1e1} -100 100 -100 100 units box
region box block -91.2 91.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.2 91.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.2 -100 -100) to (91.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-91.2 -100 -100) to (91.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.2 -100 -100) to (91.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_57_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 118 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.02 | 18.49 | 19.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   182.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   182.4          200            200            0.002362574   -1.6891902e-38  0              0.007087722    12461.739      0              6.017328e+10   2.6109412e-16  0              3.3198803    
    200000   182.4          200            200            0.00088202947 -3.3762111e-39  0              0.0026460884   3297.5042      0              1.5922468e+10  2.6109412e-16  0              3.0624417    
    300000   182.4          200            200            0.00014590877  2.1117693e-40  0              0.0004377263   168.76451      0              8.1490343e+08  2.6109412e-16  0              3.0428049    
    400000   182.4          200            200           -8.6213047e-05  3.2823547e-37  0             -0.00025863914  90.558013      0              4.3727224e+08  2.6109412e-16  0              3.0046745    
    500000   182.4          200            200            0.0081496858   0.00065178894  0              0.023797268    5.980868       0              28879471       2.6109412e-16  0              2.9949339    
    600000   182.4          200            200            0.0033163681   0.00024898316  0              0.0097001211   5.3230512      0              25703109       2.6109412e-16  0              2.9968139    
    700000   182.4          200            200            0.0035558436   0.00021473485  0              0.010452796    0.05354997     0              258573.64      2.6109412e-16  0              2.9966961    
    800000   182.4          200            200            0.0031604293   0.0002107732   0              0.0092705146   0.013208083    0              63777.108      2.6109412e-16  0              2.996901     
    900000   182.4          200            200            0.0029947307   0.00020873576  0              0.0087754562   0.0090624774   0              43759.46       2.6109412e-16  0              2.9969886    
   1000000   182.4          200            200            0.0029468469   0.00020810507  0              0.0086324356   0.0018646793   0              9003.869       2.6109412e-16  0              2.997014     
   1100000   182.4          200            200            0.0029393226   0.00020800693  0              0.0086099608   0.00019336295  0              933.68047      2.6109412e-16  0              2.9970179    
   1200000   182.4          200            200            0.0029411169   0.00020803294  0              0.0086153179   7.7371565e-06  0              37.35996       2.6109412e-16  0              2.9970169    
   1300000   182.4          200            200            0.0029432498   0.00020806236  0              0.0086216872   2.4612729e-08  0              0.11884606     2.6109412e-16  0              2.9970157    
   1400000   182.4          200            200            0.0029443302   0.00020807708  0              0.0086249134   2.2441853e-07  0              1.0836368      2.6109412e-16  0              2.9970151    
   1500000   182.4          200            200            0.0029447115   0.00020808223  0              0.0086260522   7.4277549e-08  0              0.3586597      2.6109412e-16  0              2.9970149    
   1600000   182.4          200            200            0.0029448017   0.00020808343  0              0.0086263218   1.1004329e-08  0              0.053135968    2.6109412e-16  0              2.9970149    
   1700000   182.4          200            200            0.0029448061   0.00020808348  0              0.0086263349   7.9364709e-10  0              0.0038322378   2.6109412e-16  0              2.9970149    
   1800000   182.4          200            200            0.0029447966   0.00020808335  0              0.0086263065   1.0723935e-11  0              5.1782045e-05  2.6109412e-16  0              2.9970149    
   1900000   182.4          200            200            0.0029447901   0.00020808326  0              0.0086262871   3.1732397e-12  0              1.5322439e-05  2.6109412e-16  0              2.9970149    
   2000000   182.4          200            200            0.0029447874   0.00020808322  0              0.008626279    2.3956376e-12  0              1.1567677e-05  2.6109412e-16  0              2.9970149    
   2100000   182.4          200            200            0.0029447866   0.00020808321  0              0.0086262765   5.1647539e-13  0              2.4938748e-06  2.6109412e-16  0              2.9970149    
   2200000   182.4          200            200            0.0029447864   0.00020808321  0              0.0086262761   5.5820543e-14  0              2.6953742e-07  2.6109412e-16  0              2.9970149    
   2300000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262762   2.4366907e-15  0              1.1765907e-08  2.6109412e-16  0              2.9970149    
   2400000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262763   2.1586478e-18  0              1.0423338e-11  2.6109412e-16  0              2.9970149    
   2500000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262763   5.7062588e-17  0              2.7553482e-10  2.6109412e-16  0              2.9970149    
   2600000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262764   2.0480307e-17  0              9.8892071e-11  2.6109412e-16  0              2.9970149    
   2700000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262764   2.658248e-18   0              1.2835728e-11  2.6109412e-16  0              2.9970149    
   2800000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262764   1.5319829e-19  0              7.397397e-13   2.6109412e-16  0              2.9970149    
   2900000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262764   1.3632467e-19  0              6.5826302e-13  2.6109412e-16  0              2.9970149    
   3000000   182.4          200            200            0.0029447865   0.00020808321  0              0.0086262764   5.1344557e-22  0              2.4792449e-15  2.6109412e-16  0              2.9970149    
Loop time of 64.1009 on 4 procs for 3000000 steps with 51 atoms

Performance: 40436242.035 ns/day, 0.000 hours/ns, 46801.206 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29623    | 1.6185     | 5.3179     | 168.0 |  2.52
Neigh   | 0.093799   | 0.094352   | 0.095926   |   0.3 |  0.15
Comm    | 25.643     | 32.436     | 38.337     |  85.6 | 50.60
Output  | 0.060922   | 0.061006   | 0.061071   |   0.0 |  0.10
Modify  | 15.173     | 21.141     | 28.629     | 123.7 | 32.98
Other   |            | 8.75       |            |       | 13.65

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 58

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.09                                                               
Lattice spacing in x,y,z = 6.09 6.09 6.09

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.35 ${n1e1} -100 100 -100 100 units box
region box block -91.35 91.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.35 91.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.35 -100 -100) to (91.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-91.35 -100 -100) to (91.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.35 -100 -100) to (91.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_58_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 118 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.02 | 18.49 | 19.64 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   182.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   182.7          200            200            0.0023556031  -8.0936078e-38  0              0.0070668092   12437.237      0              6.0054967e+10  2.6109412e-16  0              3.3208203    
    200000   182.7          200            200            0.00087340063  2.3617044e-38  0              0.0026202019   3255.7218      0              1.5720716e+10  2.6109412e-16  0              3.064123     
    300000   182.7          200            200            0.00013314857  3.3735311e-39  0              0.00039944572  143.31442      0              6.9201406e+08  2.6109412e-16  0              3.0435561    
    400000   182.7          200            200           -0.00010580302 -2.1403156e-37  0             -0.00031740907  144.34659      0              6.9699803e+08  2.6109412e-16  0              3.001871     
    500000   182.7          200            200            0.00034071333  3.7252188e-39  0              0.00102214     16.678077      0              80532467       2.6109412e-16  0              2.9989415    
    600000   182.7          200            200            0.0023228495   0.00012030653  0              0.0068482418   4.7987485      0              23171439       2.6109412e-16  0              2.9971888    
    700000   182.7          200            200            0.0023674532   0.00020900232  0              0.0068933574   0.061698951    0              297922.15      2.6109412e-16  0              2.9971651    
    800000   182.7          200            200            0.0029116747   0.00021992285  0              0.0085151013   0.099335813    0              479657.09      2.6109412e-16  0              2.996858     
    900000   182.7          200            200            0.0030121713   0.00022145529  0              0.0088150587   0.0044909289   0              21685.088      2.6109412e-16  0              2.996805     
   1000000   182.7          200            200            0.002971377    0.00022081669  0              0.0086933144   0.00038873695  0              1877.0716      2.6109412e-16  0              2.9968274    
   1100000   182.7          200            200            0.0029442295   0.00022039057  0              0.008612298    0.00025075076  0              1210.7857      2.6109412e-16  0              2.9968421    
   1200000   182.7          200            200            0.0029403813   0.00022033152  0              0.0086008124   7.8781294e-06  0              38.040668      2.6109412e-16  0              2.9968441    
   1300000   182.7          200            200            0.0029427187   0.00022036937  0              0.0086077869   1.3746029e-06  0              6.6374653      2.6109412e-16  0              2.9968428    
   1400000   182.7          200            200            0.0029440482   0.00022039043  0              0.008611754    6.1638603e-07  0              2.9763076      2.6109412e-16  0              2.9968421    
   1500000   182.7          200            200            0.0029441913   0.00022039259  0              0.0086121813   1.2699437e-08  0              0.061321038    2.6109412e-16  0              2.996842     
   1600000   182.7          200            200            0.0029440609   0.00022039049  0              0.0086117922   4.5277279e-09  0              0.021862777    2.6109412e-16  0              2.9968421    
   1700000   182.7          200            200            0.0029439964   0.00022038947  0              0.0086115999   1.4826589e-09  0              0.0071592293   2.6109412e-16  0              2.9968421    
   1800000   182.7          200            200            0.0029439918   0.0002203894   0              0.008611586    1.7665603e-11  0              8.5300875e-05  2.6109412e-16  0              2.9968421    
   1900000   182.7          200            200            0.0029439989   0.00022038951  0              0.0086116073   1.4119816e-11  0              6.817954e-05   2.6109412e-16  0              2.9968421    
   2000000   182.7          200            200            0.002944002    0.00022038956  0              0.0086116165   3.4873654e-12  0              1.6839239e-05  2.6109412e-16  0              2.9968421    
   2100000   182.7          200            200            0.0029440021   0.00022038957  0              0.0086116168   1.8769192e-14  0              9.062971e-08   2.6109412e-16  0              2.9968421    
   2200000   182.7          200            200            0.0029440017   0.00022038956  0              0.0086116157   4.2131861e-14  0              2.0343968e-07  2.6109412e-16  0              2.9968421    
   2300000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116152   8.0138132e-15  0              3.8695836e-08  2.6109412e-16  0              2.9968421    
   2400000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116152   1.0412219e-17  0              5.0276879e-11  2.6109412e-16  0              2.9968421    
   2500000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116153   1.2323474e-16  0              5.9505648e-10  2.6109412e-16  0              2.9968421    
   2600000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116153   1.7411403e-17  0              8.4073433e-11  2.6109412e-16  0              2.9968421    
   2700000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116153   3.0140016e-19  0              1.4553535e-12  2.6109412e-16  0              2.9968421    
   2800000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116153   1.2331567e-19  0              5.9544724e-13  2.6109412e-16  0              2.9968421    
   2900000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116153   5.8885001e-20  0              2.843346e-13   2.6109412e-16  0              2.9968421    
   3000000   182.7          200            200            0.0029440016   0.00022038956  0              0.0086116153   2.6219543e-20  0              1.2660479e-13  2.6109412e-16  0              2.9968421    
Loop time of 63.8495 on 4 procs for 3000000 steps with 51 atoms

Performance: 40595487.143 ns/day, 0.000 hours/ns, 46985.518 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32166    | 1.5993     | 5.2546     | 166.9 |  2.50
Neigh   | 0.093796   | 0.09439    | 0.095994   |   0.3 |  0.15
Comm    | 25.744     | 32.316     | 38.13      |  83.9 | 50.61
Output  | 0.061444   | 0.061525   | 0.061588   |   0.0 |  0.10
Modify  | 15.14      | 21.017     | 28.322     | 122.1 | 32.92
Other   |            | 8.762      |            |       | 13.72

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 168
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 59

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.1                                                               
Lattice spacing in x,y,z = 6.1 6.1 6.1

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.5 ${n1e1} -100 100 -100 100 units box
region box block -91.5 91.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.5 91.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.5 -100 -100) to (91.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-91.5 -100 -100) to (91.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.5 -100 -100) to (91.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_59_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 119 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.04 | 18.51 | 19.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   183            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   183            200            200            0.0023490041   2.6955489e-38  0              0.0070470122   12415.658      0              5.9950769e+10  2.6109412e-16  0              3.3216001    
    200000   183            200            200            0.00086555657 -8.4186214e-39  0              0.0025966697   3218.5241      0              1.5541101e+10  2.6109412e-16  0              3.0655833    
    300000   183            200            200            0.00012239352 -3.367067e-38   0              0.00036718056  123.21999      0              5.9498524e+08  2.6109412e-16  0              3.0440762    
    400000   183            200            200            0.00049812109  1.8044641e-06  0              0.0014925588   213.28584      0              1.029881e+09   2.6109412e-16  0              2.9982832    
    500000   183            200            200            9.7092387e-05 -5.376554e-38   0              0.00029127716  2.9864232      0              14420369       2.6109412e-16  0              2.9994429    
    600000   183            200            200            0.0023498645   0.00022770092  0              0.0068218926   4.79338        0              23145516       2.6109412e-16  0              2.9969813    
    700000   183            200            200            0.003494466    0.00023176512  0              0.010251633    0.15424415     0              744789.8       2.6109412e-16  0              2.9963617    
    800000   183            200            200            0.0027856288   0.00022080736  0              0.0081360791   0.050915008    0              245850.35      2.6109412e-16  0              2.9967406    
    900000   183            200            200            0.0028964497   0.00022302545  0              0.0084663237   0.0097690148   0              47171.077      2.6109412e-16  0              2.9966773    
   1000000   183            200            200            0.0029690502   0.00022431963  0              0.0086828311   0.00017159683  0              828.57968      2.6109412e-16  0              2.996638     
   1100000   183            200            200            0.0029411091   0.00022381878  0              0.0085995086   0.00024653254  0              1190.4174      2.6109412e-16  0              2.9966534    
   1200000   183            200            200            0.0029362121   0.00022373389  0              0.0085849025   9.5863301e-07  0              4.6288957      2.6109412e-16  0              2.996656     
   1300000   183            200            200            0.0029408461   0.00022381734  0              0.008598721    3.8149107e-06  0              18.420839      2.6109412e-16  0              2.9966534    
   1400000   183            200            200            0.0029406982   0.00022381424  0              0.0085982803   2.2511424e-07  0              1.0869961      2.6109412e-16  0              2.9966535    
   1500000   183            200            200            0.0029400969   0.0002238035   0              0.0085964873   3.2842825e-08  0              0.15858625     2.6109412e-16  0              2.9966539    
   1600000   183            200            200            0.0029402222   0.0002238058   0              0.0085968609   9.2023067e-09  0              0.044434646    2.6109412e-16  0              2.9966538    
   1700000   183            200            200            0.0029402817   0.00022380685  0              0.0085970381   5.9730571e-11  0              0.00028841755  2.6109412e-16  0              2.9966538    
   1800000   183            200            200            0.0029402543   0.00022380636  0              0.0085969565   2.0545682e-10  0              0.00099207744  2.6109412e-16  0              2.9966538    
   1900000   183            200            200            0.002940251    0.0002238063   0              0.0085969468   2.1424903e-12  0              1.0345319e-05  2.6109412e-16  0              2.9966538    
   2000000   183            200            200            0.0029402553   0.00022380638  0              0.0085969596   2.8335771e-12  0              1.368233e-05   2.6109412e-16  0              2.9966538    
   2100000   183            200            200            0.002940255    0.00022380637  0              0.0085969587   2.4286178e-13  0              1.1726926e-06  2.6109412e-16  0              2.9966538    
   2200000   183            200            200            0.0029402545   0.00022380636  0              0.0085969571   2.0032073e-14  0              9.6727709e-08  2.6109412e-16  0              2.9966538    
   2300000   183            200            200            0.0029402546   0.00022380637  0              0.0085969575   8.3635849e-15  0              4.0384758e-08  2.6109412e-16  0              2.9966538    
   2400000   183            200            200            0.0029402547   0.00022380637  0              0.0085969576   1.1419966e-17  0              5.5142929e-11  2.6109412e-16  0              2.9966538    
   2500000   183            200            200            0.0029402546   0.00022380637  0              0.0085969576   1.6806705e-16  0              8.1153565e-10  2.6109412e-16  0              2.9966538    
   2600000   183            200            200            0.0029402546   0.00022380637  0              0.0085969576   3.3980673e-18  0              1.6408051e-11  2.6109412e-16  0              2.9966538    
   2700000   183            200            200            0.0029402546   0.00022380637  0              0.0085969576   1.1835626e-18  0              5.7150003e-12  2.6109412e-16  0              2.9966538    
   2800000   183            200            200            0.0029402546   0.00022380637  0              0.0085969576   2.2862315e-19  0              1.1039394e-12  2.6109412e-16  0              2.9966538    
   2900000   183            200            200            0.0029402546   0.00022380637  0              0.0085969576   1.0250671e-19  0              4.9496822e-13  2.6109412e-16  0              2.9966538    
   3000000   183            200            200            0.0029402546   0.00022380637  0              0.0085969576   2.2090906e-20  0              1.0666908e-13  2.6109412e-16  0              2.9966538    
Loop time of 63.9647 on 4 procs for 3000000 steps with 51 atoms

Performance: 40522334.813 ns/day, 0.000 hours/ns, 46900.850 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29599    | 1.6082     | 5.3013     | 168.2 |  2.51
Neigh   | 0.093465   | 0.094008   | 0.095583   |   0.3 |  0.15
Comm    | 25.696     | 32.423     | 38.286     |  85.0 | 50.69
Output  | 0.06133    | 0.061407   | 0.061468   |   0.0 |  0.10
Modify  | 15.144     | 21.066     | 28.481     | 123.1 | 32.93
Other   |            | 8.712      |            |       | 13.62

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 60

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.11                                                               
Lattice spacing in x,y,z = 6.11 6.11 6.11

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.65 ${n1e1} -100 100 -100 100 units box
region box block -91.65 91.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.65 91.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.65 -100 -100) to (91.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-91.65 -100 -100) to (91.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.65 -100 -100) to (91.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_60_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 119 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.04 | 18.51 | 19.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   183.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   183.3          200            200            0.0023424708   3.1521314e-40  0              0.0070274124   12394.303      0              5.9847654e+10  2.6109412e-16  0              3.3224187    
    200000   183.3          200            200            0.0008578464  -8.4050774e-39  0              0.0025735392   3182.0481      0              1.5364971e+10  2.6109412e-16  0              3.0670456    
    300000   183.3          200            200            0.00011270913  8.6265112e-37  0              0.00033812739  106.20777      0              5.1283929e+08  2.6109412e-16  0              3.0444663    
    400000   183.3          200            200            0.0077619912   0.0010950019   0              0.022190972    194.85486      0              9.4088437e+08  2.6109412e-16  0              2.9943207    
    500000   183.3          200            200            0.0012520263   5.5620127e-05  0              0.0037004588   32.583774      0              1.5733538e+08  2.6109412e-16  0              2.9974812    
    600000   183.3          200            200            0.0040380412   0.00026996728  0              0.011844156    3.2724099      0              15801296       2.6109412e-16  0              2.9958896    
    700000   183.3          200            200            0.0026442199   0.00021133656  0              0.0077213231   0.55773342     0              2693095.1      2.6109412e-16  0              2.9966115    
    800000   183.3          200            200            0.0030796429   0.00022028487  0              0.0090186439   0.056223556    0              271483.43      2.6109412e-16  0              2.9963722    
    900000   183.3          200            200            0.002863765    0.00021621356  0              0.0083750815   0.003534451    0              17066.599      2.6109412e-16  0              2.9964902    
   1000000   183.3          200            200            0.00296242     0.00021818033  0              0.0086690796   9.2873517e-05  0              448.45298      2.6109412e-16  0              2.9964355    
   1100000   183.3          200            200            0.0029223962   0.00021739824  0              0.0085497904   1.8377103e-06  0              8.8736453      2.6109412e-16  0              2.9964577    
   1200000   183.3          200            200            0.0029370081   0.00021768823  0              0.008593336    5.0708749e-06  0              24.48544       2.6109412e-16  0              2.9964495    
   1300000   183.3          200            200            0.0029321974   0.00021759266  0              0.0085789994   1.9350359e-06  0              9.3435958      2.6109412e-16  0              2.9964522    
   1400000   183.3          200            200            0.0029335836   0.00021762044  0              0.0085831302   4.4653514e-07  0              2.1561584      2.6109412e-16  0              2.9964515    
   1500000   183.3          200            200            0.002933265    0.00021761396  0              0.0085821811   7.7886639e-08  0              0.37608671     2.6109412e-16  0              2.9964516    
   1600000   183.3          200            200            0.0029333002   0.00021761474  0              0.0085822859   1.0973654e-08  0              0.05298785     2.6109412e-16  0              2.9964516    
   1700000   183.3          200            200            0.0029333187   0.00021761507  0              0.008582341    1.2599979e-09  0              0.006084079    2.6109412e-16  0              2.9964516    
   1800000   183.3          200            200            0.002933301    0.00021761473  0              0.0085822883   1.1340971e-10  0              0.0005476149   2.6109412e-16  0              2.9964516    
   1900000   183.3          200            200            0.0029333109   0.00021761492  0              0.0085823177   6.9930785e-12  0              3.3767073e-05  2.6109412e-16  0              2.9964516    
   2000000   183.3          200            200            0.0029333064   0.00021761484  0              0.0085823043   1.6679195e-13  0              8.0537865e-07  2.6109412e-16  0              2.9964516    
   2100000   183.3          200            200            0.0029333082   0.00021761487  0              0.0085823097   5.216023e-15   0              2.5186308e-08  2.6109412e-16  0              2.9964516    
   2200000   183.3          200            200            0.0029333075   0.00021761486  0              0.0085823077   1.1182453e-14  0              5.3996065e-08  2.6109412e-16  0              2.9964516    
   2300000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823084   4.1228043e-15  0              1.9907546e-08  2.6109412e-16  0              2.9964516    
   2400000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   9.3900675e-16  0              4.5341275e-09  2.6109412e-16  0              2.9964516    
   2500000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   1.6253937e-16  0              7.8484446e-10  2.6109412e-16  0              2.9964516    
   2600000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   2.2517646e-17  0              1.0872966e-10  2.6109412e-16  0              2.9964516    
   2700000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   3.0345185e-18  0              1.4652604e-11  2.6109412e-16  0              2.9964516    
   2800000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   2.6027497e-19  0              1.2567747e-12  2.6109412e-16  0              2.9964516    
   2900000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   8.2582471e-20  0              3.987612e-13   2.6109412e-16  0              2.9964516    
   3000000   183.3          200            200            0.0029333077   0.00021761486  0              0.0085823082   4.1004739e-20  0              1.9799721e-13  2.6109412e-16  0              2.9964516    
Loop time of 63.8849 on 4 procs for 3000000 steps with 51 atoms

Performance: 40572967.557 ns/day, 0.000 hours/ns, 46959.453 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31178    | 1.5964     | 5.2533     | 167.1 |  2.50
Neigh   | 0.093481   | 0.094031   | 0.095571   |   0.3 |  0.15
Comm    | 25.799     | 32.348     | 38.118     |  83.3 | 50.63
Output  | 0.062691   | 0.062773   | 0.062839   |   0.0 |  0.10
Modify  | 15.186     | 21.057     | 28.359     | 121.9 | 32.96
Other   |            | 8.727      |            |       | 13.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 61

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.12                                                               
Lattice spacing in x,y,z = 6.12 6.12 6.12

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.8 ${n1e1} -100 100 -100 100 units box
region box block -91.8 91.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.8 91.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.8 -100 -100) to (91.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-91.8 -100 -100) to (91.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.8 -100 -100) to (91.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_61_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 119 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.04 | 18.51 | 19.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   183.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   183.6          200            200            0.0023361137   6.7148041e-39  0              0.007008341    12374.17       0              5.975044e+10   2.6109412e-16  0              3.323197     
    200000   183.6          200            200            0.00085031162  8.3923233e-39  0              0.0025509349   3146.5383      0              1.5193507e+10  2.6109412e-16  0              3.0684944    
    300000   183.6          200            200            0.00010296228  2.1598677e-37  0              0.00030888683  90.124611      0              4.3517949e+08  2.6109412e-16  0              3.0448318    
    400000   183.6          200            200            0.014450942    0.0016252416   0              0.041727586    63.118145      0              3.0477493e+08  2.6109412e-16  0              2.9918037    
    500000   183.6          200            200            0.006289726    0.00066295759  0              0.01820622     20.751981      0              1.0020389e+08  2.6109412e-16  0              2.9946584    
    600000   183.6          200            200            0.0019090496   0.00011001169  0              0.0056171372   3.1526635      0              15223084       2.6109412e-16  0              2.9968424    
    700000   183.6          200            200            0.0023996758   0.00017390829  0              0.007025119    0.12250258     0              591521.12      2.6109412e-16  0              2.9965471    
    800000   183.6          200            200            0.0030850245   0.00020391378  0              0.0090511597   0.043564613    0              210357.93      2.6109412e-16  0              2.9961479    
    900000   183.6          200            200            0.0029418304   0.00020120723  0              0.008624284    0.01229777     0              59381.53       2.6109412e-16  0              2.9962265    
   1000000   183.6          200            200            0.0028944844   0.00020017759  0              0.0084832757   9.4574456e-05  0              456.6662       2.6109412e-16  0              2.9962541    
   1100000   183.6          200            200            0.0029299657   0.00020093382  0              0.0085889633   0.00013543357  0              653.96022      2.6109412e-16  0              2.9962339    
   1200000   183.6          200            200            0.0029241967   0.00020081623  0              0.0085717738   2.8349835e-05  0              136.89121      2.6109412e-16  0              2.9962371    
   1300000   183.6          200            200            0.0029213785   0.00020075554  0              0.0085633799   6.7520211e-08  0              0.32603094     2.6109412e-16  0              2.9962387    
   1400000   183.6          200            200            0.0029231301   0.00020079245  0              0.008568598    3.9806933e-07  0              1.9221343      2.6109412e-16  0              2.9962377    
   1500000   183.6          200            200            0.0029229081   0.00020078796  0              0.0085679364   6.3761698e-08  0              0.30788242     2.6109412e-16  0              2.9962378    
   1600000   183.6          200            200            0.0029227476   0.00020078451  0              0.0085674582   2.604351e-12   0              1.2575479e-05  2.6109412e-16  0              2.9962379    
   1700000   183.6          200            200            0.0029228329   0.00020078631  0              0.0085677124   1.129829e-09   0              0.0054555398   2.6109412e-16  0              2.9962379    
   1800000   183.6          200            200            0.0029228252   0.00020078616  0              0.0085676896   1.3918706e-10  0              0.00067208448  2.6109412e-16  0              2.9962379    
   1900000   183.6          200            200            0.0029228163   0.00020078597  0              0.008567663    2.3442925e-13  0              1.1319749e-06  2.6109412e-16  0              2.9962379    
   2000000   183.6          200            200            0.0029228204   0.00020078605  0              0.0085676753   3.1089144e-12  0              1.5011835e-05  2.6109412e-16  0              2.9962379    
   2100000   183.6          200            200            0.0029228202   0.00020078605  0              0.0085676746   2.9365107e-13  0              1.4179359e-06  2.6109412e-16  0              2.9962379    
   2200000   183.6          200            200            0.0029228197   0.00020078604  0              0.0085676732   2.6960236e-15  0              1.3018133e-08  2.6109412e-16  0              2.9962379    
   2300000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676738   8.3164236e-15  0              4.0157033e-08  2.6109412e-16  0              2.9962379    
   2400000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676738   5.9277456e-16  0              2.8622962e-09  2.6109412e-16  0              2.9962379    
   2500000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676737   1.5558036e-17  0              7.5124188e-11  2.6109412e-16  0              2.9962379    
   2600000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676737   2.1588522e-17  0              1.0424325e-10  2.6109412e-16  0              2.9962379    
   2700000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676737   3.7937306e-19  0              1.8318567e-12  2.6109412e-16  0              2.9962379    
   2800000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676737   3.6332028e-19  0              1.7543436e-12  2.6109412e-16  0              2.9962379    
   2900000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676737   1.0120389e-19  0              4.8867737e-13  2.6109412e-16  0              2.9962379    
   3000000   183.6          200            200            0.0029228199   0.00020078604  0              0.0085676737   7.5023089e-20  0              3.6225965e-13  2.6109412e-16  0              2.9962379    
Loop time of 64.2635 on 4 procs for 3000000 steps with 51 atoms

Performance: 40333933.656 ns/day, 0.000 hours/ns, 46682.794 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31108    | 1.6498     | 5.4416     | 170.5 |  2.57
Neigh   | 0.093423   | 0.094015   | 0.095548   |   0.3 |  0.15
Comm    | 25.708     | 32.503     | 38.363     |  85.5 | 50.58
Output  | 0.060482   | 0.060563   | 0.060629   |   0.0 |  0.09
Modify  | 15.318     | 21.279     | 28.799     | 123.5 | 33.11
Other   |            | 8.678      |            |       | 13.50

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 62

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.13                                                               
Lattice spacing in x,y,z = 6.13 6.13 6.13

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -91.95 ${n1e1} -100 100 -100 100 units box
region box block -91.95 91.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -91.95 91.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-91.95 -100 -100) to (91.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-91.95 -100 -100) to (91.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-91.95 -100 -100) to (91.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_62_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 119 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.04 | 18.51 | 19.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   183.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   183.9          200            200            0.0023301136  -2.6800165e-38  0              0.0069903409   12356.95       0              5.9667291e+10  2.6109412e-16  0              3.3237859    
    200000   183.9          200            200            0.00084367174  2.7647126e-43  0              0.0025310152   3116.2363      0              1.504719e+10   2.6109412e-16  0              3.0696698    
    300000   183.9          200            200            9.3015012e-05  8.6901408e-37  0              0.00027904504  74.836589      0              3.6135911e+08  2.6109412e-16  0              3.0451823    
    400000   183.9          200            200            0.016611909    0.0017661139   0              0.048069612    1.4049371      0              6783938.3      2.6109412e-16  0              2.9908928    
    500000   183.9          200            200            0.0069065186   0.0005828715   0              0.020136684    12.947435      0              62518532       2.6109412e-16  0              2.9941686    
    600000   183.9          200            200            0.0022539619   7.4127523e-05  0              0.0066877581   4.3925881      0              21210236       2.6109412e-16  0              2.9964191    
    700000   183.9          200            200            0.0024103293   0.00013504229  0              0.0070959457   0.15591795     0              752871.97      2.6109412e-16  0              2.9963177    
    800000   183.9          200            200            0.0027289147   0.00016974034  0              0.0080170038   0.02323105     0              112174.43      2.6109412e-16  0              2.9961235    
    900000   183.9          200            200            0.0028471645   0.00017277888  0              0.0083687147   0.0044596715   0              21534.158      2.6109412e-16  0              2.9960524    
   1000000   183.9          200            200            0.0028885073   0.00017375075  0              0.0084917711   0.00081188146  0              3920.285       2.6109412e-16  0              2.9960278    
   1100000   183.9          200            200            0.0029024618   0.00017406945  0              0.0085333161   0.00013868437  0              669.65719      2.6109412e-16  0              2.9960196    
   1200000   183.9          200            200            0.0029070386   0.00017417322  0              0.0085469427   2.2486672e-05  0              108.58009      2.6109412e-16  0              2.9960168    
   1300000   183.9          200            200            0.0029084909   0.00017420618  0              0.0085512664   3.4916527e-06  0              16.859941      2.6109412e-16  0              2.996016     
   1400000   183.9          200            200            0.0029089318   0.00017421624  0              0.0085525792   5.22209e-07    0              2.5215604      2.6109412e-16  0              2.9960157    
   1500000   183.9          200            200            0.0029090573   0.00017421913  0              0.0085529526   7.5501446e-08  0              0.36456946     2.6109412e-16  0              2.9960156    
   1600000   183.9          200            200            0.0029090892   0.00017421987  0              0.0085530477   1.0576051e-08  0              0.051067966    2.6109412e-16  0              2.9960156    
   1700000   183.9          200            200            0.0029090955   0.00017422003  0              0.0085530665   1.4368892e-09  0              0.0069382237   2.6109412e-16  0              2.9960156    
   1800000   183.9          200            200            0.0029090958   0.00017422004  0              0.0085530674   1.8936822e-10  0              0.00091439136  2.6109412e-16  0              2.9960156    
   1900000   183.9          200            200            0.0029090952   0.00017422003  0              0.0085530656   2.4188764e-11  0              0.00011679889  2.6109412e-16  0              2.9960156    
   2000000   183.9          200            200            0.0029090947   0.00017422002  0              0.0085530641   2.9893616e-12  0              1.4434557e-05  2.6109412e-16  0              2.9960156    
   2100000   183.9          200            200            0.0029090944   0.00017422001  0              0.0085530632   3.5622292e-13  0              1.720073e-06   2.6109412e-16  0              2.9960156    
   2200000   183.9          200            200            0.0029090943   0.00017422001  0              0.0085530628   4.0723567e-14  0              1.9663953e-07  2.6109412e-16  0              2.9960156    
   2300000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530626   4.4293016e-15  0              2.1387512e-08  2.6109412e-16  0              2.9960156    
   2400000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   4.5860453e-16  0              2.2144372e-09  2.6109412e-16  0              2.9960156    
   2500000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   4.519963e-17   0              2.1825284e-10  2.6109412e-16  0              2.9960156    
   2600000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   3.6752741e-18  0              1.7746583e-11  2.6109412e-16  0              2.9960156    
   2700000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   9.4272923e-19  0              4.5521021e-12  2.6109412e-16  0              2.9960156    
   2800000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   2.7973197e-19  0              1.3507256e-12  2.6109412e-16  0              2.9960156    
   2900000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   2.1378297e-21  0              1.0322815e-14  2.6109412e-16  0              2.9960156    
   3000000   183.9          200            200            0.0029090942   0.00017422001  0              0.0085530625   2.301493e-21   0              1.1113086e-14  2.6109412e-16  0              2.9960156    
Loop time of 64.1081 on 4 procs for 3000000 steps with 51 atoms

Performance: 40431686.938 ns/day, 0.000 hours/ns, 46795.934 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30871    | 1.6154     | 5.3257     | 168.6 |  2.52
Neigh   | 0.093361   | 0.094263   | 0.096153   |   0.4 |  0.15
Comm    | 25.673     | 32.421     | 38.214     |  85.2 | 50.57
Output  | 0.06362    | 0.063704   | 0.063766   |   0.0 |  0.10
Modify  | 15.341     | 21.229     | 28.682     | 123.1 | 33.11
Other   |            | 8.685      |            |       | 13.55

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 63

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.14                                                               
Lattice spacing in x,y,z = 6.14 6.14 6.14

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -92.1 ${n1e1} -100 100 -100 100 units box
region box block -92.1 92.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.1 92.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-92.1 -100 -100) to (92.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-92.1 -100 -100) to (92.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-92.1 -100 -100) to (92.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_63_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 119 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.04 | 18.51 | 19.66 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   184.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   184.2          200            200            0.0023241062   6.6958891e-38  0              0.0069723187   12339.392      0              5.9582507e+10  2.6109412e-16  0              3.3244331    
    200000   184.2          200            200            0.00083744595 -1.3341123e-38  0              0.0025123379   3088.3064      0              1.4912326e+10  2.6109412e-16  0              3.0707286    
    300000   184.2          200            200            8.3045236e-05  7.5319415e-37  0              0.00024913571  60.720618      0              2.9319813e+08  2.6109412e-16  0              3.0455015    
    400000   184.2          200            200            0.015746421    0.0017333741   0              0.045505887    22.859707      0              1.1038134e+08  2.6109412e-16  0              2.9908879    
    500000   184.2          200            200            0.001340965   -2.5028341e-36  0              0.0040228949   27.672731      0              1.3362171e+08  2.6109412e-16  0              2.997182     
    600000   184.2          200            200            0.0038526329   0.00021712599  0              0.011340773    3.4685914      0              16748586       2.6109412e-16  0              2.9952666    
    700000   184.2          200            200            0.0028465071   0.00016290608  0              0.0083766153   0.68826305     0              3323375.9      2.6109412e-16  0              2.9958171    
    800000   184.2          200            200            0.002978557    0.00013874459  0              0.0087969263   0.076011734    0              367033.46      2.6109412e-16  0              2.9957381    
    900000   184.2          200            200            0.0028303781   0.00013552031  0              0.0083556138   0.0040601743   0              19605.129      2.6109412e-16  0              2.9958262    
   1000000   184.2          200            200            0.0029192725   0.00013756529  0              0.0086202522   1.025355e-05   0              49.510725      2.6109412e-16  0              2.9957723    
   1100000   184.2          200            200            0.0028827762   0.0001367496   0              0.008511579    4.4314566e-05  0              213.97918      2.6109412e-16  0              2.9957945    
   1200000   184.2          200            200            0.0028938286   0.00013700353  0              0.0085444822   2.1632604e-05  0              104.4561       2.6109412e-16  0              2.9957877    
   1300000   184.2          200            200            0.0028917626   0.00013695531  0              0.0085383325   4.1726447e-06  0              20.148208      2.6109412e-16  0              2.995789     
   1400000   184.2          200            200            0.0028915746   0.00013695168  0              0.008537772    4.4065536e-07  0              2.127767       2.6109412e-16  0              2.9957891    
   1500000   184.2          200            200            0.0028919733   0.00013696052  0              0.0085389594   2.0683264e-08  0              0.099872077    2.6109412e-16  0              2.9957888    
   1600000   184.2          200            200            0.0028917464   0.00013695542  0              0.0085382836   1.4712612e-12  0              7.1041937e-06  2.6109412e-16  0              2.995789     
   1700000   184.2          200            200            0.0028918361   0.00013695745  0              0.0085385507   3.4942796e-10  0              0.0016872626   2.6109412e-16  0              2.9957889    
   1800000   184.2          200            200            0.00289181     0.00013695685  0              0.0085384731   1.4394079e-10  0              0.00069503858  2.6109412e-16  0              2.9957889    
   1900000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384861   2.5659099e-11  0              0.0001238986   2.6109412e-16  0              2.9957889    
   2000000   184.2          200            200            0.0028918151   0.00013695697  0              0.0085384884   2.5065327e-12  0              1.2103149e-05  2.6109412e-16  0              2.9957889    
   2100000   184.2          200            200            0.002891814    0.00013695695  0              0.0085384852   1.0032449e-13  0              4.8443105e-07  2.6109412e-16  0              2.9957889    
   2200000   184.2          200            200            0.0028918146   0.00013695696  0              0.0085384869   1.888829e-16   0              9.1204791e-10  2.6109412e-16  0              2.9957889    
   2300000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384862   2.6613569e-15  0              1.285074e-08   2.6109412e-16  0              2.9957889    
   2400000   184.2          200            200            0.0028918145   0.00013695696  0              0.0085384864   9.4585915e-16  0              4.5672153e-09  2.6109412e-16  0              2.9957889    
   2500000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384864   1.5702753e-16  0              7.5822972e-10  2.6109412e-16  0              2.9957889    
   2600000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384864   1.3712049e-17  0              6.6210578e-11  2.6109412e-16  0              2.9957889    
   2700000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384864   1.2188307e-18  0              5.8852971e-12  2.6109412e-16  0              2.9957889    
   2800000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384864   1.5630019e-19  0              7.5471766e-13  2.6109412e-16  0              2.9957889    
   2900000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384864   6.2413173e-21  0              3.0137088e-14  2.6109412e-16  0              2.9957889    
   3000000   184.2          200            200            0.0028918144   0.00013695696  0              0.0085384864   5.9717506e-20  0              2.8835447e-13  2.6109412e-16  0              2.9957889    
Loop time of 64.0753 on 4 procs for 3000000 steps with 51 atoms

Performance: 40452396.201 ns/day, 0.000 hours/ns, 46819.903 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30669    | 1.646      | 5.4148     | 169.7 |  2.57
Neigh   | 0.093404   | 0.094114   | 0.095537   |   0.3 |  0.15
Comm    | 25.68      | 32.503     | 38.387     |  85.8 | 50.73
Output  | 0.062102   | 0.062183   | 0.062248   |   0.0 |  0.10
Modify  | 15.157     | 21.143     | 28.669     | 124.2 | 33.00
Other   |            | 8.627      |            |       | 13.46

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 64

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.15                                                               
Lattice spacing in x,y,z = 6.15 6.15 6.15

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -92.25 ${n1e1} -100 100 -100 100 units box
region box block -92.25 92.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.25 92.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-92.25 -100 -100) to (92.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-92.25 -100 -100) to (92.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-92.25 -100 -100) to (92.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_64_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 120 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.06 | 18.52 | 19.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   184.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   184.5          200            200            0.002318098   -3.3382698e-39  0              0.0069542939   12321.536      0              5.9496286e+10  2.6109412e-16  0              3.3251408    
    200000   184.5          200            200            0.00083125636  2.6777615e-38  0              0.0024937691   3060.5252      0              1.4778181e+10  2.6109412e-16  0              3.0717994    
    300000   184.5          200            200            7.4016184e-05  2.2113191e-37  0              0.00022204855  49.047837      0              2.3683445e+08  2.6109412e-16  0              3.0457249    
    400000   184.5          200            200            0.012795608    0.0013717641   0              0.03701506     92.859689      0              4.483862e+08   2.6109412e-16  0              2.9915259    
    500000   184.5          200            200            0.00035609392 -4.1449681e-36  0              0.0010682817   0.15308955     0              739214.64      2.6109412e-16  0              2.9987939    
    600000   184.5          200            200            0.003643476    0.00015945977  0              0.010770968    3.8437496      0              18560091       2.6109412e-16  0              2.995122     
    700000   184.5          200            200            0.0023724342   4.0590064e-05  0              0.0070767126   0.060222752    0              290794.12      2.6109412e-16  0              2.9959026    
    800000   184.5          200            200            0.0027546107   9.0486677e-05  0              0.0081733453   0.056088184    0              270829.77      2.6109412e-16  0              2.9956406    
    900000   184.5          200            200            0.0028538287   9.0725267e-05  0              0.0084707607   0.011328005    0              54698.883      2.6109412e-16  0              2.9955755    
   1000000   184.5          200            200            0.002874968    9.1186534e-05  0              0.0085337174   0.0016015085   0              7733.1113      2.6109412e-16  0              2.9955622    
   1100000   184.5          200            200            0.0028763052   9.1209941e-05  0              0.0085377056   0.00016848451  0              813.55141      2.6109412e-16  0              2.9955615    
   1200000   184.5          200            200            0.0028744028   9.1165826e-05  0              0.0085320427   1.2099675e-05  0              58.425001      2.6109412e-16  0              2.9955628    
   1300000   184.5          200            200            0.0028729237   9.1132423e-05  0              0.0085276387   3.936877e-07   0              1.900977       2.6109412e-16  0              2.9955638    
   1400000   184.5          200            200            0.0028721681   9.1115499e-05  0              0.0085253889   1.6542553e-09  0              0.0079878066   2.6109412e-16  0              2.9955642    
   1500000   184.5          200            200            0.0028718506   9.1108425e-05  0              0.0085244433   1.2716619e-08  0              0.061404004    2.6109412e-16  0              2.9955645    
   1600000   184.5          200            200            0.0028717352   9.110587e-05   0              0.0085240997   5.151083e-09   0              0.024872736    2.6109412e-16  0              2.9955645    
   1700000   184.5          200            200            0.0028716991   9.1105076e-05  0              0.0085239922   1.1507249e-09  0              0.0055564387   2.6109412e-16  0              2.9955646    
   1800000   184.5          200            200            0.00287169     9.1104877e-05  0              0.0085239651   1.8315953e-10  0              0.00088441183  2.6109412e-16  0              2.9955646    
   1900000   184.5          200            200            0.0028716886   9.1104849e-05  0              0.008523961    2.1936485e-11  0              0.00010592344  2.6109412e-16  0              2.9955646    
   2000000   184.5          200            200            0.0028716889   9.1104856e-05  0              0.0085239619   1.8994587e-12  0              9.1718063e-06  2.6109412e-16  0              2.9955646    
   2100000   184.5          200            200            0.0028716893   9.1104865e-05  0              0.008523963    9.6478878e-14  0              4.6586197e-07  2.6109412e-16  0              2.9955646    
   2200000   184.5          200            200            0.0028716895   9.110487e-05   0              0.0085239637   6.9466429e-16  0              3.3542853e-09  2.6109412e-16  0              2.9955646    
   2300000   184.5          200            200            0.0028716896   9.1104873e-05  0              0.008523964    5.7995983e-16  0              2.8004184e-09  2.6109412e-16  0              2.9955646    
   2400000   184.5          200            200            0.0028716897   9.1104874e-05  0              0.0085239641   4.0421922e-16  0              1.95183e-09    2.6109412e-16  0              2.9955646    
   2500000   184.5          200            200            0.0028716897   9.1104874e-05  0              0.0085239642   1.1005467e-16  0              5.3141462e-10  2.6109412e-16  0              2.9955646    
   2600000   184.5          200            200            0.0028716897   9.1104874e-05  0              0.0085239642   1.9488673e-17  0              9.4103827e-11  2.6109412e-16  0              2.9955646    
   2700000   184.5          200            200            0.0028716897   9.1104874e-05  0              0.0085239642   2.2526507e-18  0              1.0877244e-11  2.6109412e-16  0              2.9955646    
   2800000   184.5          200            200            0.0028716897   9.1104874e-05  0              0.0085239642   4.2138197e-20  0              2.0347028e-13  2.6109412e-16  0              2.9955646    
   2900000   184.5          200            200            0.0028716897   9.1104874e-05  0              0.0085239642   3.2907465e-20  0              1.5889837e-13  2.6109412e-16  0              2.9955646    
   3000000   184.5          200            200            0.0028716897   9.1104873e-05  0              0.0085239642   2.5939587e-20  0              1.2525298e-13  2.6109412e-16  0              2.9955646    
Loop time of 64.0094 on 4 procs for 3000000 steps with 51 atoms

Performance: 40494071.543 ns/day, 0.000 hours/ns, 46868.138 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30634    | 1.5982     | 5.2571     | 167.2 |  2.50
Neigh   | 0.092845   | 0.093727   | 0.095134   |   0.3 |  0.15
Comm    | 25.61      | 32.345     | 38.113     |  85.2 | 50.53
Output  | 0.060549   | 0.06063    | 0.060697   |   0.0 |  0.09
Modify  | 15.383     | 21.24      | 28.682     | 123.2 | 33.18
Other   |            | 8.671      |            |       | 13.55

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.75 ave          31 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 31
Ave neighs/atom = 0.60784314
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 65

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.16                                                               
Lattice spacing in x,y,z = 6.16 6.16 6.16

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -92.4 ${n1e1} -100 100 -100 100 units box
region box block -92.4 92.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.4 92.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-92.4 -100 -100) to (92.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-92.4 -100 -100) to (92.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-92.4 -100 -100) to (92.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_65_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 120 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.06 | 18.52 | 19.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   184.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   184.8          200            200            0.0023121826   6.6790736e-39  0              0.0069365479   12304.228      0              5.9412715e+10  2.6109412e-16  0              3.3258434    
    200000   184.8          200            200            0.00082510082  8.0211045e-38  0              0.0024753025   3032.8799      0              1.4644692e+10  2.6109412e-16  0              3.072884     
    300000   184.8          200            200            6.6963155e-05 -1.2714132e-36  0              0.00020088947  40.712848      0              1.9658777e+08  2.6109412e-16  0              3.0458005    
    400000   184.8          200            200            0.0085559218   0.00075849334  0              0.024909272    168.96451      0              8.1586913e+08  2.6109412e-16  0              2.9927109    
    500000   184.8          200            200            0.0023378388   1.7242607e-08  0              0.007013499    33.140442      0              1.6002333e+08  2.6109412e-16  0              2.9957304    
    600000   184.8          200            200            0.0023227647   4.7862363e-37  0              0.0069682941   3.7164311      0              17945316       2.6109412e-16  0              2.9958353    
    700000   184.8          200            200            0.0032115053   6.9372031e-05  0              0.009565144    0.34641119     0              1672695.6      2.6109412e-16  0              2.9951175    
    800000   184.8          200            200            0.0027308413   2.6372407e-05  0              0.0081661516   0.049068955    0              236936.42      2.6109412e-16  0              2.9954427    
    900000   184.8          200            200            0.0027850316   3.8173495e-05  0              0.0083169212   0.00014037764  0              677.83337      2.6109412e-16  0              2.9954028    
   1000000   184.8          200            200            0.0028370185   3.9375934e-05  0              0.0084716795   0.0011293406   0              5453.1817      2.6109412e-16  0              2.9953644    
   1100000   184.8          200            200            0.0028527817   3.9688457e-05  0              0.0085186565   0.00018362295  0              886.64951      2.6109412e-16  0              2.9953531    
   1200000   184.8          200            200            0.0028528261   3.9686966e-05  0              0.0085187914   2.5506302e-06  0              12.31608       2.6109412e-16  0              2.9953532    
   1300000   184.8          200            200            0.0028507153   3.9645166e-05  0              0.0085125006   1.2264951e-06  0              5.9223059      2.6109412e-16  0              2.9953547    
   1400000   184.8          200            200            0.0028497517   3.9626288e-05  0              0.0085096288   5.1734031e-07  0              2.4980512      2.6109412e-16  0              2.9953554    
   1500000   184.8          200            200            0.0028495994   3.9623392e-05  0              0.0085091747   3.1341627e-08  0              0.1513375      2.6109412e-16  0              2.9953555    
   1600000   184.8          200            200            0.0028496605   3.9624637e-05  0              0.0085093569   2.8465518e-10  0              0.001374498    2.6109412e-16  0              2.9953555    
   1700000   184.8          200            200            0.0028497089   3.9625594e-05  0              0.0085095011   1.0001199e-09  0              0.0048292213   2.6109412e-16  0              2.9953555    
   1800000   184.8          200            200            0.0028497226   3.962586e-05   0              0.008509542    1.4615347e-10  0              0.00070572281  2.6109412e-16  0              2.9953554    
   1900000   184.8          200            200            0.0028497223   3.9625852e-05  0              0.0085095411   1.4756053e-12  0              7.1251698e-06  2.6109412e-16  0              2.9953554    
   2000000   184.8          200            200            0.0028497203   3.9625812e-05  0              0.0085095351   1.1747456e-12  0              5.672426e-06   2.6109412e-16  0              2.9953554    
   2100000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095326   4.3161083e-13  0              2.0840942e-06  2.6109412e-16  0              2.9953554    
   2200000   184.8          200            200            0.0028497193   3.9625793e-05  0              0.0085095322   2.3047205e-14  0              1.112867e-07   2.6109412e-16  0              2.9953554    
   2300000   184.8          200            200            0.0028497194   3.9625794e-05  0              0.0085095324   3.9386333e-16  0              1.9018251e-09  2.6109412e-16  0              2.9953554    
   2400000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   8.7129424e-16  0              4.2071681e-09  2.6109412e-16  0              2.9953554    
   2500000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   1.1667649e-16  0              5.63389e-10    2.6109412e-16  0              2.9953554    
   2600000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   1.1847754e-18  0              5.7208564e-12  2.6109412e-16  0              2.9953554    
   2700000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   1.6611136e-18  0              8.0209228e-12  2.6109412e-16  0              2.9953554    
   2800000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   2.3790242e-19  0              1.1487457e-12  2.6109412e-16  0              2.9953554    
   2900000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   1.3458489e-19  0              6.4986227e-13  2.6109412e-16  0              2.9953554    
   3000000   184.8          200            200            0.0028497194   3.9625795e-05  0              0.0085095325   1.8474653e-20  0              8.9207487e-14  2.6109412e-16  0              2.9953554    
Loop time of 63.8197 on 4 procs for 3000000 steps with 51 atoms

Performance: 40614411.709 ns/day, 0.000 hours/ns, 47007.421 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31255    | 1.5702     | 5.1485     | 164.9 |  2.46
Neigh   | 0.093054   | 0.09362    | 0.095197   |   0.3 |  0.15
Comm    | 25.713     | 32.293     | 38.08      |  84.0 | 50.60
Output  | 0.061997   | 0.06208    | 0.062146   |   0.0 |  0.10
Modify  | 15.145     | 21.028     | 28.303     | 121.8 | 32.95
Other   |            | 8.773      |            |       | 13.75

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 66

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.17                                                               
Lattice spacing in x,y,z = 6.17 6.17 6.17

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -92.55 ${n1e1} -100 100 -100 100 units box
region box block -92.55 92.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.55 92.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-92.55 -100 -100) to (92.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-92.55 -100 -100) to (92.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-92.55 -100 -100) to (92.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_66_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 120 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.06 | 18.52 | 19.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   185.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   185.1          200            200            0.0023064964  -1.165262e-38   0              0.0069194891   12288.726      0              5.9337858e+10  2.6109412e-16  0              3.3264358    
    200000   185.1          200            200            0.00081880944 -2.3956714e-37  0              0.0024564283   3004.3743      0              1.4507048e+10  2.6109412e-16  0              3.0740438    
    300000   185.1          200            200            6.1089615e-05  8.6436699e-39  0              0.00018326884  34.307508      0              1.6565868e+08  2.6109412e-16  0              3.0457895    
    400000   185.1          200            200            0.0042089204   0.00011328054  0              0.012513481    210.20062      0              1.0149836e+09  2.6109412e-16  0              2.9943669    
    500000   185.1          200            200            0.0061415968   0.00038636053  0              0.01803843     12.549447      0              60596789       2.6109412e-16  0              2.9933467    
    600000   185.1          200            200            0.001867024   -3.1587433e-37  0              0.0056010721   0.0018748154   0              9052.8128      2.6109412e-16  0              2.9963756    
    700000   185.1          200            200            0.0026561834   5.6313598e-37  0              0.0079685502   0.42140915     0              2034834        2.6109412e-16  0              2.9954225    
    800000   185.1          200            200            0.002746248   -1.8042762e-37  0              0.0082387439   0.043148381    0              208348.09      2.6109412e-16  0              2.9953097    
    900000   185.1          200            200            0.002789878    7.4811756e-38  0              0.008369634    0.0022979493   0              11095.975      2.6109412e-16  0              2.9952629    
   1000000   185.1          200            200            0.0028157472   6.9094835e-38  0              0.0084472415   0.000231199    0              1116.3772      2.6109412e-16  0              2.9952333    
   1100000   185.1          200            200            0.0028255481  -1.0785642e-37  0              0.0084766444   1.4778089e-05  0              71.358102      2.6109412e-16  0              2.9952221    
   1200000   185.1          200            200            0.0028294104   3.1259886e-38  0              0.0084882311   5.5107129e-07  0              2.6609261      2.6109412e-16  0              2.9952177    
   1300000   185.1          200            200            0.0028308974  -2.075744e-39   0              0.0084926923   4.2066465e-10  0              0.002031239    2.6109412e-16  0              2.995216     
   1400000   185.1          200            200            0.0028314581  -2.3486043e-39  0              0.0084943742   7.3140463e-09  0              0.035316912    2.6109412e-16  0              2.9952154    
   1500000   185.1          200            200            0.0028316652  -4.1123286e-39  0              0.0084949957   4.2352607e-09  0              0.020450558    2.6109412e-16  0              2.9952151    
   1600000   185.1          200            200            0.0028317403  -7.3275019e-40  0              0.0084952209   1.2842631e-09  0              0.0062012469   2.6109412e-16  0              2.9952151    
   1700000   185.1          200            200            0.0028317669  -3.0916895e-39  0              0.0084953008   2.9929653e-10  0              0.0014451958   2.6109412e-16  0              2.995215     
   1800000   185.1          200            200            0.0028317762  -4.5332334e-39  0              0.0084953285   6.0119134e-11  0              0.00029029378  2.6109412e-16  0              2.995215     
   1900000   185.1          200            200            0.0028317793   7.6599949e-40  0              0.0084953379   1.0938522e-11  0              5.2818207e-05  2.6109412e-16  0              2.995215     
   2000000   185.1          200            200            0.0028317803   3.2415734e-40  0              0.008495341    1.8500927e-12  0              8.9334356e-06  2.6109412e-16  0              2.995215     
   2100000   185.1          200            200            0.0028317807  -4.1887729e-39  0              0.008495342    2.9514837e-13  0              1.4251658e-06  2.6109412e-16  0              2.995215     
   2200000   185.1          200            200            0.0028317808   2.2164393e-39  0              0.0084953423   4.4805281e-14  0              2.1634867e-07  2.6109412e-16  0              2.995215     
   2300000   185.1          200            200            0.0028317808   7.0610931e-39  0              0.0084953424   6.5154252e-15  0              3.1460656e-08  2.6109412e-16  0              2.995215     
   2400000   185.1          200            200            0.0028317808   6.1908918e-39  0              0.0084953424   9.0938184e-16  0              4.3910795e-09  2.6109412e-16  0              2.995215     
   2500000   185.1          200            200            0.0028317808  -2.0506844e-39  0              0.0084953424   1.2179969e-16  0              5.8812711e-10  2.6109412e-16  0              2.995215     
   2600000   185.1          200            200            0.0028317808  -1.007089e-39   0              0.0084953424   1.5479272e-17  0              7.4743862e-11  2.6109412e-16  0              2.995215     
   2700000   185.1          200            200            0.0028317808   4.3368865e-39  0              0.0084953424   1.9324687e-18  0              9.3311996e-12  2.6109412e-16  0              2.995215     
   2800000   185.1          200            200            0.0028317808   7.3323863e-39  0              0.0084953424   1.7354389e-19  0              8.3798135e-13  2.6109412e-16  0              2.995215     
   2900000   185.1          200            200            0.0028317808  -1.1658541e-39  0              0.0084953424   6.466993e-20   0              3.1226795e-13  2.6109412e-16  0              2.995215     
   3000000   185.1          200            200            0.0028317808  -6.9955054e-39  0              0.0084953424   9.5663012e-20  0              4.6192245e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8996 on 4 procs for 3000000 steps with 51 atoms

Performance: 40563633.245 ns/day, 0.000 hours/ns, 46948.650 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30482    | 1.5035     | 4.8964     | 159.8 |  2.35
Neigh   | 0.093081   | 0.093611   | 0.095157   |   0.3 |  0.15
Comm    | 25.603     | 32.433     | 38.252     |  86.2 | 50.76
Output  | 0.060528   | 0.060608   | 0.06067    |   0.0 |  0.09
Modify  | 15.145     | 21.077     | 28.518     | 123.3 | 32.99
Other   |            | 8.732      |            |       | 13.66

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 67

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.18                                                               
Lattice spacing in x,y,z = 6.18 6.18 6.18

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -92.7 ${n1e1} -100 100 -100 100 units box
region box block -92.7 92.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.7 92.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-92.7 -100 -100) to (92.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-92.7 -100 -100) to (92.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-92.7 -100 -100) to (92.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_67_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 120 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.06 | 18.52 | 19.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   185.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   185.4          200            200            0.0023011483  -7.9721098e-38  0              0.0069034449   12276.065      0              5.9276725e+10  2.6109412e-16  0              3.3268235    
    200000   185.4          200            200            0.00081268452  2.1383642e-37  0              0.0024380536   2976.7796      0              1.4373803e+10  2.6109412e-16  0              3.0751758    
    300000   185.4          200            200            5.5991567e-05 -2.0754873e-37  0              0.0001679747   29.149913      0              1.407545e+08   2.6109412e-16  0              3.0457214    
    400000   185.4          200            200            0.0020643897  -1.2133378e-35  0              0.0061931692   207.14943      0              1.0002504e+09  2.6109412e-16  0              2.9963224    
    500000   185.4          200            200            0.00076952082 -8.20163e-36    0              0.0023085625   7.6762878      0              37066046       2.6109412e-16  0              2.99804      
    600000   185.4          200            200            0.0022979654  -2.8670496e-36  0              0.0068938961   2.8022562      0              13531093       2.6109412e-16  0              2.9958137    
    700000   185.4          200            200            0.0025749884  -1.5971906e-36  0              0.0077249653   0.27008059     0              1304122.5      2.6109412e-16  0              2.9954984    
    800000   185.4          200            200            0.0027495556   7.7695162e-37  0              0.0082486669   0.047933386    0              231453.17      2.6109412e-16  0              2.9953007    
    900000   185.4          200            200            0.0028044936   7.2842985e-38  0              0.0084134808   0.0077520393   0              37431.823      2.6109412e-16  0              2.9952397    
   1000000   185.4          200            200            0.0028211428   2.420858e-38   0              0.0084634285   0.0011858988   0              5726.2811      2.6109412e-16  0              2.9952215    
   1100000   185.4          200            200            0.0028258567   1.0795869e-38  0              0.00847757     0.00017333624  0              836.97865      2.6109412e-16  0              2.9952164    
   1200000   185.4          200            200            0.00282704    -6.6200927e-40  0              0.0084811201   2.4308686e-05  0              117.37795      2.6109412e-16  0              2.9952151    
   1300000   185.4          200            200            0.0028272646  -1.9032115e-39  0              0.0084817939   3.2763547e-06  0              15.820344      2.6109412e-16  0              2.9952149    
   1400000   185.4          200            200            0.0028272682  -2.8365776e-40  0              0.0084818045   4.2435869e-07  0              2.0490762      2.6109412e-16  0              2.9952149    
   1500000   185.4          200            200            0.0028272403  -2.6725869e-39  0              0.008481721    5.2724477e-08  0              0.25458763     2.6109412e-16  0              2.995215     
   1600000   185.4          200            200            0.0028272196   1.2145594e-39  0              0.0084816588   6.2603743e-09  0              0.030229107    2.6109412e-16  0              2.995215     
   1700000   185.4          200            200            0.0028272083   1.8654059e-40  0              0.0084816248   7.0584694e-10  0              0.0034082823   2.6109412e-16  0              2.995215     
   1800000   185.4          200            200            0.0028272028   7.9570418e-39  0              0.0084816085   7.4777022e-11  0              0.00036107148  2.6109412e-16  0              2.995215     
   1900000   185.4          200            200            0.0028272004   1.6802346e-39  0              0.0084816011   7.3135934e-12  0              3.5314725e-05  2.6109412e-16  0              2.995215     
   2000000   185.4          200            200            0.0028271993  -1.1845308e-39  0              0.008481598    6.3985306e-13  0              3.0896214e-06  2.6109412e-16  0              2.995215     
   2100000   185.4          200            200            0.0028271989  -6.3059828e-40  0              0.0084815967   4.6993533e-14  0              2.2691495e-07  2.6109412e-16  0              2.995215     
   2200000   185.4          200            200            0.0028271987   7.5047373e-39  0              0.0084815962   2.4691398e-15  0              1.1922592e-08  2.6109412e-16  0              2.995215     
   2300000   185.4          200            200            0.0028271987   7.4393057e-39  0              0.008481596    4.6703163e-17  0              2.2551286e-10  2.6109412e-16  0              2.995215     
   2400000   185.4          200            200            0.0028271987   8.433847e-40   0              0.008481596    3.4702728e-18  0              1.6756705e-11  2.6109412e-16  0              2.995215     
   2500000   185.4          200            200            0.0028271986   4.3464279e-39  0              0.0084815959   4.9532817e-18  0              2.3917625e-11  2.6109412e-16  0              2.995215     
   2600000   185.4          200            200            0.0028271986   2.9991126e-39  0              0.0084815959   1.9617217e-18  0              9.4724519e-12  2.6109412e-16  0              2.995215     
   2700000   185.4          200            200            0.0028271986   4.2908074e-39  0              0.0084815959   3.7429322e-19  0              1.807328e-12   2.6109412e-16  0              2.995215     
   2800000   185.4          200            200            0.0028271986   5.73917e-39    0              0.0084815959   1.0022116e-19  0              4.8393212e-13  2.6109412e-16  0              2.995215     
   2900000   185.4          200            200            0.0028271986  -6.7718767e-39  0              0.0084815959   2.0604001e-20  0              9.9489345e-14  2.6109412e-16  0              2.995215     
   3000000   185.4          200            200            0.0028271986  -2.4815231e-39  0              0.0084815959   1.5019037e-20  0              7.2521553e-14  2.6109412e-16  0              2.995215     
Loop time of 64.1083 on 4 procs for 3000000 steps with 51 atoms

Performance: 40431592.677 ns/day, 0.000 hours/ns, 46795.825 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.34643    | 1.5058     | 4.8254     | 156.2 |  2.35
Neigh   | 0.093005   | 0.093634   | 0.095224   |   0.3 |  0.15
Comm    | 25.682     | 32.523     | 38.328     |  86.5 | 50.73
Output  | 0.063583   | 0.063667   | 0.06373    |   0.0 |  0.10
Modify  | 15.183     | 21.139     | 28.632     | 123.8 | 32.97
Other   |            | 8.783      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.56862745
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 68

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.19                                                               
Lattice spacing in x,y,z = 6.19 6.19 6.19

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -92.85 ${n1e1} -100 100 -100 100 units box
region box block -92.85 92.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -92.85 92.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-92.85 -100 -100) to (92.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-92.85 -100 -100) to (92.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-92.85 -100 -100) to (92.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_68_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 120 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.06 | 18.52 | 19.68 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   185.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   185.7          200            200            0.0022958136   3.1051967e-41  0              0.0068874408   12263.339      0              6.579475e+10   2.6109412e-16  0              3.3272271    
    200000   185.7          200            200            0.00080665206 -4.1929228e-37  0              0.0024199562   2949.6624      0              1.5825405e+10  2.6109412e-16  0              3.0763049    
    300000   185.7          200            200            5.1096912e-05 -1.8998729e-36  0              0.00015329074  24.549531      0              1.3171211e+08  2.6109412e-16  0              3.0456284    
    400000   185.7          200            200            0.000649194   -2.113311e-37   0              0.001947582    178.0024       0              9.5501101e+08  2.6109412e-16  0              2.9984848    
    500000   185.7          200            200            0.002091755    2.4652072e-36  0              0.006275265    27.594949      0              1.4805126e+08  2.6109412e-16  0              2.9960218    
    600000   185.7          200            200            0.002030799   -4.83242e-36    0              0.0060923969   1.1867978      0              6367357.7      2.6109412e-16  0              2.9961456    
    700000   185.7          200            200            0.0025800613  -2.8164549e-36  0              0.0077401838   0.29179892     0              1565547.3      2.6109412e-16  0              2.9954874    
    800000   185.7          200            200            0.002749134    2.5135501e-37  0              0.008247402    0.05075396     0              272303.01      2.6109412e-16  0              2.995296     
    900000   185.7          200            200            0.0028016023  -2.6680949e-38  0              0.008404807    0.0080851327   0              43378.014      2.6109412e-16  0              2.9952378    
   1000000   185.7          200            200            0.0028172317   1.5140955e-38  0              0.008451695    0.001221003    0              6550.8738      2.6109412e-16  0              2.9952207    
   1100000   185.7          200            200            0.0028215401  -1.2119644e-38  0              0.0084646203   0.00017639192  0              946.3705       2.6109412e-16  0              2.9952161    
   1200000   185.7          200            200            0.0028225665  -1.9859397e-40  0              0.0084676996   2.4464131e-05  0              131.25393      2.6109412e-16  0              2.995215     
   1300000   185.7          200            200            0.0028227317  -1.3604521e-39  0              0.0084681951   3.2613007e-06  0              17.497393      2.6109412e-16  0              2.9952149    
   1400000   185.7          200            200            0.0028227132   6.1016972e-39  0              0.0084681395   4.1766035e-07  0              2.2408137      2.6109412e-16  0              2.9952149    
   1500000   185.7          200            200            0.0028226773  -2.6106783e-39  0              0.008468032    5.1266598e-08  0              0.27505339     2.6109412e-16  0              2.995215     
   1600000   185.7          200            200            0.0028226538  -4.019607e-40   0              0.0084679613   6.0050523e-09  0              0.032218054    2.6109412e-16  0              2.995215     
   1700000   185.7          200            200            0.0028226414   4.3617095e-39  0              0.0084679242   6.6629824e-10  0              0.0035747953   2.6109412e-16  0              2.995215     
   1800000   185.7          200            200            0.0028226356   1.7694696e-39  0              0.0084679069   6.9188756e-11  0              0.0003712086   2.6109412e-16  0              2.995215     
   1900000   185.7          200            200            0.0028226331   1.1393385e-40  0              0.0084678992   6.5869986e-12  0              3.5340287e-05  2.6109412e-16  0              2.995215     
   2000000   185.7          200            200            0.002822632   -5.8910283e-40  0              0.008467896    5.5369798e-13  0              2.9706771e-06  2.6109412e-16  0              2.995215     
   2100000   185.7          200            200            0.0028226316   5.4758752e-39  0              0.0084678947   3.7928936e-14  0              2.0349473e-07  2.6109412e-16  0              2.995215     
   2200000   185.7          200            200            0.0028226314   2.5555156e-39  0              0.0084678941   1.6994992e-15  0              9.1180816e-09  2.6109412e-16  0              2.995215     
   2300000   185.7          200            200            0.0028226313   1.3891644e-38  0              0.0084678939   1.3389446e-17  0              7.1836493e-11  2.6109412e-16  0              2.995215     
   2400000   185.7          200            200            0.0028226313  -1.9891426e-39  0              0.0084678939   9.2637789e-18  0              4.9701637e-11  2.6109412e-16  0              2.995215     
   2500000   185.7          200            200            0.0028226313   3.047525e-39   0              0.0084678938   6.4747418e-18  0              3.4738012e-11  2.6109412e-16  0              2.995215     
   2600000   185.7          200            200            0.0028226313   9.9315972e-39  0              0.0084678938   2.3383557e-18  0              1.2545648e-11  2.6109412e-16  0              2.995215     
   2700000   185.7          200            200            0.0028226313   4.2366356e-40  0              0.0084678938   5.2625791e-19  0              2.8234568e-12  2.6109412e-16  0              2.995215     
   2800000   185.7          200            200            0.0028226313   5.237348e-39   0              0.0084678938   1.6663533e-19  0              8.9402486e-13  2.6109412e-16  0              2.995215     
   2900000   185.7          200            200            0.0028226313  -5.4803712e-39  0              0.0084678938   1.1293344e-21  0              6.0590571e-15  2.6109412e-16  0              2.995215     
   3000000   185.7          200            200            0.0028226313   1.0602137e-38  0              0.0084678938   7.6400734e-20  0              4.09902e-13    2.6109412e-16  0              2.995215     
Loop time of 63.2519 on 4 procs for 3000000 steps with 50 atoms

Performance: 40979010.793 ns/day, 0.000 hours/ns, 47429.411 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30785    | 1.4759     | 4.7629     | 156.3 |  2.33
Neigh   | 0.092945   | 0.093554   | 0.095001   |   0.3 |  0.15
Comm    | 25.25      | 31.762     | 37.298     |  83.9 | 50.21
Output  | 0.061588   | 0.061669   | 0.061734   |   0.0 |  0.10
Modify  | 15.29      | 21.063     | 28.184     | 119.6 | 33.30
Other   |            | 8.796      |            |       | 13.91

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           7.25 ave          29 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 29
Ave neighs/atom = 0.58
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 69

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.2                                                               
Lattice spacing in x,y,z = 6.2 6.2 6.2

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93 ${n1e1} -100 100 -100 100 units box
region box block -93 93 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93 93 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93 -100 -100) to (93 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-93 -100 -100) to (93 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93 -100 -100) to (93 100 100)
  create_atoms CPU = 0.002 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_69_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 120 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.11 | 18.58 | 19.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   186            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   186            200            200            0.0022904324   7.9550173e-38  0              0.0068712972   12249.992      0              5.9150828e+10  2.6109412e-16  0              3.3276936    
    200000   186            200            200            0.00080098817 -3.1330995e-37  0              0.0024029645   2924.6365      0              1.4122023e+10  2.6109412e-16  0              3.0773326    
    300000   186            200            200            4.6146291e-05  6.5316625e-39  0              0.00013843887  20.253445      0              97796636       2.6109412e-16  0              3.0455229    
    400000   186            200            200            0.00012309254 -1.9479048e-37  0              0.00036927761  131.35182      0              6.3425093e+08  2.6109412e-16  0              3.0007073    
    500000   186            200            200            0.005414898    6.721301e-05   0              0.016177481    8.5958762      0              41506410       2.6109412e-16  0              2.9928231    
    600000   186            200            200            0.0033041536   2.1097975e-37  0              0.0099124607   3.0605018      0              14778068       2.6109412e-16  0              2.9946974    
    700000   186            200            200            0.002923116    2.444074e-36   0              0.0087693481   0.49725201     0              2401052        2.6109412e-16  0              2.9951044    
    800000   186            200            200            0.0028380178  -9.1567987e-39  0              0.0085140534   0.071687165    0              346151.66      2.6109412e-16  0              2.9951954    
    900000   186            200            200            0.0028187176  -2.441962e-38   0              0.0084561527   0.0098992143   0              47799.763      2.6109412e-16  0              2.9952154    
   1000000   186            200            200            0.0028158392  -2.0826233e-38  0              0.0084475176   0.0013149413   0              6349.3812      2.6109412e-16  0              2.9952179    
   1100000   186            200            200            0.002816357    2.4630968e-38  0              0.0084490709   0.00016781779  0              810.33205      2.6109412e-16  0              2.9952171    
   1200000   186            200            200            0.0028171268  -3.0329198e-38  0              0.0084513804   2.0522701e-05  0              99.096779      2.6109412e-16  0              2.9952161    
   1300000   186            200            200            0.0028176181   2.8820351e-38  0              0.0084528543   2.3937371e-06  0              11.5585        2.6109412e-16  0              2.9952156    
   1400000   186            200            200            0.0028178719  -1.0130506e-39  0              0.0084536158   2.6425732e-07  0              1.276004       2.6109412e-16  0              2.9952153    
   1500000   186            200            200            0.0028179904   4.2663036e-39  0              0.0084539711   2.7264911e-08  0              0.1316525      2.6109412e-16  0              2.9952151    
   1600000   186            200            200            0.0028180423   1.7210841e-38  0              0.0084541269   2.5730679e-09  0              0.012424424    2.6109412e-16  0              2.9952151    
   1700000   186            200            200            0.0028180641  -1.0970049e-39  0              0.0084541924   2.1340809e-10  0              0.0010304713   2.6109412e-16  0              2.995215     
   1800000   186            200            200            0.002818073   -2.6490165e-39  0              0.0084542189   1.427243e-11   0              6.8916455e-05  2.6109412e-16  0              2.995215     
   1900000   186            200            200            0.0028180765  -6.8272862e-40  0              0.0084542294   6.011325e-13   0              2.9026537e-06  2.6109412e-16  0              2.995215     
   2000000   186            200            200            0.0028180778   3.1487222e-39  0              0.0084542335   2.872575e-15   0              1.3870637e-08  2.6109412e-16  0              2.995215     
   2100000   186            200            200            0.0028180783   9.689302e-39   0              0.008454235    4.3476346e-15  0              2.0993171e-08  2.6109412e-16  0              2.995215     
   2200000   186            200            200            0.0028180785   5.6998484e-39  0              0.0084542356   3.0548331e-15  0              1.4750696e-08  2.6109412e-16  0              2.995215     
   2300000   186            200            200            0.0028180786   3.0984391e-40  0              0.0084542358   9.7799907e-16  0              4.7224075e-09  2.6109412e-16  0              2.995215     
   2400000   186            200            200            0.0028180786   3.4781863e-39  0              0.0084542359   2.3645131e-16  0              1.1417388e-09  2.6109412e-16  0              2.995215     
   2500000   186            200            200            0.0028180786   4.0396053e-39  0              0.0084542359   4.8737017e-17  0              2.3533361e-10  2.6109412e-16  0              2.995215     
   2600000   186            200            200            0.0028180786  -9.5757542e-39  0              0.0084542359   9.0768867e-18  0              4.3829038e-11  2.6109412e-16  0              2.995215     
   2700000   186            200            200            0.0028180786  -2.9704105e-39  0              0.0084542359   1.395733e-18   0              6.739495e-12   2.6109412e-16  0              2.995215     
   2800000   186            200            200            0.0028180786  -4.2833971e-39  0              0.0084542359   2.7430558e-19  0              1.3245235e-12  2.6109412e-16  0              2.995215     
   2900000   186            200            200            0.0028180786   1.6333082e-38  0              0.0084542359   3.4815349e-21  0              1.6811086e-14  2.6109412e-16  0              2.995215     
   3000000   186            200            200            0.0028180786  -7.3605704e-39  0              0.0084542359   7.431785e-20   0              3.588543e-13   2.6109412e-16  0              2.995215     
Loop time of 64.1312 on 4 procs for 3000000 steps with 51 atoms

Performance: 40417164.999 ns/day, 0.000 hours/ns, 46779.126 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30472    | 1.4934     | 4.8158     | 157.0 |  2.33
Neigh   | 0.095272   | 0.095826   | 0.097242   |   0.3 |  0.15
Comm    | 25.768     | 32.624     | 38.437     |  86.5 | 50.87
Output  | 0.060804   | 0.060882   | 0.060944   |   0.0 |  0.09
Modify  | 15.169     | 21.131     | 28.599     | 123.5 | 32.95
Other   |            | 8.726      |            |       | 13.61

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 70

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.21                                                               
Lattice spacing in x,y,z = 6.21 6.21 6.21

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93.15 ${n1e1} -100 100 -100 100 units box
region box block -93.15 93.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.15 93.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93.15 -100 -100) to (93.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-93.15 -100 -100) to (93.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93.15 -100 -100) to (93.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_70_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 121 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.07 | 18.54 | 19.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   186.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   186.3          200            200            0.002285017   -1.4547953e-37  0              0.0068550511   12236.124      0              5.9083864e+10  2.6109412e-16  0              3.328219     
    200000   186.3          200            200            0.00079600018 -1.2660385e-36  0              0.0023880005   2903.4943      0              1.4019935e+10  2.6109412e-16  0              3.0781466    
    300000   186.3          200            200            4.1009529e-05 -1.0435111e-36  0              0.00012302859  16.187602      0              78164136       2.6109412e-16  0              3.0454095    
    400000   186.3          200            200            9.6925107e-05  4.5015623e-37  0              0.00029077532  84.775323      0              4.0934969e+08  2.6109412e-16  0              3.0028112    
    500000   186.3          200            200            0.00090803998  2.4758286e-36  0              0.0027241199   9.7565933      0              47111097       2.6109412e-16  0              2.9978016    
    600000   186.3          200            200            0.0018972272   1.1262676e-35  0              0.0056916816   0.1458888      0              704444.8       2.6109412e-16  0              2.9963166    
    700000   186.3          200            200            0.0024917306  -5.7324429e-37  0              0.0074751918   0.094890343    0              458191.51      2.6109412e-16  0              2.9955841    
    800000   186.3          200            200            0.0027039368  -1.0832246e-36  0              0.0081118104   0.022591577    0              109086.64      2.6109412e-16  0              2.9953386    
    900000   186.3          200            200            0.0027773053  -2.5553473e-37  0              0.008331916    0.0044342482   0              21411.398      2.6109412e-16  0              2.9952555    
   1000000   186.3          200            200            0.0028019872  -6.9404525e-37  0              0.0084059617   0.00078899813  0              3809.7896      2.6109412e-16  0              2.9952278    
   1100000   186.3          200            200            0.0028100288   3.5299128e-38  0              0.0084300864   0.00013096754  0              632.3954       2.6109412e-16  0              2.9952189    
   1200000   186.3          200            200            0.0028125458   4.7680599e-39  0              0.0084376373   2.0566334e-05  0              99.307468      2.6109412e-16  0              2.9952161    
   1300000   186.3          200            200            0.0028132911  -5.390694e-39   0              0.0084398733   3.0799514e-06  0              14.871983      2.6109412e-16  0              2.9952153    
   1400000   186.3          200            200            0.0028134935   6.2100908e-41  0              0.0084404805   4.419463e-07   0              2.1340005      2.6109412e-16  0              2.9952151    
   1500000   186.3          200            200            0.0028135401  -4.5545166e-39  0              0.0084406202   6.0913441e-08  0              0.29412921     2.6109412e-16  0              2.995215     
   1600000   186.3          200            200            0.0028135466   3.3662184e-39  0              0.0084406399   8.07048e-09    0              0.03896946     2.6109412e-16  0              2.995215     
   1700000   186.3          200            200            0.0028135451   1.0768415e-38  0              0.0084406353   1.0269707e-09  0              0.0049588739   2.6109412e-16  0              2.995215     
   1800000   186.3          200            200            0.0028135431  -3.9501994e-39  0              0.0084406292   1.2518967e-10  0              0.00060449613  2.6109412e-16  0              2.995215     
   1900000   186.3          200            200            0.0028135418   7.2372835e-39  0              0.0084406255   1.4549495e-11  0              7.0254307e-05  2.6109412e-16  0              2.995215     
   2000000   186.3          200            200            0.0028135412  -1.1078579e-38  0              0.0084406236   1.5992687e-12  0              7.7222964e-06  2.6109412e-16  0              2.995215     
   2100000   186.3          200            200            0.0028135409  -2.2216544e-39  0              0.0084406227   1.6406949e-13  0              7.9223283e-07  2.6109412e-16  0              2.995215     
   2200000   186.3          200            200            0.0028135408   2.4063691e-39  0              0.0084406223   1.5375061e-14  0              7.4240669e-08  2.6109412e-16  0              2.995215     
   2300000   186.3          200            200            0.0028135407   9.0299812e-39  0              0.0084406221   1.2637241e-15  0              6.1020716e-09  2.6109412e-16  0              2.995215     
   2400000   186.3          200            200            0.0028135407   1.2712116e-38  0              0.0084406221   8.5461244e-17  0              4.1266176e-10  2.6109412e-16  0              2.995215     
   2500000   186.3          200            200            0.0028135407   1.9016379e-39  0              0.008440622    3.7263829e-18  0              1.799337e-11   2.6109412e-16  0              2.995215     
   2600000   186.3          200            200            0.0028135407  -2.1572922e-40  0              0.008440622    3.6411254e-21  0              1.7581692e-14  2.6109412e-16  0              2.995215     
   2700000   186.3          200            200            0.0028135407  -3.5330398e-39  0              0.008440622    5.3445052e-20  0              2.5806703e-13  2.6109412e-16  0              2.995215     
   2800000   186.3          200            200            0.0028135407   6.8696472e-39  0              0.008440622    5.9896705e-20  0              2.8921975e-13  2.6109412e-16  0              2.995215     
   2900000   186.3          200            200            0.0028135407  -3.7066507e-39  0              0.008440622    1.2905882e-21  0              6.2317883e-15  2.6109412e-16  0              2.995215     
   3000000   186.3          200            200            0.0028135407  -2.1423659e-39  0              0.008440622    5.8247095e-20  0              2.8125438e-13  2.6109412e-16  0              2.995215     
Loop time of 64.27 on 4 procs for 3000000 steps with 51 atoms

Performance: 40329867.351 ns/day, 0.000 hours/ns, 46678.087 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29733    | 1.5202     | 4.9349     | 160.0 |  2.37
Neigh   | 0.093856   | 0.094399   | 0.095907   |   0.3 |  0.15
Comm    | 25.713     | 32.719     | 38.521     |  87.5 | 50.91
Output  | 0.060911   | 0.060994   | 0.061056   |   0.0 |  0.09
Modify  | 15.157     | 21.169     | 28.784     | 124.9 | 32.94
Other   |            | 8.706      |            |       | 13.55

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 71

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.22                                                               
Lattice spacing in x,y,z = 6.22 6.22 6.22

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93.3 ${n1e1} -100 100 -100 100 units box
region box block -93.3 93.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.3 93.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93.3 -100 -100) to (93.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-93.3 -100 -100) to (93.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93.3 -100 -100) to (93.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_71_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 121 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.07 | 18.54 | 19.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   186.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   186.6          200            200            0.002279584   -6.5953085e-39  0              0.0068387521   12221.874      0              5.9015054e+10  2.6109412e-16  0              3.3287956    
    200000   186.6          200            200            0.00079137707  4.7417353e-39  0              0.0023741312   2884.423       0              1.3927846e+10  2.6109412e-16  0              3.0788471    
    300000   186.6          200            200            3.5504049e-05 -1.933662e-37   0              0.00010651215  12.289506      0              59341627       2.6109412e-16  0              3.0452928    
    400000   186.6          200            200            6.8369491e-05 -3.8945773e-37  0              0.00020510847  44.190502      0              2.1338012e+08  2.6109412e-16  0              3.0046205    
    500000   186.6          200            200            0.0011151264   6.090631e-38   0              0.0033453791   15.086604      0              72847813       2.6109412e-16  0              2.9973609    
    600000   186.6          200            200            0.0029783911   1.418818e-36   0              0.0089351734   3.8702819      0              18688206       2.6109412e-16  0              2.9950035    
    700000   186.6          200            200            0.0029608237   3.7162566e-37  0              0.008882471    0.44150415     0              2131865.5      2.6109412e-16  0              2.9950368    
    800000   186.6          200            200            0.0028831759   1.2398583e-37  0              0.0086495278   0.049485148    0              238946.07      2.6109412e-16  0              2.9951287    
    900000   186.6          200            200            0.002841741   -3.4482441e-36  0              0.0085252229   0.005293974    0              25562.706      2.6109412e-16  0              2.9951771    
   1000000   186.6          200            200            0.0028227736   8.2290611e-38  0              0.0084683208   0.00052735984  0              2546.4319      2.6109412e-16  0              2.9951991    
   1100000   186.6          200            200            0.0028146075   5.1090532e-38  0              0.0084438225   4.747561e-05   0              229.24273      2.6109412e-16  0              2.9952086    
   1200000   186.6          200            200            0.0028112281  -4.321022e-39   0              0.0084336843   3.6586259e-06  0              17.666195      2.6109412e-16  0              2.9952125    
   1300000   186.6          200            200            0.0028098714   2.6936555e-39  0              0.0084296142   2.1263457e-07  0              1.0267362      2.6109412e-16  0              2.995214     
   1400000   186.6          200            200            0.0028093403   1.9025983e-39  0              0.008428021    5.9440732e-09  0              0.028701802    2.6109412e-16  0              2.9952146    
   1500000   186.6          200            200            0.002809137   -4.2626308e-39  0              0.0084274111   3.8866363e-11  0              0.00018767176  2.6109412e-16  0              2.9952149    
   1600000   186.6          200            200            0.0028090608   1.5312499e-38  0              0.0084271825   2.2424527e-10  0              0.0010828001   2.6109412e-16  0              2.995215     
   1700000   186.6          200            200            0.0028090328   1.4023598e-38  0              0.0084270984   1.0131325e-10  0              0.00048920542  2.6109412e-16  0              2.995215     
   1800000   186.6          200            200            0.0028090227  -1.0498613e-39  0              0.0084270681   2.8156118e-11  0              0.00013595582  2.6109412e-16  0              2.995215     
   1900000   186.6          200            200            0.0028090191   1.395011e-38   0              0.0084270574   6.267521e-12   0              3.0263616e-05  2.6109412e-16  0              2.995215     
   2000000   186.6          200            200            0.0028090179   6.1882874e-39  0              0.0084270537   1.2226486e-12  0              5.9037325e-06  2.6109412e-16  0              2.995215     
   2100000   186.6          200            200            0.0028090175   7.0874216e-39  0              0.0084270525   2.1783185e-13  0              1.0518321e-06  2.6109412e-16  0              2.995215     
   2200000   186.6          200            200            0.0028090174   1.8098561e-39  0              0.0084270521   3.6251787e-14  0              1.750469e-07   2.6109412e-16  0              2.995215     
   2300000   186.6          200            200            0.0028090173   2.1767189e-38  0              0.0084270519   5.704249e-15   0              2.7543777e-08  2.6109412e-16  0              2.995215     
   2400000   186.6          200            200            0.0028090173   9.3731161e-40  0              0.0084270519   8.5660668e-16  0              4.1362471e-09  2.6109412e-16  0              2.995215     
   2500000   186.6          200            200            0.0028090173   1.6972634e-38  0              0.0084270519   1.2317002e-16  0              5.9474393e-10  2.6109412e-16  0              2.995215     
   2600000   186.6          200            200            0.0028090173  -2.2565162e-38  0              0.0084270519   1.6946191e-17  0              8.1827094e-11  2.6109412e-16  0              2.995215     
   2700000   186.6          200            200            0.0028090173   6.220364e-39   0              0.0084270519   2.2255084e-18  0              1.0746184e-11  2.6109412e-16  0              2.995215     
   2800000   186.6          200            200            0.0028090173   1.7502572e-38  0              0.0084270519   2.483945e-19   0              1.1994081e-12  2.6109412e-16  0              2.995215     
   2900000   186.6          200            200            0.0028090173   9.6789605e-39  0              0.0084270519   1.2857885e-19  0              6.2086127e-13  2.6109412e-16  0              2.995215     
   3000000   186.6          200            200            0.0028090173  -2.335562e-39   0              0.0084270519   2.0556102e-21  0              9.9258061e-15  2.6109412e-16  0              2.995215     
Loop time of 63.8302 on 4 procs for 3000000 steps with 51 atoms

Performance: 40607753.829 ns/day, 0.000 hours/ns, 46999.715 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31635    | 1.5184     | 4.9585     | 161.2 |  2.38
Neigh   | 0.093755   | 0.094336   | 0.095911   |   0.3 |  0.15
Comm    | 25.745     | 32.358     | 38.094     |  84.4 | 50.69
Output  | 0.061002   | 0.061083   | 0.061144   |   0.0 |  0.10
Modify  | 15.137     | 21.045     | 28.34      | 122.2 | 32.97
Other   |            | 8.753      |            |       | 13.71

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 72

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.23                                                               
Lattice spacing in x,y,z = 6.23 6.23 6.23

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93.45 ${n1e1} -100 100 -100 100 units box
region box block -93.45 93.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.45 93.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93.45 -100 -100) to (93.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-93.45 -100 -100) to (93.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93.45 -100 -100) to (93.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_72_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 121 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.07 | 18.54 | 19.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   186.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   186.9          200            200            0.0022741554  -2.6343708e-38  0              0.0068224661   12207.434      0              5.8945329e+10  2.6109412e-16  0              3.3294104    
    200000   186.9          200            200            0.00078711954  1.6940975e-36  0              0.0023613586   2867.4281      0              1.3845784e+10  2.6109412e-16  0              3.0794303    
    300000   186.9          200            200            2.9649049e-05 -1.8800077e-36  0              8.8947146e-05  8.6892063      0              41957067       2.6109412e-16  0              3.0451683    
    400000   186.9          200            200            3.8022597e-05 -1.2316548e-36  0              0.00011406779  14.422573      0              69641442       2.6109412e-16  0              3.0059075    
    500000   186.9          200            200            0.0037435863   8.4444054e-35  0              0.011230759    25.709829      0              1.2414357e+08  2.6109412e-16  0              2.9941496    
    600000   186.9          200            200            0.0037816997  -8.2325391e-36  0              0.011345099    0.18846715     0              910040.41      2.6109412e-16  0              2.9941541    
    700000   186.9          200            200            0.0031661327   2.8164896e-37  0              0.0094983982   0.00038682736  0              1867.8509      2.6109412e-16  0              2.9948118    
    800000   186.9          200            200            0.0029345214   1.318999e-36   0              0.0088035642   0.0023664584   0              11426.781      2.6109412e-16  0              2.9950686    
    900000   186.9          200            200            0.0028505468   3.4498433e-37  0              0.0085516404   0.00099678325  0              4813.1096      2.6109412e-16  0              2.9951631    
   1000000   186.9          200            200            0.0028204959  -2.6391544e-38  0              0.0084614877   0.00026782488  0              1293.2305      2.6109412e-16  0              2.995197     
   1100000   186.9          200            200            0.0028099306   7.9023475e-38  0              0.0084297917   5.850944e-05   0              282.52114      2.6109412e-16  0              2.9952089    
   1200000   186.9          200            200            0.0028062956   6.4776315e-40  0              0.0084188867   1.1276941e-05  0              54.452312      2.6109412e-16  0              2.995213     
   1300000   186.9          200            200            0.0028050767  -2.6342677e-39  0              0.00841523     1.9919036e-06  0              9.6181897      2.6109412e-16  0              2.9952144    
   1400000   186.9          200            200            0.0028046806   1.0737607e-38  0              0.0084140417   3.2918266e-07  0              1.5895053      2.6109412e-16  0              2.9952148    
   1500000   186.9          200            200            0.0028045569   8.3510261e-39  0              0.0084136708   5.1521959e-08  0              0.2487811      2.6109412e-16  0              2.995215     
   1600000   186.9          200            200            0.0028045205   4.1413707e-39  0              0.0084135614   7.6942213e-09  0              0.037152641    2.6109412e-16  0              2.995215     
   1700000   186.9          200            200            0.0028045106   1.2222038e-38  0              0.0084135319   1.1012457e-09  0              0.0053175214   2.6109412e-16  0              2.995215     
   1800000   186.9          200            200            0.0028045084  -3.9865332e-39  0              0.0084135252   1.514146e-10   0              0.00073112693  2.6109412e-16  0              2.995215     
   1900000   186.9          200            200            0.0028045081   1.6423894e-38  0              0.0084135244   2.0012482e-11  0              9.6633115e-05  2.6109412e-16  0              2.995215     
   2000000   186.9          200            200            0.0028045082   2.6280911e-39  0              0.0084135246   2.5402304e-12  0              1.2265863e-05  2.6109412e-16  0              2.995215     
   2100000   186.9          200            200            0.0028045083  -8.3408891e-40  0              0.0084135249   3.0876606e-13  0              1.4909208e-06  2.6109412e-16  0              2.995215     
   2200000   186.9          200            200            0.0028045084   1.596283e-38   0              0.0084135251   3.5770672e-14  0              1.7272377e-07  2.6109412e-16  0              2.995215     
   2300000   186.9          200            200            0.0028045084   1.0187662e-38  0              0.0084135252   3.9265816e-15  0              1.8960057e-08  2.6109412e-16  0              2.995215     
   2400000   186.9          200            200            0.0028045084   1.3333849e-41  0              0.0084135253   3.9756921e-16  0              1.9197194e-09  2.6109412e-16  0              2.995215     
   2500000   186.9          200            200            0.0028045084  -2.2763079e-38  0              0.0084135253   3.6484701e-17  0              1.7617156e-10  2.6109412e-16  0              2.995215     
   2600000   186.9          200            200            0.0028045084   2.2689653e-38  0              0.0084135253   2.6073404e-18  0              1.2589913e-11  2.6109412e-16  0              2.995215     
   2700000   186.9          200            200            0.0028045084   2.5952854e-38  0              0.0084135253   2.0695578e-19  0              9.9931538e-13  2.6109412e-16  0              2.995215     
   2800000   186.9          200            200            0.0028045084  -4.6798378e-39  0              0.0084135253   8.0841684e-25  0              3.9035556e-18  2.6109412e-16  0              2.995215     
   2900000   186.9          200            200            0.0028045084   3.471569e-38   0              0.0084135253   5.7394345e-20  0              2.7713675e-13  2.6109412e-16  0              2.995215     
   3000000   186.9          200            200            0.0028045084  -2.3974018e-38  0              0.0084135253   6.1650834e-20  0              2.9768981e-13  2.6109412e-16  0              2.995215     
Loop time of 64.086 on 4 procs for 3000000 steps with 51 atoms

Performance: 40445632.866 ns/day, 0.000 hours/ns, 46812.075 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32257    | 1.5324     | 4.9679     | 160.3 |  2.39
Neigh   | 0.093867   | 0.094402   | 0.095909   |   0.3 |  0.15
Comm    | 25.686     | 32.467     | 38.3       |  86.0 | 50.66
Output  | 0.059763   | 0.059847   | 0.059914   |   0.0 |  0.09
Modify  | 15.153     | 21.131     | 28.567     | 123.4 | 32.97
Other   |            | 8.801      |            |       | 13.73

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 73

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.24                                                               
Lattice spacing in x,y,z = 6.24 6.24 6.24

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93.6 ${n1e1} -100 100 -100 100 units box
region box block -93.6 93.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.6 93.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93.6 -100 -100) to (93.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-93.6 -100 -100) to (93.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93.6 -100 -100) to (93.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_73_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 121 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.07 | 18.54 | 19.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   187.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   187.2          200            200            0.00226876    -7.8850431e-38  0              0.0068062799   12193.066      0              6.5417723e+10  2.6109412e-16  0              3.330044     
    200000   187.2          200            200            0.00078295002 -2.0312127e-37  0              0.0023488501   2850.8939      0              1.5295496e+10  2.6109412e-16  0              3.0799891    
    300000   187.2          200            200            2.3257365e-05  1.7035717e-36  0              6.9772096e-05  5.4290645      0              29127788       2.6109412e-16  0              3.0450362    
    400000   187.2          200            200            6.6324792e-06  1.7256777e-36  0              1.9897438e-05  0.47202387     0              2532482.6      2.6109412e-16  0              3.0064435    
    500000   187.2          200            200            0.0055075553   4.6880361e-36  0              0.016522666    2.5672582      0              13773746       2.6109412e-16  0              2.9924698    
    600000   187.2          200            200            0.0035985981  -1.5268631e-35  0              0.010795794    1.4736964      0              7906614.1      2.6109412e-16  0              2.9943551    
    700000   187.2          200            200            0.0030330178   2.6358762e-37  0              0.0090990533   0.32101577     0              1722300.3      2.6109412e-16  0              2.9949589    
    800000   187.2          200            200            0.0028696384   4.6828237e-37  0              0.0086089151   0.05364896     0              287835.14      2.6109412e-16  0              2.9951385    
    900000   187.2          200            200            0.0028196412  -1.3006552e-37  0              0.0084589236   0.0083912106   0              45020.17       2.6109412e-16  0              2.9951937    
   1000000   187.2          200            200            0.0028049058  -2.39388e-38    0              0.0084147173   0.0012530807   0              6722.976       2.6109412e-16  0              2.9952098    
   1100000   187.2          200            200            0.0028009204  -1.677815e-39   0              0.0084027613   0.0001794469   0              962.76096      2.6109412e-16  0              2.9952141    
   1200000   187.2          200            200            0.0028000119  -2.15529e-39    0              0.0084000358   2.4691136e-05  0              132.47184      2.6109412e-16  0              2.9952151    
   1300000   187.2          200            200            0.0027998898   3.0864849e-39  0              0.0083996693   3.2659895e-06  0              17.52255       2.6109412e-16  0              2.9952152    
   1400000   187.2          200            200            0.0027999238  -1.612264e-38   0              0.0083997713   4.1489349e-07  0              2.2259691      2.6109412e-16  0              2.9952151    
   1500000   187.2          200            200            0.0027999651   2.9644458e-39  0              0.0083998953   5.0482782e-08  0              0.2708481      2.6109412e-16  0              2.9952151    
   1600000   187.2          200            200            0.0027999906   1.7697863e-38  0              0.0083999718   5.8547682e-09  0              0.031411756    2.6109412e-16  0              2.995215     
   1700000   187.2          200            200            0.0028000036  -3.5042754e-39  0              0.0084000107   6.4196399e-10  0              0.0034442382   2.6109412e-16  0              2.995215     
   1800000   187.2          200            200            0.0028000096   7.0312894e-39  0              0.0084000288   6.5665615e-11  0              0.00035230639  2.6109412e-16  0              2.995215     
   1900000   187.2          200            200            0.0028000122  -2.6477008e-38  0              0.0084000366   6.123676e-12   0              3.2854489e-05  2.6109412e-16  0              2.995215     
   2000000   187.2          200            200            0.0028000133   1.2901975e-38  0              0.0084000399   4.9867245e-13  0              2.6754565e-06  2.6109412e-16  0              2.995215     
   2100000   187.2          200            200            0.0028000138   5.0197326e-39  0              0.0084000413   3.2253491e-14  0              1.7304507e-07  2.6109412e-16  0              2.995215     
   2200000   187.2          200            200            0.0028000139  -3.9942836e-39  0              0.0084000418   1.2444566e-15  0              6.6767061e-09  2.6109412e-16  0              2.995215     
   2300000   187.2          200            200            0.002800014   -9.3594864e-40  0              0.008400042    2.0454436e-18  0              1.0974128e-11  2.6109412e-16  0              2.995215     
   2400000   187.2          200            200            0.002800014   -1.5394088e-38  0              0.0084000421   1.3088086e-17  0              7.0219648e-11  2.6109412e-16  0              2.995215     
   2500000   187.2          200            200            0.002800014    1.0287861e-38  0              0.0084000421   7.7002593e-18  0              4.1313107e-11  2.6109412e-16  0              2.995215     
   2600000   187.2          200            200            0.002800014   -1.2097475e-39  0              0.0084000421   2.7884313e-18  0              1.4960374e-11  2.6109412e-16  0              2.995215     
   2700000   187.2          200            200            0.002800014   -4.5389478e-40  0              0.0084000421   6.7501782e-19  0              3.6215772e-12  2.6109412e-16  0              2.995215     
   2800000   187.2          200            200            0.002800014   -3.8515906e-39  0              0.0084000421   1.920875e-19   0              1.0305798e-12  2.6109412e-16  0              2.995215     
   2900000   187.2          200            200            0.002800014    1.6638668e-38  0              0.0084000421   3.1227739e-23  0              1.6754175e-16  2.6109412e-16  0              2.995215     
   3000000   187.2          200            200            0.002800014    1.9926742e-38  0              0.0084000421   1.4521892e-19  0              7.7912246e-13  2.6109412e-16  0              2.995215     
Loop time of 62.7529 on 4 procs for 3000000 steps with 50 atoms

Performance: 41304890.277 ns/day, 0.000 hours/ns, 47806.586 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29661    | 1.5103     | 4.9193     | 160.2 |  2.41
Neigh   | 0.093819   | 0.094338   | 0.095821   |   0.3 |  0.15
Comm    | 25.126     | 31.629     | 37.252     |  83.4 | 50.40
Output  | 0.060824   | 0.060906   | 0.060974   |   0.0 |  0.10
Modify  | 14.948     | 20.774     | 27.932     | 120.4 | 33.10
Other   |            | 8.684      |            |       | 13.84

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.54
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 74

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.25                                                               
Lattice spacing in x,y,z = 6.25 6.25 6.25

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93.75 ${n1e1} -100 100 -100 100 units box
region box block -93.75 93.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.75 93.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93.75 -100 -100) to (93.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-93.75 -100 -100) to (93.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93.75 -100 -100) to (93.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_74_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 121 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.07 | 18.54 | 19.7 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   187.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   187.5          200            200            0.002263436    3.2131817e-40  0              0.006790308    12179.121      0              5.8808618e+10  2.6109412e-16  0              3.3306681    
    200000   187.5          200            200            0.00077903113 -2.031023e-37   0              0.0023370934   2835.7681      0              1.3692909e+10  2.6109412e-16  0              3.0804673    
    300000   187.5          200            200            1.6447152e-05 -8.1993073e-37  0              4.9341457e-05  2.7622911      0              13338115       2.6109412e-16  0              3.0448866    
    400000   187.5          200            200           -2.4242091e-05 -1.2115148e-36  0             -7.2726273e-05  6.5787155      0              31766263       2.6109412e-16  0              3.0060444    
    500000   187.5          200            200            0.0054188176   2.5579626e-35  0              0.016256453    4.3806353      0              21152520       2.6109412e-16  0              2.9925756    
    600000   187.5          200            200            0.0030722195   4.0161431e-36  0              0.0092166586   3.7219102      0              17971772       2.6109412e-16  0              2.9949249    
    700000   187.5          200            200            0.0028212363   1.7303567e-36  0              0.0084637088   0.54267787     0              2620397.2      2.6109412e-16  0              2.9951938    
    800000   187.5          200            200            0.0027860731   5.0018018e-37  0              0.0083582194   0.073227675    0              353590.23      2.6109412e-16  0              2.9952288    
    900000   187.5          200            200            0.0027854399  -9.1618015e-38  0              0.0083563198   0.0094971388   0              45858.284      2.6109412e-16  0              2.9952276    
   1000000   187.5          200            200            0.0027894486   5.5280799e-39  0              0.0083683459   0.0011821844   0              5708.3453      2.6109412e-16  0              2.9952223    
   1100000   187.5          200            200            0.0027924628   2.0814259e-37  0              0.0083773885   0.0001406562   0              679.17845      2.6109412e-16  0              2.9952187    
   1200000   187.5          200            200            0.0027941196  -2.2128055e-38  0              0.0083823587   1.5894502e-05  0              76.748862      2.6109412e-16  0              2.9952167    
   1300000   187.5          200            200            0.0027949191   5.214825e-39   0              0.0083847573   1.6884003e-06  0              8.1526806      2.6109412e-16  0              2.9952157    
   1400000   187.5          200            200            0.0027952775  -2.8819353e-39  0              0.0083858324   1.6571376e-07  0              0.80017244     2.6109412e-16  0              2.9952153    
   1500000   187.5          200            200            0.0027954303   1.0366172e-38  0              0.008386291    1.4572585e-08  0              0.070365799    2.6109412e-16  0              2.9952151    
   1600000   187.5          200            200            0.0027954932   7.7804328e-39  0              0.0083864796   1.0794005e-09  0              0.0052120386   2.6109412e-16  0              2.9952151    
   1700000   187.5          200            200            0.0027955183   1.3956879e-38  0              0.0083865549   5.7733851e-11  0              0.00027877611  2.6109412e-16  0              2.995215     
   1800000   187.5          200            200            0.0027955281   1.4110405e-38  0              0.0083865843   1.1866614e-12  0              5.7299633e-06  2.6109412e-16  0              2.995215     
   1900000   187.5          200            200            0.0027955318   1.3125372e-38  0              0.0083865955   5.5038569e-14  0              2.6576155e-07  2.6109412e-16  0              2.995215     
   2000000   187.5          200            200            0.0027955332   1.7625775e-38  0              0.0083865997   1.0131527e-13  0              4.892152e-07   2.6109412e-16  0              2.995215     
   2100000   187.5          200            200            0.0027955337  -1.1811598e-38  0              0.0083866012   4.0055467e-14  0              1.9341351e-07  2.6109412e-16  0              2.995215     
   2200000   187.5          200            200            0.0027955339   5.3888212e-39  0              0.0083866017   1.055253e-14   0              5.0954393e-08  2.6109412e-16  0              2.995215     
   2300000   187.5          200            200            0.002795534    3.4756435e-38  0              0.0083866019   2.2814209e-15  0              1.1016165e-08  2.6109412e-16  0              2.995215     
   2400000   187.5          200            200            0.002795534   -1.0762641e-38  0              0.008386602    4.4099349e-16  0              2.1293998e-09  2.6109412e-16  0              2.995215     
   2500000   187.5          200            200            0.002795534    3.6473758e-39  0              0.008386602    7.6909942e-17  0              3.7137059e-10  2.6109412e-16  0              2.995215     
   2600000   187.5          200            200            0.002795534   -4.1300417e-39  0              0.008386602    1.2762554e-17  0              6.1625803e-11  2.6109412e-16  0              2.995215     
   2700000   187.5          200            200            0.002795534   -9.3824593e-39  0              0.008386602    1.9034524e-18  0              9.1910906e-12  2.6109412e-16  0              2.995215     
   2800000   187.5          200            200            0.002795534    4.3832845e-38  0              0.008386602    3.0346007e-19  0              1.4653001e-12  2.6109412e-16  0              2.995215     
   2900000   187.5          200            200            0.002795534    1.7535042e-38  0              0.008386602    2.2536169e-20  0              1.0881909e-13  2.6109412e-16  0              2.995215     
   3000000   187.5          200            200            0.002795534   -2.5749317e-38  0              0.008386602    2.4199726e-20  0              1.1685182e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8606 on 4 procs for 3000000 steps with 51 atoms

Performance: 40588428.473 ns/day, 0.000 hours/ns, 46977.348 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30519    | 1.5412     | 5.0345     | 162.5 |  2.41
Neigh   | 0.094951   | 0.095543   | 0.097085   |   0.3 |  0.15
Comm    | 25.852     | 32.406     | 38.14      |  83.5 | 50.75
Output  | 0.062454   | 0.062534   | 0.062595   |   0.0 |  0.10
Modify  | 15.186     | 21.043     | 28.278     | 121.3 | 32.95
Other   |            | 8.712      |            |       | 13.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 75

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.26                                                               
Lattice spacing in x,y,z = 6.26 6.26 6.26

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -93.9 ${n1e1} -100 100 -100 100 units box
region box block -93.9 93.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -93.9 93.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-93.9 -100 -100) to (93.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-93.9 -100 -100) to (93.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-93.9 -100 -100) to (93.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_75_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 122 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.09 | 18.56 | 19.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   187.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   187.8          200            200            0.0022582329   4.5266527e-40  0              0.0067746987   12166.063      0              5.8745562e+10  2.6109412e-16  0              3.3312442    
    200000   187.8          200            200            0.00077510116  1.6885813e-36  0              0.0023253035   2820.5278      0              1.3619319e+10  2.6109412e-16  0              3.0809539    
    300000   187.8          200            200            9.0540698e-06  2.1268102e-36  0              2.7162209e-05  0.85583861     0              4132538.4      2.6109412e-16  0              3.0447141    
    400000   187.8          200            200           -5.2639435e-05 -2.0428222e-36  0             -0.0001579183   33.195914      0              1.6029119e+08  2.6109412e-16  0              3.004709     
    500000   187.8          200            200            0.0044843084   1.2893633e-36  0              0.013452925    18.728664      0              90434017       2.6109412e-16  0              2.9934758    
    600000   187.8          200            200            0.0026032196   2.7906744e-37  0              0.0078096589   3.8557766      0              18618165       2.6109412e-16  0              2.9954549    
    700000   187.8          200            200            0.0026501212   1.4206813e-36  0              0.0079503635   0.45466595     0              2195419.1      2.6109412e-16  0              2.9953852    
    800000   187.8          200            200            0.0027223091   4.4957308e-37  0              0.0081669273   0.052654629    0              254250.36      2.6109412e-16  0              2.9952966    
    900000   187.8          200            200            0.0027603078  -4.4968929e-37  0              0.0082809234   0.0058025543   0              28018.458      2.6109412e-16  0              2.9952511    
   1000000   187.8          200            200            0.0027779614   1.6228903e-37  0              0.0083338843   0.00059723594  0              2883.8386      2.6109412e-16  0              2.9952303    
   1100000   187.8          200            200            0.0027856813   1.4251102e-37  0              0.008357044    5.6128177e-05  0              271.02288      2.6109412e-16  0              2.9952213    
   1200000   187.8          200            200            0.0027889175   4.3401799e-38  0              0.0083667525   4.6228463e-06  0              22.32207       2.6109412e-16  0              2.9952175    
   1300000   187.8          200            200            0.0027902304   5.4002194e-38  0              0.0083706913   3.051511e-07   0              1.4734655      2.6109412e-16  0              2.995216     
   1400000   187.8          200            200            0.002790749   -5.7344063e-39  0              0.008372247    1.2422452e-08  0              0.059983574    2.6109412e-16  0              2.9952154    
   1500000   187.8          200            200            0.0027909491  -1.0166953e-38  0              0.0083728472   4.1478383e-11  0              0.00020028427  2.6109412e-16  0              2.9952151    
   1600000   187.8          200            200            0.0027910246  -1.0844394e-38  0              0.0083730739   1.0797403e-10  0              0.00052136795  2.6109412e-16  0              2.9952151    
   1700000   187.8          200            200            0.0027910526   2.8592946e-38  0              0.0083731579   7.125713e-11   0              0.00034407518  2.6109412e-16  0              2.995215     
   1800000   187.8          200            200            0.0027910628   4.5943091e-39  0              0.0083731884   2.249959e-11   0              0.00010864247  2.6109412e-16  0              2.995215     
   1900000   187.8          200            200            0.0027910664   2.0532365e-38  0              0.0083731992   5.3510594e-12  0              2.5838351e-05  2.6109412e-16  0              2.995215     
   2000000   187.8          200            200            0.0027910677  -5.6026928e-39  0              0.008373203    1.0884545e-12  0              5.2557574e-06  2.6109412e-16  0              2.995215     
   2100000   187.8          200            200            0.0027910681  -9.7913559e-39  0              0.0083732043   1.998532e-13   0              9.6501956e-07  2.6109412e-16  0              2.995215     
   2200000   187.8          200            200            0.0027910682   1.1295576e-38  0              0.0083732047   3.4022784e-14  0              1.6428385e-07  2.6109412e-16  0              2.995215     
   2300000   187.8          200            200            0.0027910683  -2.5979074e-38  0              0.0083732048   5.4641289e-15  0              2.6384323e-08  2.6109412e-16  0              2.995215     
   2400000   187.8          200            200            0.0027910683   1.1345276e-38  0              0.0083732049   8.3373304e-16  0              4.0257984e-09  2.6109412e-16  0              2.995215     
   2500000   187.8          200            200            0.0027910683   2.8155818e-38  0              0.0083732049   1.2165604e-16  0              5.8743347e-10  2.6109412e-16  0              2.995215     
   2600000   187.8          200            200            0.0027910683   3.1821204e-39  0              0.0083732049   1.705867e-17   0              8.2370213e-11  2.6109412e-16  0              2.995215     
   2700000   187.8          200            200            0.0027910683   1.3608104e-38  0              0.0083732049   2.2613496e-18  0              1.0919248e-11  2.6109412e-16  0              2.995215     
   2800000   187.8          200            200            0.0027910683   3.7149498e-39  0              0.0083732049   2.5096564e-19  0              1.2118232e-12  2.6109412e-16  0              2.995215     
   2900000   187.8          200            200            0.0027910683  -2.3141053e-38  0              0.0083732049   4.6927521e-20  0              2.265962e-13   2.6109412e-16  0              2.995215     
   3000000   187.8          200            200            0.0027910683   1.0239571e-38  0              0.0083732049   2.1495094e-20  0              1.0379211e-13  2.6109412e-16  0              2.995215     
Loop time of 64.049 on 4 procs for 3000000 steps with 51 atoms

Performance: 40469021.483 ns/day, 0.000 hours/ns, 46839.145 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30322    | 1.5586     | 5.1057     | 164.1 |  2.43
Neigh   | 0.09563    | 0.096189   | 0.097739   |   0.3 |  0.15
Comm    | 25.649     | 32.487     | 38.336     |  86.1 | 50.72
Output  | 0.060923   | 0.061005   | 0.061066   |   0.0 |  0.10
Modify  | 15.136     | 21.08      | 28.564     | 123.5 | 32.91
Other   |            | 8.766      |            |       | 13.69

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.75 ave          27 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 27
Ave neighs/atom = 0.52941176
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 76

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.27                                                               
Lattice spacing in x,y,z = 6.27 6.27 6.27

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.05 ${n1e1} -100 100 -100 100 units box
region box block -94.05 94.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.05 94.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.05 -100 -100) to (94.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-94.05 -100 -100) to (94.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.05 -100 -100) to (94.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_76_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 122 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.09 | 18.56 | 19.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   188.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   188.1          200            200            0.0022532137  -5.2029129e-38  0              0.006759641    12154.484      0              5.8689655e+10  2.6109412e-16  0              3.3317211    
    200000   188.1          200            200            0.00077111799  2.1683809e-37  0              0.002313354    2804.9273      0              1.354399e+10   2.6109412e-16  0              3.0814639    
    300000   188.1          200            200            1.0717796e-06  8.709635e-37   0              3.2153389e-06  0.013366935    0              64544.146      2.6109412e-16  0              3.0445066    
    400000   188.1          200            200           -7.5752523e-05 -1.1973587e-36  0             -0.00022725757  73.005453      0              3.5251721e+08  2.6109412e-16  0              3.0027933    
    500000   188.1          200            200            0.0034792852  -1.8413809e-36  0              0.010437856    27.746458      0              1.3397771e+08  2.6109412e-16  0              2.9945074    
    600000   188.1          200            200            0.0022777499   2.6324361e-36  0              0.0068332496   2.82129        0              13623000       2.6109412e-16  0              2.9958375    
    700000   188.1          200            200            0.0025382065   1.4178197e-35  0              0.0076146194   0.26803297     0              1294235.3      2.6109412e-16  0              2.99551      
    800000   188.1          200            200            0.0026821821  -1.8387798e-36  0              0.0080465462   0.025629412    0              123755.26      2.6109412e-16  0              2.9953372    
    900000   188.1          200            200            0.0027444764   1.1613611e-39  0              0.0082334293   0.0022130331   0              10685.945      2.6109412e-16  0              2.9952639    
   1000000   188.1          200            200            0.0027700686   1.7667055e-37  0              0.0083102058   0.00015900425  0              767.77461      2.6109412e-16  0              2.9952341    
   1100000   188.1          200            200            0.0027802664  -3.464128e-38   0              0.0083407992   7.9371685e-06  0              38.325746      2.6109412e-16  0              2.9952223    
   1200000   188.1          200            200            0.0027842304  -6.4616349e-38  0              0.0083526911   1.1938235e-07  0              0.57645464     2.6109412e-16  0              2.9952178    
   1300000   188.1          200            200            0.0027857377  -1.4762742e-38  0              0.0083572132   1.6795357e-08  0              0.08109877     2.6109412e-16  0              2.995216     
   1400000   188.1          200            200            0.0027862994   5.55099e-39    0              0.0083588981   1.9929877e-08  0              0.096234243    2.6109412e-16  0              2.9952154    
   1500000   188.1          200            200            0.0027865045   1.7842117e-38  0              0.0083595136   7.2773218e-09  0              0.035139583    2.6109412e-16  0              2.9952151    
   1600000   188.1          200            200            0.002786578    1.4070727e-38  0              0.0083597339   1.8526161e-09  0              0.0089456199   2.6109412e-16  0              2.9952151    
   1700000   188.1          200            200            0.0027866037   1.1151618e-38  0              0.0083598112   3.9251068e-10  0              0.0018952936   2.6109412e-16  0              2.995215     
   1800000   188.1          200            200            0.0027866125  -1.0888079e-38  0              0.0083598376   7.4102385e-11  0              0.0003578139   2.6109412e-16  0              2.995215     
   1900000   188.1          200            200            0.0027866155  -1.2125656e-39  0              0.0083598465   1.2889218e-11  0              6.2237419e-05  2.6109412e-16  0              2.995215     
   2000000   188.1          200            200            0.0027866164  -2.4002669e-39  0              0.0083598493   2.1040461e-12  0              1.0159686e-05  2.6109412e-16  0              2.995215     
   2100000   188.1          200            200            0.0027866167   2.1625239e-38  0              0.0083598502   3.2585021e-13  0              1.5734141e-06  2.6109412e-16  0              2.995215     
   2200000   188.1          200            200            0.0027866168   2.0126755e-38  0              0.0083598504   4.822212e-14   0              2.3284736e-07  2.6109412e-16  0              2.995215     
   2300000   188.1          200            200            0.0027866168  -2.1591622e-38  0              0.0083598505   6.843726e-15   0              3.3045904e-08  2.6109412e-16  0              2.995215     
   2400000   188.1          200            200            0.0027866168   4.0688204e-38  0              0.0083598505   9.332885e-16   0              4.5065162e-09  2.6109412e-16  0              2.995215     
   2500000   188.1          200            200            0.0027866168   2.2468215e-39  0              0.0083598505   1.2216287e-16  0              5.8988077e-10  2.6109412e-16  0              2.995215     
   2600000   188.1          200            200            0.0027866168   3.1883434e-38  0              0.0083598505   1.495364e-17   0              7.2205776e-11  2.6109412e-16  0              2.995215     
   2700000   188.1          200            200            0.0027866168  -6.3068817e-39  0              0.0083598505   1.8397029e-18  0              8.8832668e-12  2.6109412e-16  0              2.995215     
   2800000   188.1          200            200            0.0027866168   2.2081985e-38  0              0.0083598505   1.0079675e-19  0              4.8671145e-13  2.6109412e-16  0              2.995215     
   2900000   188.1          200            200            0.0027866168   2.2110866e-38  0              0.0083598505   5.4825358e-20  0              2.6473203e-13  2.6109412e-16  0              2.995215     
   3000000   188.1          200            200            0.0027866168  -2.8604895e-39  0              0.0083598505   2.6944903e-20  0              1.301073e-13   2.6109412e-16  0              2.995215     
Loop time of 63.9972 on 4 procs for 3000000 steps with 51 atoms

Performance: 40501793.909 ns/day, 0.000 hours/ns, 46877.076 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31665    | 1.5414     | 5.0038     | 161.1 |  2.41
Neigh   | 0.095711   | 0.096254   | 0.09783    |   0.3 |  0.15
Comm    | 25.668     | 32.51      | 38.25      |  86.1 | 50.80
Output  | 0.061875   | 0.061956   | 0.062023   |   0.0 |  0.10
Modify  | 15.186     | 21.097     | 28.553     | 123.3 | 32.97
Other   |            | 8.691      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 77

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.28                                                               
Lattice spacing in x,y,z = 6.28 6.28 6.28

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.2 ${n1e1} -100 100 -100 100 units box
region box block -94.2 94.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.2 94.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.2 -100 -100) to (94.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-94.2 -100 -100) to (94.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.2 -100 -100) to (94.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_77_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 122 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.09 | 18.56 | 19.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   188.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   188.4          200            200            0.0022484555   1.0508833e-37  0              0.0067453665   12145.121      0              5.8644442e+10  2.6109412e-16  0              3.3320349    
    200000   188.4          200            200            0.00076717949 -6.151569e-37   0              0.0023015385   2789.5357      0              1.346967e+10   2.6109412e-16  0              3.0819652    
    300000   188.4          200            200           -7.3891164e-06  4.5194317e-37  0             -2.2167349e-05  0.57540297     0              2778415        2.6109412e-16  0              3.0442505    
    400000   188.4          200            200           -9.2995565e-05  4.7909013e-37  0             -0.0002789867   115.62098      0              5.5829231e+08  2.6109412e-16  0              3.000779     
    500000   188.4          200            200            0.0026719506   2.2566042e-36  0              0.0080158517   29.517242      0              1.425282e+08   2.6109412e-16  0              2.9954062    
    600000   188.4          200            200            0.0020746419   1.8306832e-35  0              0.0062239258   1.6782666      0              8103748.6      2.6109412e-16  0              2.9960819    
    700000   188.4          200            200            0.0024733629   8.1970479e-37  0              0.0074200886   0.11744448     0              567097.38      2.6109412e-16  0              2.9955803    
    800000   188.4          200            200            0.0026598207  -1.3379872e-36  0              0.007979462    0.0079202484   0              38244.045      2.6109412e-16  0              2.9953575    
    900000   188.4          200            200            0.0027352086  -2.0146211e-37  0              0.0082056259   0.00036661283  0              1770.2421      2.6109412e-16  0              2.9952693    
   1000000   188.4          200            200            0.0027645533   2.6433811e-38  0              0.0082936599   3.7058654e-06  0              17.894298      2.6109412e-16  0              2.9952353    
   1100000   188.4          200            200            0.0027756997  -3.3404978e-38  0              0.0083270991   1.4143326e-06  0              6.8293061      2.6109412e-16  0              2.9952224    
   1200000   188.4          200            200            0.0027798449   2.1460078e-38  0              0.0083395348   1.2701441e-06  0              6.1330714      2.6109412e-16  0              2.9952177    
   1300000   188.4          200            200            0.0027813558   2.5531808e-38  0              0.0083440673   4.3571765e-07  0              2.1039246      2.6109412e-16  0              2.995216     
   1400000   188.4          200            200            0.0027818954   1.1462766e-38  0              0.0083456861   1.0782021e-07  0              0.52062521     2.6109412e-16  0              2.9952153    
   1500000   188.4          200            200            0.002782084    2.0688272e-38  0              0.008346252    2.2464888e-08  0              0.10847491     2.6109412e-16  0              2.9952151    
   1600000   188.4          200            200            0.0027821484  -9.1626584e-39  0              0.0083464452   4.1931156e-09  0              0.020247054    2.6109412e-16  0              2.995215     
   1700000   188.4          200            200            0.0027821698  -3.76054e-39    0              0.0083465094   7.2310377e-10  0              0.0034916093   2.6109412e-16  0              2.995215     
   1800000   188.4          200            200            0.0027821767   1.850544e-38   0              0.00834653     1.1722298e-10  0              0.00056602782  2.6109412e-16  0              2.995215     
   1900000   188.4          200            200            0.0027821788   2.1747026e-38  0              0.0083465363   1.8049395e-11  0              8.7154069e-05  2.6109412e-16  0              2.995215     
   2000000   188.4          200            200            0.0027821794  -5.7584033e-40  0              0.0083465381   2.6564806e-12  0              1.2827194e-05  2.6109412e-16  0              2.995215     
   2100000   188.4          200            200            0.0027821795  -1.243631e-38   0              0.0083465386   3.7513117e-13  0              1.8113742e-06  2.6109412e-16  0              2.995215     
   2200000   188.4          200            200            0.0027821796  -5.609745e-39   0              0.0083465387   5.0913301e-14  0              2.4584211e-07  2.6109412e-16  0              2.995215     
   2300000   188.4          200            200            0.0027821796  -7.851819e-39   0              0.0083465387   6.6430298e-15  0              3.2076814e-08  2.6109412e-16  0              2.995215     
   2400000   188.4          200            200            0.0027821796  -2.7509214e-39  0              0.0083465387   8.3106035e-16  0              4.012893e-09   2.6109412e-16  0              2.995215     
   2500000   188.4          200            200            0.0027821796   9.7516305e-39  0              0.0083465387   9.8294554e-17  0              4.7462922e-10  2.6109412e-16  0              2.995215     
   2600000   188.4          200            200            0.0027821796   3.6261852e-38  0              0.0083465387   1.068152e-17   0              5.1577238e-11  2.6109412e-16  0              2.995215     
   2700000   188.4          200            200            0.0027821795   3.2453597e-39  0              0.0083465386   1.221513e-18   0              5.8982491e-12  2.6109412e-16  0              2.995215     
   2800000   188.4          200            200            0.0027821795   3.5081639e-38  0              0.0083465386   5.4734605e-20  0              2.6429382e-13  2.6109412e-16  0              2.995215     
   2900000   188.4          200            200            0.0027821795   9.1784672e-39  0              0.0083465386   1.0099529e-19  0              4.8767009e-13  2.6109412e-16  0              2.995215     
   3000000   188.4          200            200            0.0027821795   7.4006871e-39  0              0.0083465386   2.9743921e-20  0              1.4362275e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0767 on 4 procs for 3000000 steps with 51 atoms

Performance: 40451532.634 ns/day, 0.000 hours/ns, 46818.904 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29649    | 1.5101     | 4.9181     | 160.2 |  2.36
Neigh   | 0.095611   | 0.096518   | 0.098431   |   0.4 |  0.15
Comm    | 25.58      | 32.564     | 38.358     |  87.2 | 50.82
Output  | 0.063992   | 0.064079   | 0.064147   |   0.0 |  0.10
Modify  | 15.142     | 21.14      | 28.743     | 124.9 | 32.99
Other   |            | 8.702      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 78

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.29                                                               
Lattice spacing in x,y,z = 6.29 6.29 6.29

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.35 ${n1e1} -100 100 -100 100 units box
region box block -94.35 94.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.35 94.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.35 -100 -100) to (94.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-94.35 -100 -100) to (94.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.35 -100 -100) to (94.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_78_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 122 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.09 | 18.56 | 19.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   188.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   188.7          200            200            0.0022439807  -1.0400027e-37  0              0.006731942    12138.212      0              5.861108e+10   2.6109412e-16  0              3.3321587    
    200000   188.7          200            200            0.00076333073  1.5435398e-38  0              0.0022899922   2774.6147      0              1.3397622e+10  2.6109412e-16  0              3.0824434    
    300000   188.7          200            200           -1.6223449e-05  3.2304528e-38  0             -4.8670348e-05  2.8551345      0              13786423       2.6109412e-16  0              3.0439333    
    400000   188.7          200            200            0.00021582295 -8.2106239e-36  0              0.00064746884  155.48088      0              7.5076153e+08  2.6109412e-16  0              2.9988645    
    500000   188.7          200            200            0.002085154   -4.0753733e-36  0              0.006255462    27.215463      0              1.3141373e+08  2.6109412e-16  0              2.9961149    
    600000   188.7          200            200            0.0019556891  -1.3815693e-36  0              0.0058670672   0.83310468     0              4022764.3      2.6109412e-16  0              2.9962253    
    700000   188.7          200            200            0.0024397552   5.0014756e-36  0              0.0073192657   0.032933676    0              159024.94      2.6109412e-16  0              2.995614     
    800000   188.7          200            200            0.0026487398   7.0741858e-36  0              0.0079462195   0.00069841151  0              3372.3792      2.6109412e-16  0              2.9953648    
    900000   188.7          200            200            0.0027298901  -2.8132821e-37  0              0.0081896704   1.9632492e-05  0              94.798279      2.6109412e-16  0              2.9952701    
   1000000   188.7          200            200            0.002760385    1.343526e-37   0              0.0082811551   4.5778547e-05  0              221.04822      2.6109412e-16  0              2.9952349    
   1100000   188.7          200            200            0.0027715842  -1.9080627e-37  0              0.0083147525   1.8727231e-05  0              90.427094      2.6109412e-16  0              2.9952221    
   1200000   188.7          200            200            0.0027756114   4.1496675e-38  0              0.0083268342   5.0030345e-06  0              24.157863      2.6109412e-16  0              2.9952175    
   1300000   188.7          200            200            0.0027770291  -1.9575133e-38  0              0.0083310873   1.0895296e-06  0              5.2609484      2.6109412e-16  0              2.9952158    
   1400000   188.7          200            200            0.0027775168   5.1500379e-38  0              0.0083325505   2.0950396e-07  0              1.0116196      2.6109412e-16  0              2.9952153    
   1500000   188.7          200            200            0.0027776803   4.9914088e-40  0              0.0083330409   3.6937764e-08  0              0.17835924     2.6109412e-16  0              2.9952151    
   1600000   188.7          200            200            0.0027777334   1.4888122e-38  0              0.0083332001   6.0951343e-09  0              0.029431222    2.6109412e-16  0              2.995215     
   1700000   188.7          200            200            0.0027777499  -1.2254245e-38  0              0.0083332497   9.5274732e-10  0              0.0046004758   2.6109412e-16  0              2.995215     
   1800000   188.7          200            200            0.0027777548   2.1507129e-38  0              0.0083332643   1.4211917e-10  0              0.0006862426   2.6109412e-16  0              2.995215     
   1900000   188.7          200            200            0.0027777561  -1.9237238e-38  0              0.0083332682   2.0319671e-11  0              9.8116421e-05  2.6109412e-16  0              2.995215     
   2000000   188.7          200            200            0.0027777564   9.21083e-39    0              0.0083332691   2.7910946e-12  0              1.3477197e-05  2.6109412e-16  0              2.995215     
   2100000   188.7          200            200            0.0027777564  -2.5099806e-39  0              0.0083332692   3.6852664e-13  0              1.7794833e-06  2.6109412e-16  0              2.995215     
   2200000   188.7          200            200            0.0027777564  -2.0060692e-38  0              0.0083332692   4.6717248e-14  0              2.2558087e-07  2.6109412e-16  0              2.995215     
   2300000   188.7          200            200            0.0027777564   3.1728298e-38  0              0.0083332692   5.6732405e-15  0              2.7394048e-08  2.6109412e-16  0              2.995215     
   2400000   188.7          200            200            0.0027777564   1.247422e-38   0              0.0083332691   6.5717741e-16  0              3.1732745e-09  2.6109412e-16  0              2.995215     
   2500000   188.7          200            200            0.0027777564   2.3483083e-38  0              0.0083332691   7.0416984e-17  0              3.4001841e-10  2.6109412e-16  0              2.995215     
   2600000   188.7          200            200            0.0027777564  -3.7672067e-39  0              0.0083332691   6.6735738e-18  0              3.2224299e-11  2.6109412e-16  0              2.995215     
   2700000   188.7          200            200            0.0027777564   1.0809594e-38  0              0.0083332691   6.9271469e-19  0              3.3448713e-12  2.6109412e-16  0              2.995215     
   2800000   188.7          200            200            0.0027777564  -1.1096949e-38  0              0.0083332691   1.4832662e-20  0              7.1621617e-14  2.6109412e-16  0              2.995215     
   2900000   188.7          200            200            0.0027777564   1.5508982e-38  0              0.0083332691   1.0814368e-19  0              5.2218714e-13  2.6109412e-16  0              2.995215     
   3000000   188.7          200            200            0.0027777564  -5.6348277e-39  0              0.0083332691   1.7601872e-20  0              8.4993141e-14  2.6109412e-16  0              2.995215     
Loop time of 64.2218 on 4 procs for 3000000 steps with 51 atoms

Performance: 40360139.879 ns/day, 0.000 hours/ns, 46713.125 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30962    | 1.4972     | 4.8742     | 159.4 |  2.33
Neigh   | 0.095752   | 0.096568   | 0.098397   |   0.3 |  0.15
Comm    | 25.791     | 32.625     | 38.407     |  86.0 | 50.80
Output  | 0.063381   | 0.063463   | 0.06352    |   0.0 |  0.10
Modify  | 15.233     | 21.179     | 28.654     | 123.5 | 32.98
Other   |            | 8.761      |            |       | 13.64

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 79

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.3                                                               
Lattice spacing in x,y,z = 6.3 6.3 6.3

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.5 ${n1e1} -100 100 -100 100 units box
region box block -94.5 94.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.5 94.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.5 -100 -100) to (94.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-94.5 -100 -100) to (94.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.5 -100 -100) to (94.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_79_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 122 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.09 | 18.56 | 19.72 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   189            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   189            200            200            0.0022395266   5.6927318e-40  0              0.0067185797   12131.373      0              5.8578061e+10  2.6109412e-16  0              3.3322738    
    200000   189            200            200            0.00075931207  7.3168141e-39  0              0.0022779362   2758.6534      0              1.332055e+10   2.6109412e-16  0              3.082988     
    300000   189            200            200           -2.5482624e-05 -1.2180104e-36  0             -7.6447873e-05  7.2187125      0              34856579       2.6109412e-16  0              3.0435401    
    400000   189            200            200            0.0011698175  -2.4033564e-35  0              0.0035094526   182.6596       0              8.8199785e+08  2.6109412e-16  0              2.9971393    
    500000   189            200            200            0.0016692647  -6.4229846e-37  0              0.005007794    23.423887      0              1.1310557e+08  2.6109412e-16  0              2.996656     
    600000   189            200            200            0.0018898767   5.5257346e-36  0              0.0056696301   0.3216308      0              1553040        2.6109412e-16  0              2.9963026    
    700000   189            200            200            0.002425138   -4.2327095e-36  0              0.0072754141   0.0018375344   0              8872.7961      2.6109412e-16  0              2.9956253    
    800000   189            200            200            0.0026441983  -1.682404e-36   0              0.0079325949   0.00065810243  0              3177.7411      2.6109412e-16  0              2.9953646    
    900000   189            200            200            0.0027267303   4.065158e-37   0              0.0081801909   0.00055085486  0              2659.881       2.6109412e-16  0              2.9952686    
   1000000   189            200            200            0.0027569031   1.8534184e-37  0              0.0082707094   0.00018420785  0              889.47378      2.6109412e-16  0              2.9952338    
   1100000   189            200            200            0.0027676812   3.0174966e-37  0              0.0083030436   4.4987653e-05  0              217.22927      2.6109412e-16  0              2.9952215    
   1200000   189            200            200            0.0027714455   7.2708125e-38  0              0.0083143364   9.2968917e-06  0              44.891363      2.6109412e-16  0              2.9952172    
   1300000   189            200            200            0.0027727286  -2.0737479e-38  0              0.0083181858   1.725319e-06   0              8.3309478      2.6109412e-16  0              2.9952157    
   1400000   189            200            200            0.0027731539   8.0779383e-39  0              0.0083194618   2.9622588e-07  0              1.4303688      2.6109412e-16  0              2.9952152    
   1500000   189            200            200            0.0027732901   4.0367769e-38  0              0.0083198704   4.7849554e-08  0              0.23104837     2.6109412e-16  0              2.9952151    
   1600000   189            200            200            0.0027733318  -7.2153959e-40  0              0.0083199954   7.3450152e-09  0              0.03546645     2.6109412e-16  0              2.995215     
   1700000   189            200            200            0.0027733437   4.7519046e-39  0              0.0083200311   1.0780054e-09  0              0.0052053025   2.6109412e-16  0              2.995215     
   1800000   189            200            200            0.0027733468  -8.886416e-39   0              0.0083200403   1.5180919e-10  0              0.00073303223  2.6109412e-16  0              2.995215     
   1900000   189            200            200            0.0027733474   1.7212343e-38  0              0.0083200421   2.0546159e-11  0              9.9210048e-05  2.6109412e-16  0              2.995215     
   2000000   189            200            200            0.0027733474  -8.2674089e-39  0              0.0083200422   2.6725822e-12  0              1.2904943e-05  2.6109412e-16  0              2.995215     
   2100000   189            200            200            0.0027733473   1.1412125e-39  0              0.008320042    3.3357135e-13  0              1.6106967e-06  2.6109412e-16  0              2.995215     
   2200000   189            200            200            0.0027733473   3.0916766e-39  0              0.0083200418   3.9784167e-14  0              1.921035e-07   2.6109412e-16  0              2.995215     
   2300000   189            200            200            0.0027733473   3.0243763e-38  0              0.0083200418   4.5087796e-15  0              2.1771283e-08  2.6109412e-16  0              2.995215     
   2400000   189            200            200            0.0027733472   2.0696921e-38  0              0.0083200417   4.8095299e-16  0              2.3223498e-09  2.6109412e-16  0              2.995215     
   2500000   189            200            200            0.0027733472  -1.0336716e-39  0              0.0083200417   4.6538634e-17  0              2.2471841e-10  2.6109412e-16  0              2.995215     
   2600000   189            200            200            0.0027733472   1.7288923e-38  0              0.0083200417   3.6406473e-18  0              1.7579383e-11  2.6109412e-16  0              2.995215     
   2700000   189            200            200            0.0027733472   2.1929031e-38  0              0.0083200417   3.3085729e-19  0              1.5975914e-12  2.6109412e-16  0              2.995215     
   2800000   189            200            200            0.0027733472   2.2742368e-38  0              0.0083200417   1.2281622e-21  0              5.9303556e-15  2.6109412e-16  0              2.995215     
   2900000   189            200            200            0.0027733472   1.3285785e-38  0              0.0083200417   1.104166e-19   0              5.3316226e-13  2.6109412e-16  0              2.995215     
   3000000   189            200            200            0.0027733472  -1.4508398e-38  0              0.0083200417   9.8166698e-21  0              4.7401185e-14  2.6109412e-16  0              2.995215     
Loop time of 64.022 on 4 procs for 3000000 steps with 51 atoms

Performance: 40486109.796 ns/day, 0.000 hours/ns, 46858.923 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31175    | 1.5407     | 5.0121     | 161.5 |  2.41
Neigh   | 0.095692   | 0.096274   | 0.097779   |   0.3 |  0.15
Comm    | 25.747     | 32.497     | 38.252     |  85.3 | 50.76
Output  | 0.061958   | 0.062036   | 0.062098   |   0.0 |  0.10
Modify  | 15.19      | 21.13      | 28.523     | 122.7 | 33.00
Other   |            | 8.696      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 80

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.31                                                               
Lattice spacing in x,y,z = 6.31 6.31 6.31

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.65 ${n1e1} -100 100 -100 100 units box
region box block -94.65 94.65 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.65 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.65 94.65 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.65 -100 -100) to (94.65 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-94.65 -100 -100) to (94.65 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.65 -100 -100) to (94.65 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_80_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.11 | 18.58 | 19.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   189.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   189.3          200            200            0.0022350534  -4.1613562e-37  0              0.0067051603   12124.24       0              5.8543617e+10  2.6109412e-16  0              3.3324095    
    200000   189.3          200            200            0.00075507595 -1.2427973e-36  0              0.0022652279   2741.375       0              1.3237119e+10  2.6109412e-16  0              3.0836167    
    300000   189.3          200            200           -3.5019412e-05  3.3702244e-36  0             -0.00010505824  13.969561      0              67454010       2.6109412e-16  0              3.0430585    
    400000   189.3          200            200            0.0022888942   3.6553863e-35  0              0.0068666825   194.34009      0              9.3839874e+08  2.6109412e-16  0              2.9956449    
    500000   189.3          200            200            0.0013730641   1.6127807e-35  0              0.0041191922   19.441604      0              93876549       2.6109412e-16  0              2.9970674    
    600000   189.3          200            200            0.0018570167  -2.7555659e-35  0              0.0055710502   0.070614598    0              340972.62      2.6109412e-16  0              2.996338     
    700000   189.3          200            200            0.00242172     3.2509598e-36  0              0.0072651601   0.0054070087   0              26108.51       2.6109412e-16  0              2.9956235    
    800000   189.3          200            200            0.002643292   -2.0673384e-36  0              0.0079298761   0.0046579164   0              22491.411      2.6109412e-16  0              2.9953603    
    900000   189.3          200            200            0.0027246828   5.3173008e-37  0              0.0081740484   0.0014935317   0              7211.7301      2.6109412e-16  0              2.9952658    
   1000000   189.3          200            200            0.002753741    1.8841445e-37  0              0.008261223    0.00035537898  0              1715.9979      2.6109412e-16  0              2.9952324    
   1100000   189.3          200            200            0.0027638658   4.8434964e-37  0              0.0082915975   7.2214468e-05  0              348.69782      2.6109412e-16  0              2.9952208    
   1200000   189.3          200            200            0.0027673057   1.0115344e-37  0              0.008301917    1.3242036e-05  0              63.941055      2.6109412e-16  0              2.9952169    
   1300000   189.3          200            200            0.002768441    2.7717948e-38  0              0.008305323    2.2527204e-06  0              10.877581      2.6109412e-16  0              2.9952156    
   1400000   189.3          200            200            0.0027688026  -4.9331962e-39  0              0.0083064077   3.6114681e-07  0              1.7438487      2.6109412e-16  0              2.9952152    
   1500000   189.3          200            200            0.0027689123  -1.6292988e-38  0              0.0083067369   5.5076595e-08  0              0.26594516     2.6109412e-16  0              2.9952151    
   1600000   189.3          200            200            0.0027689433  -1.6739181e-39  0              0.00830683     8.0358826e-09  0              0.038802401    2.6109412e-16  0              2.995215     
   1700000   189.3          200            200            0.0027689511   2.48143e-39    0              0.0083068533   1.1253632e-09  0              0.0054339762   2.6109412e-16  0              2.995215     
   1800000   189.3          200            200            0.0027689525   5.4604664e-39  0              0.0083068576   1.5147865e-10  0              0.0007314362   2.6109412e-16  0              2.995215     
   1900000   189.3          200            200            0.0027689525  -8.8355243e-39  0              0.0083068576   1.9593706e-11  0              9.4610992e-05  2.6109412e-16  0              2.995215     
   2000000   189.3          200            200            0.0027689524  -1.3553802e-39  0              0.0083068571   2.430893e-12   0              1.1737912e-05  2.6109412e-16  0              2.995215     
   2100000   189.3          200            200            0.0027689522   3.5447535e-39  0              0.0083068566   2.8816977e-13  0              1.3914687e-06  2.6109412e-16  0              2.995215     
   2200000   189.3          200            200            0.0027689521   1.0265474e-39  0              0.0083068564   3.244497e-14   0              1.5666515e-07  2.6109412e-16  0              2.995215     
   2300000   189.3          200            200            0.0027689521  -7.2279399e-39  0              0.0083068563   3.4290165e-15  0              1.6557494e-08  2.6109412e-16  0              2.995215     
   2400000   189.3          200            200            0.0027689521   3.2557138e-38  0              0.0083068562   3.3516173e-16  0              1.6183761e-09  2.6109412e-16  0              2.995215     
   2500000   189.3          200            200            0.0027689521   1.1378337e-38  0              0.0083068562   2.8398892e-17  0              1.3712809e-10  2.6109412e-16  0              2.995215     
   2600000   189.3          200            200            0.0027689521   2.5542586e-39  0              0.0083068562   1.701483e-18   0              8.2158525e-12  2.6109412e-16  0              2.995215     
   2700000   189.3          200            200            0.0027689521   1.1039203e-38  0              0.0083068562   1.1997612e-19  0              5.7932174e-13  2.6109412e-16  0              2.995215     
   2800000   189.3          200            200            0.0027689521   2.5514465e-38  0              0.0083068562   2.2299951e-21  0              1.0767848e-14  2.6109412e-16  0              2.995215     
   2900000   189.3          200            200            0.0027689521   2.0016362e-38  0              0.0083068562   1.0000192e-19  0              4.8287348e-13  2.6109412e-16  0              2.995215     
   3000000   189.3          200            200            0.0027689521   9.283145e-39   0              0.0083068562   2.4603988e-20  0              1.1880385e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1726 on 4 procs for 3000000 steps with 51 atoms

Performance: 40391071.703 ns/day, 0.000 hours/ns, 46748.926 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28937    | 1.5457     | 5.0204     | 161.5 |  2.41
Neigh   | 0.096459   | 0.097022   | 0.098552   |   0.3 |  0.15
Comm    | 25.613     | 32.612     | 38.429     |  87.3 | 50.82
Output  | 0.062555   | 0.062638   | 0.062704   |   0.0 |  0.10
Modify  | 15.176     | 21.146     | 28.739     | 124.3 | 32.95
Other   |            | 8.709      |            |       | 13.57

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 81

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.32                                                               
Lattice spacing in x,y,z = 6.32 6.32 6.32

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.8 ${n1e1} -100 100 -100 100 units box
region box block -94.8 94.8 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.8 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.8 94.8 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.8 -100 -100) to (94.8 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-94.8 -100 -100) to (94.8 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.8 -100 -100) to (94.8 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_81_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.11 | 18.58 | 19.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   189.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   189.6          200            200            0.0022305612   3.1266546e-37  0              0.0066916836   12116.807      0              6.5008583e+10  2.6109412e-16  0              3.332567     
    200000   189.6          200            200            0.00075061518  4.2605561e-37  0              0.0022518456   2722.7381      0              1.460792e+10   2.6109412e-16  0              3.0843337    
    300000   189.6          200            200           -4.4578434e-05  1.7043462e-36  0             -0.0001337353   23.202316      0              1.2448409e+08  2.6109412e-16  0              3.0424854    
    400000   189.6          200            200            0.0033941727   2.3514059e-35  0              0.010182518    193.47246      0              1.0380103e+09  2.6109412e-16  0              2.994389     
    500000   189.6          200            200            0.001160679    3.282229e-35   0              0.0034820369   15.827209      0              84915474       2.6109412e-16  0              2.9973792    
    600000   189.6          200            200            0.0018447833  -7.2896311e-36  0              0.0055343499   6.674002e-05   0              358.07074      2.6109412e-16  0              2.9963471    
    700000   189.6          200            200            0.0024247508   1.5566708e-36  0              0.0072742525   0.028855806    0              154815.95      2.6109412e-16  0              2.9956141    
    800000   189.6          200            200            0.0026442862  -2.3970404e-37  0              0.0079328585   0.010545548    0              56578.529      2.6109412e-16  0              2.9953538    
    900000   189.6          200            200            0.0027231397   4.2038235e-37  0              0.0081694191   0.0025637566   0              13754.959      2.6109412e-16  0              2.9952624    
   1000000   189.6          200            200            0.0027506927  -3.7984793e-37  0              0.0082520782   0.00052508755  0              2817.1776      2.6109412e-16  0              2.9952308    
   1100000   189.6          200            200            0.0027600706   4.3231785e-38  0              0.0082802117   9.6722847e-05  0              518.93335      2.6109412e-16  0              2.9952201    
   1200000   189.6          200            200            0.0027631707  -2.5478234e-38  0              0.0082895122   1.6507095e-05  0              88.563172      2.6109412e-16  0              2.9952166    
   1300000   189.6          200            200            0.0027641599  -7.4070438e-39  0              0.0082924796   2.6530553e-06  0              14.234061      2.6109412e-16  0              2.9952155    
   1400000   189.6          200            200            0.0027644609  -2.1087427e-39  0              0.0082933827   4.0547784e-07  0              2.1754526      2.6109412e-16  0              2.9952151    
   1500000   189.6          200            200            0.0027645464  -1.6273373e-38  0              0.0082936391   5.9275974e-08  0              0.31802496     2.6109412e-16  0              2.995215     
   1600000   189.6          200            200            0.0027645679  -4.5402236e-39  0              0.0082937036   8.316404e-09   0              0.04461882     2.6109412e-16  0              2.995215     
   1700000   189.6          200            200            0.002764572    2.2472924e-41  0              0.0082937159   1.1214477e-09  0              0.0060167439   2.6109412e-16  0              2.995215     
   1800000   189.6          200            200            0.0027645721   1.8046315e-38  0              0.0082937162   1.4532773e-10  0              0.00077970621  2.6109412e-16  0              2.995215     
   1900000   189.6          200            200            0.0027645716   2.6024359e-39  0              0.0082937147   1.8066278e-11  0              9.6928435e-05  2.6109412e-16  0              2.995215     
   2000000   189.6          200            200            0.0027645712   8.030279e-40   0              0.0082937136   2.1464265e-12  0              1.1515917e-05  2.6109412e-16  0              2.995215     
   2100000   189.6          200            200            0.002764571   -3.5363143e-39  0              0.008293713    2.4218496e-13  0              1.2993605e-06  2.6109412e-16  0              2.995215     
   2200000   189.6          200            200            0.0027645709  -1.6869879e-38  0              0.0082937127   2.5667004e-14  0              1.3770753e-07  2.6109412e-16  0              2.995215     
   2300000   189.6          200            200            0.0027645708  -3.3843334e-39  0              0.0082937125   2.5095379e-15  0              1.3464067e-08  2.6109412e-16  0              2.995215     
   2400000   189.6          200            200            0.0027645708   2.8500966e-39  0              0.0082937125   2.1815534e-16  0              1.1704378e-09  2.6109412e-16  0              2.995215     
   2500000   189.6          200            200            0.0027645708   1.3274837e-38  0              0.0082937125   1.5395048e-17  0              8.2596865e-11  2.6109412e-16  0              2.995215     
   2600000   189.6          200            200            0.0027645708   1.3332072e-38  0              0.0082937125   5.9060916e-19  0              3.1687114e-12  2.6109412e-16  0              2.995215     
   2700000   189.6          200            200            0.0027645708  -4.0785687e-38  0              0.0082937125   1.722507e-20   0              9.2415222e-14  2.6109412e-16  0              2.995215     
   2800000   189.6          200            200            0.0027645708   2.1505328e-39  0              0.0082937125   1.9544642e-20  0              1.0486009e-13  2.6109412e-16  0              2.995215     
   2900000   189.6          200            200            0.0027645708   4.0797139e-39  0              0.0082937125   1.6029253e-19  0              8.5999473e-13  2.6109412e-16  0              2.995215     
   3000000   189.6          200            200            0.0027645708   8.4978142e-40  0              0.0082937125   2.3290806e-22  0              1.2495885e-15  2.6109412e-16  0              2.995215     
Loop time of 62.9897 on 4 procs for 3000000 steps with 50 atoms

Performance: 41149612.609 ns/day, 0.000 hours/ns, 47626.866 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.28991    | 1.5353     | 5.0137     | 162.2 |  2.44
Neigh   | 0.096431   | 0.096969   | 0.098463   |   0.3 |  0.15
Comm    | 25.128     | 31.787     | 37.481     |  84.6 | 50.46
Output  | 0.097165   | 0.097246   | 0.097308   |   0.0 |  0.15
Modify  | 14.955     | 20.824     | 28.128     | 121.6 | 33.06
Other   |            | 8.649      |            |       | 13.73

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.5
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 82

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.33                                                               
Lattice spacing in x,y,z = 6.33 6.33 6.33

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -94.95 ${n1e1} -100 100 -100 100 units box
region box block -94.95 94.95 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.95 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -94.95 94.95 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-94.95 -100 -100) to (94.95 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-94.95 -100 -100) to (94.95 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-94.95 -100 -100) to (94.95 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_82_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.11 | 18.58 | 19.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   189.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   189.9          200            200            0.0022260498   1.0449528e-37  0              0.0066781495   12109.07       0              5.8470365e+10  2.6109412e-16  0              3.3327477    
    200000   189.9          200            200            0.00074592446 -1.9730836e-37  0              0.0022377734   2702.7137      0              1.3050437e+10  2.6109412e-16  0              3.0851423    
    300000   189.9          200            200           -5.3793868e-05  6.6907427e-36  0             -0.0001613816   34.623228      0              1.6718318e+08  2.6109412e-16  0              3.0418349    
    400000   189.9          200            200            0.0044064404  -3.6262862e-35  0              0.013219321    184.31717      0              8.9000166e+08  2.6109412e-16  0              2.9933503    
    500000   189.9          200            200            0.0010062226   5.2716895e-35  0              0.0030186677   12.747932      0              61555202       2.6109412e-16  0              2.9976165    
    600000   189.9          200            200            0.0018452652  -2.7047361e-35  0              0.0055357957   0.04433774     0              214091.08      2.6109412e-16  0              2.9963398    
    700000   189.9          200            200            0.0024312948   4.0057269e-36  0              0.0072938845   0.062189375    0              300290.23      2.6109412e-16  0              2.9956006    
    800000   189.9          200            200            0.0026461557   3.9286083e-36  0              0.0079384672   0.017034424    0              82253.137      2.6109412e-16  0              2.9953464    
    900000   189.9          200            200            0.0027217606   9.8245235e-38  0              0.0081652819   0.0036126744   0              17444.312      2.6109412e-16  0              2.9952589    
   1000000   189.9          200            200            0.0027476503   3.7955738e-38  0              0.008242951    0.00067830944  0              3275.3135      2.6109412e-16  0              2.9952293    
   1100000   189.9          200            200            0.0027562629   1.4721039e-37  0              0.0082687888   0.0001173375   0              566.58079      2.6109412e-16  0              2.9952195    
   1200000   189.9          200            200            0.0027590317   5.9846255e-39  0              0.008277095    1.9061775e-05  0              92.042488      2.6109412e-16  0              2.9952163    
   1300000   189.9          200            200            0.002759883   -3.7329636e-38  0              0.0082796491   2.9399735e-06  0              14.19608       2.6109412e-16  0              2.9952154    
   1400000   189.9          200            200            0.0027601286  -5.6110602e-39  0              0.0082803858   4.3332339e-07  0              2.0923636      2.6109412e-16  0              2.9952151    
   1500000   189.9          200            200            0.0027601923   2.436665e-38   0              0.0082805768   6.12651e-08    0              0.29582724     2.6109412e-16  0              2.995215     
   1600000   189.9          200            200            0.0027602054   1.6887423e-38  0              0.0082806162   8.3240067e-09  0              0.040193649    2.6109412e-16  0              2.995215     
   1700000   189.9          200            200            0.0027602064  -1.397078e-38   0              0.0082806191   1.08703e-09    0              0.0052488787   2.6109412e-16  0              2.995215     
   1800000   189.9          200            200            0.0027602053  -7.0453524e-39  0              0.0082806159   1.3624094e-10  0              0.00065785874  2.6109412e-16  0              2.995215     
   1900000   189.9          200            200            0.0027602044   3.8083717e-39  0              0.0082806131   1.6333698e-11  0              7.886958e-05   2.6109412e-16  0              2.995215     
   2000000   189.9          200            200            0.0027602039   7.1847348e-40  0              0.0082806116   1.8626712e-12  0              8.9941728e-06  2.6109412e-16  0              2.995215     
   2100000   189.9          200            200            0.0027602036  -1.2996323e-38  0              0.0082806108   2.0012775e-13  0              9.6634527e-07  2.6109412e-16  0              2.995215     
   2200000   189.9          200            200            0.0027602035   6.5242987e-39  0              0.0082806105   1.9923318e-14  0              9.6202573e-08  2.6109412e-16  0              2.995215     
   2300000   189.9          200            200            0.0027602034  -1.5303286e-38  0              0.0082806103   1.7874043e-15  0              8.6307357e-09  2.6109412e-16  0              2.995215     
   2400000   189.9          200            200            0.0027602034   1.569897e-38   0              0.0082806103   1.3481401e-16  0              6.5096863e-10  2.6109412e-16  0              2.995215     
   2500000   189.9          200            200            0.0027602034  -1.008879e-39   0              0.0082806102   7.2803532e-18  0              3.515422e-11   2.6109412e-16  0              2.995215     
   2600000   189.9          200            200            0.0027602034   1.0911349e-38  0              0.0082806102   1.0139483e-19  0              4.8959936e-13  2.6109412e-16  0              2.995215     
   2700000   189.9          200            200            0.0027602034   6.1012483e-39  0              0.0082806102   1.9109992e-21  0              9.2275313e-15  2.6109412e-16  0              2.995215     
   2800000   189.9          200            200            0.0027602034   2.0342654e-38  0              0.0082806102   2.3116506e-20  0              1.1162134e-13  2.6109412e-16  0              2.995215     
   2900000   189.9          200            200            0.0027602034  -1.2806038e-38  0              0.0082806102   3.9500165e-21  0              1.9073216e-14  2.6109412e-16  0              2.995215     
   3000000   189.9          200            200            0.0027602034   1.3847972e-38  0              0.0082806102   1.2885766e-19  0              6.2220751e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1899 on 4 procs for 3000000 steps with 51 atoms

Performance: 40380158.544 ns/day, 0.000 hours/ns, 46736.295 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.29656    | 1.5533     | 5.0687     | 162.9 |  2.42
Neigh   | 0.096363   | 0.096953   | 0.098521   |   0.3 |  0.15
Comm    | 25.7       | 32.649     | 38.461     |  86.8 | 50.86
Output  | 0.062269   | 0.062354   | 0.062422   |   0.0 |  0.10
Modify  | 15.178     | 21.156     | 28.77      | 124.7 | 32.96
Other   |            | 8.672      |            |       | 13.51

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 83

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.34                                                               
Lattice spacing in x,y,z = 6.34 6.34 6.34

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -95.1 ${n1e1} -100 100 -100 100 units box
region box block -95.1 95.1 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.1 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.1 95.1 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-95.1 -100 -100) to (95.1 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-95.1 -100 -100) to (95.1 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-95.1 -100 -100) to (95.1 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_83_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.11 | 18.58 | 19.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   190.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   190.2          200            200            0.0022215192   2.6229033e-39  0              0.0066645577   12101.024      0              5.8431513e+10  2.6109412e-16  0              3.332953     
    200000   190.2          200            200            0.0007409998   6.3595899e-37  0              0.0022229994   2681.281       0              1.2946946e+10  2.6109412e-16  0              3.0860455    
    300000   190.2          200            200           -6.2162555e-05  1.7082758e-36  0             -0.00018648767  47.31562       0              2.284702e+08   2.6109412e-16  0              3.0411484    
    400000   190.2          200            200            0.005297449    3.6977555e-35  0              0.015892347    170.5418       0              8.2348532e+08  2.6109412e-16  0              2.992497     
    500000   190.2          200            200            0.00089203938 -3.0174824e-35  0              0.0026761181   10.202303      0              49263272       2.6109412e-16  0              2.9977984    
    600000   190.2          200            200            0.001853472   -2.66935e-35    0              0.0055604159   0.15715347     0              758837.84      2.6109412e-16  0              2.9963228    
    700000   190.2          200            200            0.0024395871   1.6335488e-36  0              0.0073187613   0.099341521    0              479684.65      2.6109412e-16  0              2.9955852    
    800000   190.2          200            200            0.0026483161   5.618605e-36   0              0.0079449484   0.023435463    0              113161.46      2.6109412e-16  0              2.9953387    
    900000   190.2          200            200            0.0027203638  -5.2561429e-37  0              0.0081610915   0.0045732045   0              22082.368      2.6109412e-16  0              2.9952555    
   1000000   190.2          200            200            0.0027445613  -4.2072123e-37  0              0.0082336839   0.00081027394  0              3912.5229      2.6109412e-16  0              2.9952278    
   1100000   190.2          200            200            0.0027524294   1.7804319e-37  0              0.0082572882   0.00013404839  0              647.27169      2.6109412e-16  0              2.9952188    
   1200000   190.2          200            200            0.0027548857  -3.8924039e-38  0              0.008264657    2.0990865e-05  0              101.35738      2.6109412e-16  0              2.9952161    
   1300000   190.2          200            200            0.0027556103  -1.6819248e-38  0              0.0082668308   3.1357064e-06  0              15.141204      2.6109412e-16  0              2.9952153    
   1400000   190.2          200            200            0.0027558057  -2.0061388e-38  0              0.0082674172   4.4891178e-07  0              2.1676343      2.6109412e-16  0              2.9952151    
   1500000   190.2          200            200            0.0027558501  -8.8736959e-39  0              0.0082675503   6.1736399e-08  0              0.29810298     2.6109412e-16  0              2.995215     
   1600000   190.2          200            200            0.002755856    3.7801418e-39  0              0.0082675679   8.1613432e-09  0              0.039408205    2.6109412e-16  0              2.995215     
   1700000   190.2          200            200            0.0027558542   6.1071676e-39  0              0.0082675627   1.0361277e-09  0              0.0050030897   2.6109412e-16  0              2.995215     
   1800000   190.2          200            200            0.0027558522   1.5407338e-38  0              0.0082675566   1.2598769e-10  0              0.00060834945  2.6109412e-16  0              2.995215     
   1900000   190.2          200            200            0.0027558509  -1.3435015e-38  0              0.0082675528   1.4600615e-11  0              7.0501143e-05  2.6109412e-16  0              2.995215     
   2000000   190.2          200            200            0.0027558503   1.6763142e-38  0              0.0082675509   1.5994359e-12  0              7.7231038e-06  2.6109412e-16  0              2.995215     
   2100000   190.2          200            200            0.00275585     3.8038661e-38  0              0.00826755     1.6340183e-13  0              7.8900896e-07  2.6109412e-16  0              2.995215     
   2200000   190.2          200            200            0.0027558499   8.3194738e-39  0              0.0082675496   1.521936e-14   0              7.3488844e-08  2.6109412e-16  0              2.995215     
   2300000   190.2          200            200            0.0027558498   2.1974538e-39  0              0.0082675494   1.235919e-15   0              5.9678105e-09  2.6109412e-16  0              2.995215     
   2400000   190.2          200            200            0.0027558498  -1.7523054e-38  0              0.0082675494   7.7238907e-17  0              3.7295904e-10  2.6109412e-16  0              2.995215     
   2500000   190.2          200            200            0.0027558498   2.6949976e-39  0              0.0082675493   2.5905762e-18  0              1.2508965e-11  2.6109412e-16  0              2.995215     
   2600000   190.2          200            200            0.0027558498   1.270558e-38   0              0.0082675493   1.2121409e-20  0              5.8529946e-14  2.6109412e-16  0              2.995215     
   2700000   190.2          200            200            0.0027558498   1.251424e-39   0              0.0082675493   3.6271134e-20  0              1.7514033e-13  2.6109412e-16  0              2.995215     
   2800000   190.2          200            200            0.0027558498   2.0266579e-38  0              0.0082675493   4.4189116e-20  0              2.1337342e-13  2.6109412e-16  0              2.995215     
   2900000   190.2          200            200            0.0027558498   3.4204612e-38  0              0.0082675493   1.9439917e-20  0              9.3868404e-14  2.6109412e-16  0              2.995215     
   3000000   190.2          200            200            0.0027558498   1.7978046e-38  0              0.0082675493   1.0605319e-19  0              5.1209289e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2706 on 4 procs for 3000000 steps with 51 atoms

Performance: 40329452.911 ns/day, 0.000 hours/ns, 46677.608 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30987    | 1.5471     | 5.0197     | 161.3 |  2.41
Neigh   | 0.096417   | 0.097001   | 0.098546   |   0.3 |  0.15
Comm    | 25.643     | 32.597     | 38.44      |  87.1 | 50.72
Output  | 0.062081   | 0.062162   | 0.062226   |   0.0 |  0.10
Modify  | 15.173     | 21.174     | 28.801     | 124.8 | 32.94
Other   |            | 8.793      |            |       | 13.68

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 84

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.35                                                               
Lattice spacing in x,y,z = 6.35 6.35 6.35

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -95.25 ${n1e1} -100 100 -100 100 units box
region box block -95.25 95.25 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.25 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.25 95.25 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-95.25 -100 -100) to (95.25 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-95.25 -100 -100) to (95.25 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-95.25 -100 -100) to (95.25 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_84_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 123 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.11 | 18.58 | 19.74 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   190.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   190.5          200            200            0.0022169694   7.216397e-40   0              0.0066509082   12092.665      0              5.839115e+10   2.6109412e-16  0              3.3331844    
    200000   190.5          200            200            0.00073584037  1.29314e-38    0              0.0022075211   2658.439       0              1.283665e+10   2.6109412e-16  0              3.0870449    
    300000   190.5          200            200           -6.9150608e-05  1.7062924e-36  0             -0.00020745182  59.758424      0              2.8855204e+08  2.6109412e-16  0              3.0404934    
    400000   190.5          200            200            0.006064727    3.6677207e-35  0              0.018194181    154.75295      0              7.4724659e+08  2.6109412e-16  0              2.9917971    
    500000   190.5          200            200            0.00080624395 -7.0237306e-36  0              0.0024187318   8.1282195      0              39248263       2.6109412e-16  0              2.9979389    
    600000   190.5          200            200            0.0018662584  -3.3236699e-35  0              0.0055987751   0.3079992      0              1487217.9      2.6109412e-16  0              2.9963001    
    700000   190.5          200            200            0.0024485816   4.0550843e-36  0              0.0073457448   0.13686994     0              660895.94      2.6109412e-16  0              2.9955691    
    800000   190.5          200            200            0.0026504436   2.2013362e-37  0              0.0079513308   0.029416851    0              142043.45      2.6109412e-16  0              2.9953311    
    900000   190.5          200            200            0.0027188578   5.998976e-37   0              0.0081565735   0.0054221763   0              26181.749      2.6109412e-16  0              2.9952522    
   1000000   190.5          200            200            0.0027414031   5.0983389e-37  0              0.0082242094   0.0009210447   0              4447.3952      2.6109412e-16  0              2.9952264    
   1100000   190.5          200            200            0.0027485659   2.6614419e-37  0              0.0082456978   0.00014729658  0              711.24245      2.6109412e-16  0              2.9952183    
   1200000   190.5          200            200            0.0027507328  -5.514051e-38   0              0.0082521984   2.2407867e-05  0              108.19957      2.6109412e-16  0              2.9952159    
   1300000   190.5          200            200            0.0027513421  -3.7982523e-39  0              0.0082540263   3.2616894e-06  0              15.749531      2.6109412e-16  0              2.9952152    
   1400000   190.5          200            200            0.0027514928   4.6225146e-39  0              0.0082544784   4.5573903e-07  0              2.2006007      2.6109412e-16  0              2.995215     
   1500000   190.5          200            200            0.0027515201   4.5589417e-39  0              0.0082545604   6.1206527e-08  0              0.29554442     2.6109412e-16  0              2.995215     
   1600000   190.5          200            200            0.0027515196   4.330095e-39   0              0.0082545589   7.898752e-09   0              0.038140247    2.6109412e-16  0              2.995215     
   1700000   190.5          200            200            0.0027515156   1.9649497e-38  0              0.0082545468   9.7757017e-10  0              0.0047203365   2.6109412e-16  0              2.995215     
   1800000   190.5          200            200            0.0027515127  -1.7490482e-39  0              0.0082545381   1.1557237e-10  0              0.00055805762  2.6109412e-16  0              2.995215     
   1900000   190.5          200            200            0.0027515112  -2.7259277e-38  0              0.0082545335   1.2965013e-11  0              6.2603405e-05  2.6109412e-16  0              2.995215     
   2000000   190.5          200            200            0.0027515104  -8.3786594e-39  0              0.0082545313   1.3650208e-12  0              6.5911969e-06  2.6109412e-16  0              2.995215     
   2100000   190.5          200            200            0.0027515101   9.6851658e-39  0              0.0082545303   1.324294e-13   0              6.3945417e-07  2.6109412e-16  0              2.995215     
   2200000   190.5          200            200            0.0027515099  -1.5073721e-38  0              0.0082545298   1.1456911e-14  0              5.5321322e-08  2.6109412e-16  0              2.995215     
   2300000   190.5          200            200            0.0027515099  -4.9450352e-39  0              0.0082545297   8.2555386e-16  0              3.9863041e-09  2.6109412e-16  0              2.995215     
   2400000   190.5          200            200            0.0027515099   1.5875019e-38  0              0.0082545296   3.9683022e-17  0              1.9161511e-10  2.6109412e-16  0              2.995215     
   2500000   190.5          200            200            0.0027515099   1.0255175e-38  0              0.0082545296   4.8815623e-19  0              2.3571318e-12  2.6109412e-16  0              2.995215     
   2600000   190.5          200            200            0.0027515099   4.1549528e-39  0              0.0082545296   1.8169348e-19  0              8.7733279e-13  2.6109412e-16  0              2.995215     
   2700000   190.5          200            200            0.0027515099   2.8392283e-38  0              0.0082545296   9.8503423e-20  0              4.7563778e-13  2.6109412e-16  0              2.995215     
   2800000   190.5          200            200            0.0027515099  -4.2919246e-39  0              0.0082545296   6.2425391e-20  0              3.0142987e-13  2.6109412e-16  0              2.995215     
   2900000   190.5          200            200            0.0027515099   2.5899932e-38  0              0.0082545296   2.3046782e-20  0              1.1128466e-13  2.6109412e-16  0              2.995215     
   3000000   190.5          200            200            0.0027515099   2.9217228e-38  0              0.0082545296   8.5501087e-20  0              4.1285415e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0707 on 4 procs for 3000000 steps with 51 atoms

Performance: 40455334.898 ns/day, 0.000 hours/ns, 46823.304 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31276    | 1.5634     | 5.0747     | 162.2 |  2.44
Neigh   | 0.096404   | 0.096984   | 0.098548   |   0.3 |  0.15
Comm    | 25.755     | 32.648     | 38.45      |  86.6 | 50.96
Output  | 0.061556   | 0.061636   | 0.061696   |   0.0 |  0.10
Modify  | 15.162     | 21.136     | 28.671     | 124.3 | 32.99
Other   |            | 8.565      |            |       | 13.37

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 85

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.36                                                               
Lattice spacing in x,y,z = 6.36 6.36 6.36

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -95.4 ${n1e1} -100 100 -100 100 units box
region box block -95.4 95.4 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.4 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.4 95.4 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-95.4 -100 -100) to (95.4 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-95.4 -100 -100) to (95.4 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-95.4 -100 -100) to (95.4 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_85_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 124 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.13 | 18.6 | 19.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   190.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   190.8          200            200            0.0022124002  -4.1272469e-37  0              0.0066372007   12083.988      0              5.8349253e+10  2.6109412e-16  0              3.3334432    
    200000   190.8          200            200            0.00073044822 -1.9197882e-37  0              0.0021913447   2634.204       0              1.2719628e+10  2.6109412e-16  0              3.088141     
    300000   190.8          200            200           -7.4992732e-05 -1.1870005e-36  0             -0.0002249782   71.561145      0              3.4554316e+08  2.6109412e-16  0              3.0398838    
    400000   190.8          200            200            0.0067210338  -3.638843e-35   0              0.020163101    138.5159       0              6.6884371e+08  2.6109412e-16  0              2.9912192    
    500000   190.8          200            200            0.00074042661  6.1615764e-36  0              0.0022212798   6.4399494      0              31096211       2.6109412e-16  0              2.9980491    
    600000   190.8          200            200            0.0018817591  -5.2480497e-38  0              0.0056452772   0.47861683     0              2311069.4      2.6109412e-16  0              2.9962741    
    700000   190.8          200            200            0.0024577515  -4.6860346e-36  0              0.0073732545   0.17317613     0              836205.53      2.6109412e-16  0              2.9955529    
    800000   190.8          200            200            0.0026524053  -1.0233754e-36  0              0.0079572159   0.034879541    0              168420.82      2.6109412e-16  0              2.9953237    
    900000   190.8          200            200            0.0027172179   7.9390137e-37  0              0.0081516537   0.0061626439   0              29757.202      2.6109412e-16  0              2.995249     
   1000000   190.8          200            200            0.002738176   -2.1514553e-37  0              0.0082145279   0.0010132201   0              4892.477       2.6109412e-16  0              2.9952251    
   1100000   190.8          200            200            0.002744676   -6.7375525e-39  0              0.0082340279   0.00015770122  0              761.48273      2.6109412e-16  0              2.9952178    
   1200000   190.8          200            200            0.0027465755   1.3582842e-38  0              0.0082397266   2.3426156e-05  0              113.11653      2.6109412e-16  0              2.9952157    
   1300000   190.8          200            200            0.0027470799  -9.2583039e-39  0              0.0082412397   3.3360654e-06  0              16.108666      2.6109412e-16  0              2.9952151    
   1400000   190.8          200            200            0.0027471903  -4.8384885e-40  0              0.008241571    4.564469e-07   0              2.2040187      2.6109412e-16  0              2.995215     
   1500000   190.8          200            200            0.0027472025   1.4143456e-38  0              0.0082416076   6.0030274e-08  0              0.28986471     2.6109412e-16  0              2.995215     
   1600000   190.8          200            200            0.0027471965  -1.1776194e-38  0              0.0082415894   7.5801011e-09  0              0.036601595    2.6109412e-16  0              2.995215     
   1700000   190.8          200            200            0.0027471904   3.2726123e-38  0              0.0082415712   9.162677e-10   0              0.0044243288   2.6109412e-16  0              2.995215     
   1800000   190.8          200            200            0.0027471868   1.8082358e-39  0              0.0082415604   1.0546736e-10  0              0.00050926413  2.6109412e-16  0              2.995215     
   1900000   190.8          200            200            0.002747185   -1.5440975e-38  0              0.008241555    1.1460206e-11  0              5.5337232e-05  2.6109412e-16  0              2.995215     
   2000000   190.8          200            200            0.0027471842   1.4869509e-38  0              0.0082415526   1.1586968e-12  0              5.594932e-06   2.6109412e-16  0              2.995215     
   2100000   190.8          200            200            0.0027471838   7.2300741e-39  0              0.0082415515   1.0632146e-13  0              5.1338827e-07  2.6109412e-16  0              2.995215     
   2200000   190.8          200            200            0.0027471837  -9.2371558e-39  0              0.008241551    8.4417637e-15  0              4.0762256e-08  2.6109412e-16  0              2.995215     
   2300000   190.8          200            200            0.0027471836   1.3986572e-38  0              0.0082415509   5.2403847e-16  0              2.5303942e-09  2.6109412e-16  0              2.995215     
   2400000   190.8          200            200            0.0027471836   7.5229828e-39  0              0.0082415508   1.6632458e-17  0              8.0312188e-11  2.6109412e-16  0              2.995215     
   2500000   190.8          200            200            0.0027471836   1.0206964e-38  0              0.0082415508   1.7284945e-20  0              8.3462813e-14  2.6109412e-16  0              2.995215     
   2600000   190.8          200            200            0.0027471836   3.3423002e-38  0              0.0082415507   5.5062675e-19  0              2.6587795e-12  2.6109412e-16  0              2.995215     
   2700000   190.8          200            200            0.0027471836  -9.9558231e-39  0              0.0082415507   1.7931203e-19  0              8.6583364e-13  2.6109412e-16  0              2.995215     
   2800000   190.8          200            200            0.0027471836  -3.5556338e-39  0              0.0082415507   8.2873948e-20  0              4.0016864e-13  2.6109412e-16  0              2.995215     
   2900000   190.8          200            200            0.0027471836   4.2704936e-39  0              0.0082415507   5.8932973e-20  0              2.8456624e-13  2.6109412e-16  0              2.995215     
   3000000   190.8          200            200            0.0027471836   3.3736951e-38  0              0.0082415507   3.1931902e-20  0              1.5418773e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9542 on 4 procs for 3000000 steps with 51 atoms

Performance: 40529003.541 ns/day, 0.000 hours/ns, 46908.569 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32143    | 1.5168     | 4.9273     | 159.9 |  2.37
Neigh   | 0.097282   | 0.097816   | 0.099308   |   0.3 |  0.15
Comm    | 25.682     | 32.439     | 38.269     |  85.8 | 50.72
Output  | 0.063336   | 0.063421   | 0.063487   |   0.0 |  0.10
Modify  | 15.16      | 21.075     | 28.49      | 123.2 | 32.95
Other   |            | 8.763      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 86

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.37                                                               
Lattice spacing in x,y,z = 6.37 6.37 6.37

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -95.55 ${n1e1} -100 100 -100 100 units box
region box block -95.55 95.55 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.55 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.55 95.55 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-95.55 -100 -100) to (95.55 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-95.55 -100 -100) to (95.55 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-95.55 -100 -100) to (95.55 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_86_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 124 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.13 | 18.6 | 19.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   191.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   191.1          200            200            0.0022078119   6.2002618e-37  0              0.0066234356   12074.99       0              5.8305804e+10  2.6109412e-16  0              3.333731     
    200000   191.1          200            200            0.0007248305  -2.4577037e-36  0              0.0021744915   2608.6232      0              1.2596108e+10  2.6109412e-16  0              3.0893326    
    300000   191.1          200            200           -7.9943112e-05  4.6921599e-37  0             -0.00023982934  82.643315      0              3.9905499e+08  2.6109412e-16  0              3.0393201    
    400000   191.1          200            200            0.0072816195   1.0888882e-34  0              0.021844859    122.71166      0              5.9253068e+08  2.6109412e-16  0              2.9907382    
    500000   191.1          200            200            0.00068903799 -3.6755377e-36  0              0.002067114    5.0635448      0              24450045       2.6109412e-16  0              2.9981363    
    600000   191.1          200            200            0.0018988643   1.3491619e-35  0              0.0056965929   0.65821537     0              3178286.4      2.6109412e-16  0              2.9962462    
    700000   191.1          200            200            0.0024668254   3.5506973e-36  0              0.0074004762   0.20754584     0              1002164.6      2.6109412e-16  0              2.9955369    
    800000   191.1          200            200            0.0026541488   2.3663788e-37  0              0.0079624464   0.03981458     0              192250.36      2.6109412e-16  0              2.9953167    
    900000   191.1          200            200            0.0027154427   6.8443554e-37  0              0.008146328    0.006804812    0              32858.002      2.6109412e-16  0              2.9952461    
   1000000   191.1          200            200            0.0027348859   3.5787021e-37  0              0.0082046576   0.0010896021   0              5261.2988      2.6109412e-16  0              2.9952239    
   1100000   191.1          200            200            0.0027407641   1.2559771e-37  0              0.0082222923   0.0001658033   0              800.60478      2.6109412e-16  0              2.9952173    
   1200000   191.1          200            200            0.0027424164  -1.9906525e-38  0              0.0082272491   2.4135056e-05  0              116.53955      2.6109412e-16  0              2.9952155    
   1300000   191.1          200            200            0.0027428248  -2.2920026e-38  0              0.0082284744   3.3721547e-06  0              16.282928      2.6109412e-16  0              2.995215     
   1400000   191.1          200            200            0.0027428988   1.0673876e-38  0              0.0082286964   4.5286364e-07  0              2.1867165      2.6109412e-16  0              2.995215     
   1500000   191.1          200            200            0.0027428975   1.6140028e-38  0              0.0082286924   5.8439197e-08  0              0.28218197     2.6109412e-16  0              2.995215     
   1600000   191.1          200            200            0.0027428865   3.6951753e-39  0              0.0082286594   7.2321607e-09  0              0.034921516    2.6109412e-16  0              2.995215     
   1700000   191.1          200            200            0.0027428786   2.1279634e-38  0              0.0082286359   8.5495259e-10  0              0.0041282601   2.6109412e-16  0              2.995215     
   1800000   191.1          200            200            0.0027428744  -2.1899277e-38  0              0.0082286233   9.5898583e-11  0              0.00046305994  2.6109412e-16  0              2.995215     
   1900000   191.1          200            200            0.0027428724   3.0850569e-38  0              0.0082286173   1.0094573e-11  0              4.874308e-05   2.6109412e-16  0              2.995215     
   2000000   191.1          200            200            0.0027428715   1.0191395e-38  0              0.0082286146   9.7893742e-13  0              4.7269384e-06  2.6109412e-16  0              2.995215     
   2100000   191.1          200            200            0.0027428711  -2.4120372e-38  0              0.0082286134   8.4603988e-14  0              4.0852238e-07  2.6109412e-16  0              2.995215     
   2200000   191.1          200            200            0.002742871    5.3696096e-39  0              0.008228613    6.0831725e-15  0              2.9373463e-08  2.6109412e-16  0              2.995215     
   2300000   191.1          200            200            0.0027428709  -1.0916574e-38  0              0.0082286128   3.0845e-16     0              1.4893946e-09  2.6109412e-16  0              2.995215     
   2400000   191.1          200            200            0.0027428709   7.7183866e-39  0              0.0082286127   4.2784615e-18  0              2.0659159e-11  2.6109412e-16  0              2.995215     
   2500000   191.1          200            200            0.0027428709   4.039055e-38   0              0.0082286127   7.4183808e-19  0              3.5820706e-12  2.6109412e-16  0              2.995215     
   2600000   191.1          200            200            0.0027428709   3.3339135e-39  0              0.0082286127   1.0000673e-18  0              4.8289669e-12  2.6109412e-16  0              2.995215     
   2700000   191.1          200            200            0.0027428709  -2.5961364e-38  0              0.0082286127   2.7605299e-19  0              1.3329611e-12  2.6109412e-16  0              2.995215     
   2800000   191.1          200            200            0.0027428709   9.7655126e-40  0              0.0082286127   1.0046876e-19  0              4.8512766e-13  2.6109412e-16  0              2.995215     
   2900000   191.1          200            200            0.0027428709  -2.0958622e-39  0              0.0082286127   1.6817806e-20  0              8.1207166e-14  2.6109412e-16  0              2.995215     
   3000000   191.1          200            200            0.0027428709   2.7977865e-38  0              0.0082286127   1.3379882e-19  0              6.4606664e-13  2.6109412e-16  0              2.995215     
Loop time of 64.231 on 4 procs for 3000000 steps with 51 atoms

Performance: 40354323.979 ns/day, 0.000 hours/ns, 46706.393 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31044    | 1.5738     | 5.11       | 162.8 |  2.45
Neigh   | 0.097194   | 0.097742   | 0.099261   |   0.3 |  0.15
Comm    | 25.642     | 32.498     | 38.305     |  86.4 | 50.60
Output  | 0.061852   | 0.061934   | 0.062001   |   0.0 |  0.10
Modify  | 15.354     | 21.295     | 28.736     | 123.1 | 33.15
Other   |            | 8.705      |            |       | 13.55

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 87

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.38                                                               
Lattice spacing in x,y,z = 6.38 6.38 6.38

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -95.7 ${n1e1} -100 100 -100 100 units box
region box block -95.7 95.7 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.7 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.7 95.7 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-95.7 -100 -100) to (95.7 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-95.7 -100 -100) to (95.7 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-95.7 -100 -100) to (95.7 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_87_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 124 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.13 | 18.6 | 19.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   191.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   191.4          200            200            0.0022032044   5.6759371e-37  0              0.0066096131   12065.667      0              5.8260789e+10  2.6109412e-16  0              3.3340491    
    200000   191.4          200            200            0.00071900017  2.0355047e-38  0              0.0021570005   2581.7781      0              1.2466482e+10  2.6109412e-16  0              3.0906161    
    300000   191.4          200            200           -8.4102835e-05 -7.6709956e-37  0             -0.00025230851  92.790776      0              4.4805345e+08  2.6109412e-16  0              3.0388097    
    400000   191.4          200            200            0.0077479259  -1.0167359e-35  0              0.023243778    108.20866      0              5.2250087e+08  2.6109412e-16  0              2.9903452    
    500000   191.4          200            200            0.00064948828  2.9494177e-36  0              0.0019484648   3.9720809      0              19179757       2.6109412e-16  0              2.998204     
    600000   191.4          200            200            0.0019162241   1.3596812e-35  0              0.0057486723   0.83455188     0              4029752.4      2.6109412e-16  0              2.9962183    
    700000   191.4          200            200            0.0024752661   2.1158059e-37  0              0.0074257982   0.23871148     0              1152652.3      2.6109412e-16  0              2.9955216    
    800000   191.4          200            200            0.0026554826  -1.6710101e-37  0              0.0079664479   0.044114448    0              213012.88      2.6109412e-16  0              2.9953101    
    900000   191.4          200            200            0.0027134669   6.2032392e-39  0              0.0081404007   0.0073436597   0              35459.904      2.6109412e-16  0              2.9952434    
   1000000   191.4          200            200            0.0027315114   5.0843799e-38  0              0.0081945341   0.0011508411   0              5556.9996      2.6109412e-16  0              2.9952229    
   1100000   191.4          200            200            0.0027368235   1.7470896e-38  0              0.0082104704   0.0001718628   0              829.86395      2.6109412e-16  0              2.9952169    
   1200000   191.4          200            200            0.0027382532   1.5735498e-38  0              0.0082147595   2.4590183e-05  0              118.73719      2.6109412e-16  0              2.9952153    
   1300000   191.4          200            200            0.0027385762   1.6267508e-38  0              0.0082157285   3.3796515e-06  0              16.319127      2.6109412e-16  0              2.995215     
   1400000   191.4          200            200            0.0027386181   4.4474219e-39  0              0.0082158542   4.4649112e-07  0              2.1559458      2.6109412e-16  0              2.995215     
   1500000   191.4          200            200            0.0027386049  -5.0196841e-39  0              0.0082158146   5.6646222e-08  0              0.27352433     2.6109412e-16  0              2.995215     
   1600000   191.4          200            200            0.0027385896   2.2471487e-39  0              0.0082157688   6.8827838e-09  0              0.0332345      2.6109412e-16  0              2.995215     
   1700000   191.4          200            200            0.0027385803   8.6808811e-40  0              0.0082157408   7.9695142e-10  0              0.0038481932   2.6109412e-16  0              2.995215     
   1800000   191.4          200            200            0.0027385755   1.7726581e-38  0              0.0082157266   8.7215313e-11  0              0.00042113153  2.6109412e-16  0              2.995215     
   1900000   191.4          200            200            0.0027385733   1.9304315e-38  0              0.00821572     8.8990441e-12  0              4.2970299e-05  2.6109412e-16  0              2.995215     
   2000000   191.4          200            200            0.0027385724  -1.5353388e-38  0              0.0082157171   8.2715296e-13  0              3.9940256e-06  2.6109412e-16  0              2.995215     
   2100000   191.4          200            200            0.002738572    4.1039919e-38  0              0.0082157159   6.7009182e-14  0              3.2356336e-07  2.6109412e-16  0              2.995215     
   2200000   191.4          200            200            0.0027385718  -1.2706166e-38  0              0.0082157155   4.2848976e-15  0              2.0690237e-08  2.6109412e-16  0              2.995215     
   2300000   191.4          200            200            0.0027385718   3.7609857e-38  0              0.0082157153   1.6373754e-16  0              7.9062996e-10  2.6109412e-16  0              2.995215     
   2400000   191.4          200            200            0.0027385717   6.9160877e-39  0              0.0082157152   9.4039484e-20  0              4.5408301e-13  2.6109412e-16  0              2.995215     
   2500000   191.4          200            200            0.0027385717   4.7722727e-39  0              0.0082157152   2.2681523e-18  0              1.0952095e-11  2.6109412e-16  0              2.995215     
   2600000   191.4          200            200            0.0027385717   1.9995789e-38  0              0.0082157152   1.5211506e-18  0              7.345092e-12   2.6109412e-16  0              2.995215     
   2700000   191.4          200            200            0.0027385717   1.0820924e-38  0              0.0082157152   3.4988978e-19  0              1.6894925e-12  2.6109412e-16  0              2.995215     
   2800000   191.4          200            200            0.0027385717   1.9207473e-38  0              0.0082157152   1.1830289e-19  0              5.712423e-13   2.6109412e-16  0              2.995215     
   2900000   191.4          200            200            0.0027385717   4.1304461e-39  0              0.0082157152   4.2642769e-20  0              2.0590667e-13  2.6109412e-16  0              2.995215     
   3000000   191.4          200            200            0.0027385717   1.2552005e-38  0              0.0082157152   3.3701343e-20  0              1.6273172e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0599 on 4 procs for 3000000 steps with 51 atoms

Performance: 40462130.173 ns/day, 0.000 hours/ns, 46831.169 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30815    | 1.5335     | 4.9953     | 161.5 |  2.39
Neigh   | 0.097249   | 0.097763   | 0.099272   |   0.3 |  0.15
Comm    | 25.744     | 32.525     | 38.347     |  85.7 | 50.77
Output  | 0.062595   | 0.062677   | 0.062741   |   0.0 |  0.10
Modify  | 15.121     | 21.066     | 28.506     | 123.4 | 32.88
Other   |            | 8.775      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 88

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.39                                                               
Lattice spacing in x,y,z = 6.39 6.39 6.39

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -95.85 ${n1e1} -100 100 -100 100 units box
region box block -95.85 95.85 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.85 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -95.85 95.85 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-95.85 -100 -100) to (95.85 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-95.85 -100 -100) to (95.85 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-95.85 -100 -100) to (95.85 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_88_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 124 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.13 | 18.6 | 19.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   191.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   191.7          200            200            0.0021985779  -1.5339592e-37  0              0.0065957336   12056.017      0              5.8214193e+10  2.6109412e-16  0              3.3343988    
    200000   191.7          200            200            0.00071297796 -1.2133775e-36  0              0.0021389339   2553.7951      0              1.2331363e+10  2.6109412e-16  0              3.0919854    
    300000   191.7          200            200           -8.7727124e-05  2.9376557e-36  0             -0.00026318137  102.29844      0              4.9396254e+08  2.6109412e-16  0              3.0383369    
    400000   191.7          200            200            0.0081505934   1.2579319e-35  0              0.02445178     94.699533      0              4.5727015e+08  2.6109412e-16  0              2.9900103    
    500000   191.7          200            200            0.00061746418  1.9335465e-35  0              0.0018523925   3.0706861      0              14827244       2.6109412e-16  0              2.998259     
    600000   191.7          200            200            0.0019341926  -2.2645608e-35  0              0.0058025777   1.0108232      0              4880903.5      2.6109412e-16  0              2.9961897    
    700000   191.7          200            200            0.0024834979   1.5899596e-37  0              0.0074504938   0.26793112     0              1293743.5      2.6109412e-16  0              2.9955067    
    800000   191.7          200            200            0.0026566325  -1.0008172e-36  0              0.0079698974   0.048004744    0              231797.73      2.6109412e-16  0              2.9953037    
    900000   191.7          200            200            0.0027113948   4.6213866e-38  0              0.0081341844   0.0078139527   0              37730.781      2.6109412e-16  0              2.9952408    
   1000000   191.7          200            200            0.0027280975  -1.0546635e-37  0              0.0081842925   0.0012018249   0              5803.1821      2.6109412e-16  0              2.9952219    
   1100000   191.7          200            200            0.0027328727  -1.0036615e-38  0              0.0081986182   0.00017651369  0              852.32145      2.6109412e-16  0              2.9952165    
   1200000   191.7          200            200            0.0027340935  -1.1714728e-38  0              0.0082022804   2.4866906e-05  0              120.07339      2.6109412e-16  0              2.9952152    
   1300000   191.7          200            200            0.0027343369   2.5901807e-38  0              0.0082030107   3.3665524e-06  0              16.255877      2.6109412e-16  0              2.9952149    
   1400000   191.7          200            200            0.0027343491  -1.0037607e-40  0              0.0082030474   4.3802964e-07  0              2.1150884      2.6109412e-16  0              2.9952149    
   1500000   191.7          200            200            0.0027343251   1.9437334e-38  0              0.0082029753   5.4687133e-08  0              0.26406459     2.6109412e-16  0              2.995215     
   1600000   191.7          200            200            0.0027343059  -5.7484371e-40  0              0.0082029178   6.5284409e-09  0              0.031523505    2.6109412e-16  0              2.995215     
   1700000   191.7          200            200            0.0027342952   9.3376641e-39  0              0.0082028857   7.4070449e-10  0              0.0035765969   2.6109412e-16  0              2.995215     
   1800000   191.7          200            200            0.00273429    -4.336099e-39   0              0.0082028701   7.9079312e-11  0              0.0003818457   2.6109412e-16  0              2.995215     
   1900000   191.7          200            200            0.0027342877  -1.1172188e-39  0              0.0082028631   7.8142073e-12  0              3.7732011e-05  2.6109412e-16  0              2.995215     
   2000000   191.7          200            200            0.0027342867  -3.5339956e-39  0              0.0082028601   6.9398245e-13  0              3.3509929e-06  2.6109412e-16  0              2.995215     
   2100000   191.7          200            200            0.0027342863   2.3877236e-38  0              0.0082028588   5.2272417e-14  0              2.524048e-07   2.6109412e-16  0              2.995215     
   2200000   191.7          200            200            0.0027342861  -1.2059675e-38  0              0.0082028583   2.890987e-15   0              1.3959541e-08  2.6109412e-16  0              2.995215     
   2300000   191.7          200            200            0.002734286    1.0897182e-38  0              0.0082028581   7.0019468e-17  0              3.3809895e-10  2.6109412e-16  0              2.995215     
   2400000   191.7          200            200            0.002734286    1.1979978e-39  0              0.0082028581   1.6916033e-18  0              8.1681471e-12  2.6109412e-16  0              2.995215     
   2500000   191.7          200            200            0.002734286    2.3257759e-39  0              0.008202858    4.3804361e-18  0              2.1151558e-11  2.6109412e-16  0              2.995215     
   2600000   191.7          200            200            0.002734286    2.722745e-38   0              0.008202858    2.0276085e-18  0              9.7905958e-12  2.6109412e-16  0              2.995215     
   2700000   191.7          200            200            0.002734286   -2.3665351e-38  0              0.008202858    4.816645e-19   0              2.3257855e-12  2.6109412e-16  0              2.995215     
   2800000   191.7          200            200            0.002734286    1.4433552e-38  0              0.008202858    1.4154681e-19  0              6.8347891e-13  2.6109412e-16  0              2.995215     
   2900000   191.7          200            200            0.002734286   -4.4891764e-39  0              0.008202858    9.1089922e-20  0              4.3984063e-13  2.6109412e-16  0              2.995215     
   3000000   191.7          200            200            0.002734286   -2.8153729e-38  0              0.008202858    4.5141484e-21  0              2.1797207e-14  2.6109412e-16  0              2.995215     
Loop time of 64.048 on 4 procs for 3000000 steps with 51 atoms

Performance: 40469623.197 ns/day, 0.000 hours/ns, 46839.842 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31308    | 1.5388     | 5.0153     | 161.9 |  2.40
Neigh   | 0.095938   | 0.096499   | 0.098024   |   0.3 |  0.15
Comm    | 25.784     | 32.469     | 38.219     |  84.8 | 50.69
Output  | 0.061498   | 0.061578   | 0.06164    |   0.0 |  0.10
Modify  | 15.251     | 21.16      | 28.492     | 122.2 | 33.04
Other   |            | 8.723      |            |       | 13.62

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           6.25 ave          25 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 25
Ave neighs/atom = 0.49019608
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 89

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.4                                                               
Lattice spacing in x,y,z = 6.4 6.4 6.4

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96 ${n1e1} -100 100 -100 100 units box
region box block -96 96 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96 96 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96 -100 -100) to (96 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-96 -100 -100) to (96 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96 -100 -100) to (96 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_89_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 124 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.13 | 18.6 | 19.76 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   192            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   192            200            200            0.0021939326   3.6044925e-37  0              0.0065817979   12046.039      0              5.8166009e+10  2.6109412e-16  0              3.3347815    
    200000   192            200            200            0.00070679549 -2.442484e-36   0              0.0021203865   2524.8638      0              1.2191664e+10  2.6109412e-16  0              3.0934304    
    300000   192            200            200           -9.0820963e-05  8.797626e-37   0             -0.00027246289  110.9549       0              5.3576149e+08  2.6109412e-16  0              3.0379099    
    400000   192            200            200            0.0084854094  -7.4269953e-36  0              0.025456228    82.737471      0              3.9950964e+08  2.6109412e-16  0              2.989734     
    500000   192            200            200            0.00059239711 -2.6746307e-35  0              0.0017771913   2.3581512      0              11386668       2.6109412e-16  0              2.9983018    
    600000   192            200            200            0.0019515924   2.3426692e-35  0              0.0058547772   1.1772521      0              5684529.1      2.6109412e-16  0              2.996162     
    700000   192            200            200            0.0024909769  -2.9528488e-37  0              0.0074729306   0.29405612     0              1419891.8      2.6109412e-16  0              2.9954927    
    800000   192            200            200            0.0026573844  -1.0051327e-36  0              0.0079721532   0.051370121    0              248047.93      2.6109412e-16  0              2.9952978    
    900000   192            200            200            0.002709146    6.260888e-38   0              0.008127438    0.008206566    0              39626.57       2.6109412e-16  0              2.9952385    
   1000000   192            200            200            0.0027246148   2.2543108e-38  0              0.0081738445   0.0012422811   0              5998.5306      2.6109412e-16  0              2.9952209    
   1100000   192            200            200            0.0027289014  -4.2453255e-39  0              0.0081867041   0.00017985124  0              868.43726      2.6109412e-16  0              2.9952162    
   1200000   192            200            200            0.0027299334   1.9721289e-38  0              0.0081898003   2.4994901e-05  0              120.69143      2.6109412e-16  0              2.9952151    
   1300000   192            200            200            0.0027301057   1.7317267e-38  0              0.008190317    3.3388216e-06  0              16.121975      2.6109412e-16  0              2.9952149    
   1400000   192            200            200            0.0027300915   2.9092142e-39  0              0.0081902746   4.2848597e-07  0              2.0690054      2.6109412e-16  0              2.9952149    
   1500000   192            200            200            0.002730058    1.452982e-38   0              0.0081901739   5.2714475e-08  0              0.25453933     2.6109412e-16  0              2.995215     
   1600000   192            200            200            0.0027300354   1.3952893e-38  0              0.0081901062   6.1903923e-09  0              0.029891189    2.6109412e-16  0              2.995215     
   1700000   192            200            200            0.0027300235   2.2377846e-38  0              0.0081900705   6.8893772e-10  0              0.0033266337   2.6109412e-16  0              2.995215     
   1800000   192            200            200            0.0027300179   7.2582713e-39  0              0.0081900537   7.1811082e-11  0              0.00034675001  2.6109412e-16  0              2.995215     
   1900000   192            200            200            0.0027300154   1.0618254e-38  0              0.0081900463   6.8727086e-12  0              3.318585e-05   2.6109412e-16  0              2.995215     
   2000000   192            200            200            0.0027300144   9.9657917e-39  0              0.0081900431   5.822283e-13   0              2.8113721e-06  2.6109412e-16  0              2.995215     
   2100000   192            200            200            0.002730014    1.3427113e-38  0              0.0081900419   4.0428421e-14  0              1.9521438e-07  2.6109412e-16  0              2.995215     
   2200000   192            200            200            0.0027300138  -1.2644877e-38  0              0.0081900414   1.8681206e-15  0              9.0204857e-09  2.6109412e-16  0              2.995215     
   2300000   192            200            200            0.0027300137   7.258588e-39   0              0.0081900412   1.9175458e-17  0              9.2591426e-11  2.6109412e-16  0              2.995215     
   2400000   192            200            200            0.0027300137   7.4107293e-39  0              0.0081900411   7.5426088e-18  0              3.6420558e-11  2.6109412e-16  0              2.995215     
   2500000   192            200            200            0.0027300137   8.7585132e-39  0              0.0081900411   6.7726264e-18  0              3.2702589e-11  2.6109412e-16  0              2.995215     
   2600000   192            200            200            0.0027300137   4.9704599e-39  0              0.0081900411   2.5886723e-18  0              1.2499772e-11  2.6109412e-16  0              2.995215     
   2700000   192            200            200            0.0027300137   5.7710175e-39  0              0.008190041    5.8461726e-19  0              2.8229075e-12  2.6109412e-16  0              2.995215     
   2800000   192            200            200            0.0027300137  -1.6902811e-38  0              0.008190041    1.5793212e-19  0              7.6259769e-13  2.6109412e-16  0              2.995215     
   2900000   192            200            200            0.0027300137   2.2276771e-38  0              0.008190041    4.2911499e-21  0              2.0720427e-14  2.6109412e-16  0              2.995215     
   3000000   192            200            200            0.0027300137  -3.95528e-38    0              0.008190041    1.4013406e-19  0              6.7665725e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8746 on 4 procs for 3000000 steps with 51 atoms

Performance: 40579518.209 ns/day, 0.000 hours/ns, 46967.035 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33161    | 1.5021     | 4.8632     | 158.4 |  2.35
Neigh   | 0.095969   | 0.096562   | 0.098114   |   0.3 |  0.15
Comm    | 25.685     | 32.327     | 38.047     |  84.6 | 50.61
Output  | 0.061836   | 0.061917   | 0.061983   |   0.0 |  0.10
Modify  | 15.23      | 21.089     | 28.373     | 121.5 | 33.02
Other   |            | 8.798      |            |       | 13.77

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 90

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.41                                                               
Lattice spacing in x,y,z = 6.41 6.41 6.41

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96.15 ${n1e1} -100 100 -100 100 units box
region box block -96.15 96.15 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.15 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.15 96.15 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96.15 -100 -100) to (96.15 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-96.15 -100 -100) to (96.15 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96.15 -100 -100) to (96.15 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_90_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 125 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.15 | 18.62 | 19.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   192.3          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   192.3          200            200            0.002189269    1.0350603e-37  0              0.0065678071   12035.73       0              5.8116231e+10  2.6109412e-16  0              3.3351984    
    200000   192.3          200            200            0.00070049739 -3.8427477e-37  0              0.0021014922   2495.2472      0              1.2048656e+10  2.6109412e-16  0              3.0949363    
    300000   192.3          200            200           -9.3564767e-05  5.9322199e-38  0             -0.0002806943   119.07388      0              5.7496513e+08  2.6109412e-16  0              3.0375131    
    400000   192.3          200            200            0.0087758162  -4.3471871e-36  0              0.026327449    71.820062      0              3.4679338e+08  2.6109412e-16  0              2.9894957    
    500000   192.3          200            200            0.00057179974 -6.9850104e-36  0              0.0017153992   1.7714174      0              8553540.6      2.6109412e-16  0              2.9983367    
    600000   192.3          200            200            0.0019691362  -1.5892112e-35  0              0.0059074085   1.3400153      0              6470454.3      2.6109412e-16  0              2.9961343    
    700000   192.3          200            200            0.0024982016   1.7207951e-36  0              0.0074946047   0.31841514     0              1537512.8      2.6109412e-16  0              2.9954791    
    800000   192.3          200            200            0.0026579727  -4.2797306e-36  0              0.0079739182   0.054411796    0              262735.09      2.6109412e-16  0              2.9952922    
    900000   192.3          200            200            0.0027068211   2.8639414e-37  0              0.0081204633   0.0085489454   0              41279.798      2.6109412e-16  0              2.9952362    
   1000000   192.3          200            200            0.0027211047  -1.0337e-37     0              0.0081633141   0.0012756503   0              6159.6587      2.6109412e-16  0              2.9952201    
   1100000   192.3          200            200            0.0027249257   3.67387e-39    0              0.0081747771   0.00018226749  0              880.10447      2.6109412e-16  0              2.9952158    
   1200000   192.3          200            200            0.0027257795  -5.9313409e-39  0              0.0081773384   2.5013148e-05  0              120.77954      2.6109412e-16  0              2.9952149    
   1300000   192.3          200            200            0.0027258848   1.9209384e-38  0              0.0081776545   3.2994239e-06  0              15.931737      2.6109412e-16  0              2.9952148    
   1400000   192.3          200            200            0.0027258461   1.0921111e-38  0              0.0081775384   4.1791784e-07  0              2.0179757      2.6109412e-16  0              2.9952149    
   1500000   192.3          200            200            0.0027258037  -5.1767082e-39  0              0.0081774111   5.0689077e-08  0              0.24475941     2.6109412e-16  0              2.995215     
   1600000   192.3          200            200            0.002725778   -7.0051207e-39  0              0.008177334    5.8573845e-09  0              0.028283213    2.6109412e-16  0              2.995215     
   1700000   192.3          200            200            0.0027257651   3.3685103e-39  0              0.0081772952   6.3945246e-10  0              0.0030876871   2.6109412e-16  0              2.995215     
   1800000   192.3          200            200            0.0027257591   4.6737514e-39  0              0.0081772772   6.5044722e-11  0              0.00031407768  2.6109412e-16  0              2.995215     
   1900000   192.3          200            200            0.0027257565  -1.1822659e-39  0              0.0081772695   6.0192928e-12  0              2.9065011e-05  2.6109412e-16  0              2.995215     
   2000000   192.3          200            200            0.0027257554   1.7827107e-38  0              0.0081772662   4.8425948e-13  0              2.3383157e-06  2.6109412e-16  0              2.995215     
   2100000   192.3          200            200            0.002725755   -1.0302237e-38  0              0.0081772649   3.0582749e-14  0              1.4767315e-07  2.6109412e-16  0              2.995215     
   2200000   192.3          200            200            0.0027257548   1.8646657e-38  0              0.0081772644   1.1028404e-15  0              5.3252216e-09  2.6109412e-16  0              2.995215     
   2300000   192.3          200            200            0.0027257547  -1.3827321e-38  0              0.0081772642   3.9560586e-19  0              1.9102391e-12  2.6109412e-16  0              2.995215     
   2400000   192.3          200            200            0.0027257547   2.9223782e-39  0              0.0081772641   1.7033115e-17  0              8.2246817e-11  2.6109412e-16  0              2.995215     
   2500000   192.3          200            200            0.0027257547   3.0522807e-38  0              0.0081772641   9.6182902e-18  0              4.6443281e-11  2.6109412e-16  0              2.995215     
   2600000   192.3          200            200            0.0027257547  -1.4420372e-39  0              0.0081772641   3.2093903e-18  0              1.5496997e-11  2.6109412e-16  0              2.995215     
   2700000   192.3          200            200            0.0027257547   3.2721266e-39  0              0.0081772641   6.8793526e-19  0              3.3217932e-12  2.6109412e-16  0              2.995215     
   2800000   192.3          200            200            0.0027257547   6.2530141e-40  0              0.0081772641   1.7587985e-19  0              8.4926084e-13  2.6109412e-16  0              2.995215     
   2900000   192.3          200            200            0.0027257547   3.0947783e-38  0              0.0081772641   1.8624582e-22  0              8.993144e-16   2.6109412e-16  0              2.995215     
   3000000   192.3          200            200            0.0027257547   2.1424907e-39  0              0.0081772641   9.8524716e-20  0              4.7574059e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9729 on 4 procs for 3000000 steps with 51 atoms

Performance: 40517179.585 ns/day, 0.000 hours/ns, 46894.884 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3076     | 1.5415     | 5.0155     | 161.6 |  2.41
Neigh   | 0.096752   | 0.097315   | 0.098858   |   0.3 |  0.15
Comm    | 25.59      | 32.461     | 38.244     |  86.5 | 50.74
Output  | 0.063345   | 0.063428   | 0.063495   |   0.0 |  0.10
Modify  | 15.148     | 21.109     | 28.596     | 123.8 | 33.00
Other   |            | 8.701      |            |       | 13.60

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 91

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.42                                                               
Lattice spacing in x,y,z = 6.42 6.42 6.42

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96.3 ${n1e1} -100 100 -100 100 units box
region box block -96.3 96.3 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.3 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.3 96.3 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96.3 -100 -100) to (96.3 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-96.3 -100 -100) to (96.3 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96.3 -100 -100) to (96.3 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_91_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 125 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.15 | 18.62 | 19.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   192.6          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   192.6          200            200            0.0021845876  -4.0877418e-37  0              0.0065537627   12025.091      0              5.8064862e+10  2.6109412e-16  0              3.3356505    
    200000   192.6          200            200            0.00069414645  2.4862803e-38  0              0.0020824394   2465.3109      0              1.1904104e+10  2.6109412e-16  0              3.0964824    
    300000   192.6          200            200           -9.591195e-05  -4.4465448e-36  0             -0.00028773585  126.39369      0              6.1030987e+08  2.6109412e-16  0              3.0371574    
    400000   192.6          200            200            0.0090144131   1.8288172e-35  0              0.027043239    62.422524      0              3.0141603e+08  2.6109412e-16  0              2.9892998    
    500000   192.6          200            200            0.00055574242  2.5690021e-35  0              0.0016672273   1.3177845      0              6363109.8      2.6109412e-16  0              2.9983635    
    600000   192.6          200            200            0.0019855161   4.2694382e-37  0              0.0059565482   1.4891518      0              7190581.1      2.6109412e-16  0              2.9961082    
    700000   192.6          200            200            0.0025045416   1.2600567e-36  0              0.0075136248   0.33979697     0              1640758        2.6109412e-16  0              2.9954665    
    800000   192.6          200            200            0.0026581434   2.1225706e-37  0              0.0079744303   0.057002826    0              275246.25      2.6109412e-16  0              2.995287     
    900000   192.6          200            200            0.0027043224   9.6042928e-38  0              0.0081129671   0.0088300812   0              42637.302      2.6109412e-16  0              2.9952342    
   1000000   192.6          200            200            0.0027175304  -4.7556345e-39  0              0.0081525912   0.0013013809   0              6283.9024      2.6109412e-16  0              2.9952193    
   1100000   192.6          200            200            0.0027209323   1.4991204e-38  0              0.008162797    0.00018381953  0              887.59872      2.6109412e-16  0              2.9952155    
   1200000   192.6          200            200            0.0027216267  -1.1056203e-38  0              0.00816488     2.4946508e-05  0              120.45776      2.6109412e-16  0              2.9952148    
   1300000   192.6          200            200            0.0027216727   1.2130206e-39  0              0.008165018    3.2537681e-06  0              15.711282      2.6109412e-16  0              2.9952148    
   1400000   192.6          200            200            0.0027216123   3.4024001e-39  0              0.0081648368   4.072758e-07   0              1.9665891      2.6109412e-16  0              2.9952149    
   1500000   192.6          200            200            0.0027215621  -7.2001146e-39  0              0.0081646862   4.8758931e-08  0              0.23543943     2.6109412e-16  0              2.9952149    
   1600000   192.6          200            200            0.0027215337   3.6514147e-39  0              0.008164601    5.5504849e-09  0              0.026801305    2.6109412e-16  0              2.995215     
   1700000   192.6          200            200            0.0027215198  -1.0147888e-38  0              0.0081645593   5.9501016e-10  0              0.0028730911   2.6109412e-16  0              2.995215     
   1800000   192.6          200            200            0.0027215135  -2.0211991e-38  0              0.0081645405   5.9110197e-11  0              0.00028542199  2.6109412e-16  0              2.995215     
   1900000   192.6          200            200            0.0027215108   2.9756293e-38  0              0.0081645324   5.2899449e-12  0              2.5543251e-05  2.6109412e-16  0              2.995215     
   2000000   192.6          200            200            0.0027215097   5.3413341e-39  0              0.0081645291   4.0332668e-13  0              1.9475202e-06  2.6109412e-16  0              2.995215     
   2100000   192.6          200            200            0.0027215092   3.3042837e-38  0              0.0081645277   2.2936397e-14  0              1.1075165e-07  2.6109412e-16  0              2.995215     
   2200000   192.6          200            200            0.0027215091   8.9220155e-39  0              0.0081645272   5.9402247e-16  0              2.8683219e-09  2.6109412e-16  0              2.995215     
   2300000   192.6          200            200            0.002721509    1.8544425e-39  0              0.008164527    6.9940437e-18  0              3.3771734e-11  2.6109412e-16  0              2.995215     
   2400000   192.6          200            200            0.002721509    8.717191e-39   0              0.0081645269   2.823529e-17   0              1.3633811e-10  2.6109412e-16  0              2.995215     
   2500000   192.6          200            200            0.002721509    3.5994147e-38  0              0.0081645269   1.2463298e-17  0              6.0180808e-11  2.6109412e-16  0              2.995215     
   2600000   192.6          200            200            0.002721509    5.7802548e-40  0              0.0081645269   3.7213477e-18  0              1.7969056e-11  2.6109412e-16  0              2.995215     
   2700000   192.6          200            200            0.002721509   -4.6382149e-39  0              0.0081645269   7.2070254e-19  0              3.4800146e-12  2.6109412e-16  0              2.995215     
   2800000   192.6          200            200            0.002721509    1.4770987e-38  0              0.0081645269   1.8281983e-19  0              8.8277153e-13  2.6109412e-16  0              2.995215     
   2900000   192.6          200            200            0.002721509    1.5874374e-38  0              0.0081645269   2.3828683e-20  0              1.1506018e-13  2.6109412e-16  0              2.995215     
   3000000   192.6          200            200            0.002721509    1.2312586e-38  0              0.0081645269   6.9609573e-20  0              3.3611972e-13  2.6109412e-16  0              2.995215     
Loop time of 64.0217 on 4 procs for 3000000 steps with 51 atoms

Performance: 40486290.621 ns/day, 0.000 hours/ns, 46859.133 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.33111    | 1.5288     | 4.933      | 159.0 |  2.39
Neigh   | 0.096597   | 0.097301   | 0.098837   |   0.3 |  0.15
Comm    | 25.713     | 32.562     | 38.301     |  86.2 | 50.86
Output  | 0.061974   | 0.062055   | 0.062117   |   0.0 |  0.10
Modify  | 15.164     | 21.069     | 28.523     | 123.1 | 32.91
Other   |            | 8.702      |            |       | 13.59

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 92

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.43                                                               
Lattice spacing in x,y,z = 6.43 6.43 6.43

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96.45 ${n1e1} -100 100 -100 100 units box
region box block -96.45 96.45 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.45 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.45 96.45 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96.45 -100 -100) to (96.45 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-96.45 -100 -100) to (96.45 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96.45 -100 -100) to (96.45 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_92_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 125 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.15 | 18.62 | 19.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   192.9          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   192.9          200            200            0.0021798888  -6.1234573e-37  0              0.0065396664   12014.125      0              5.801191e+10   2.6109412e-16  0              3.3361391    
    200000   192.9          200            200            0.0006878279  -2.4286952e-36  0              0.0020634837   2435.545       0              1.1760375e+10  2.6109412e-16  0              3.0980401    
    300000   192.9          200            200           -9.8072553e-05 -2.8037301e-36  0             -0.00029421766  133.43669      0              6.4431801e+08  2.6109412e-16  0              3.0368181    
    400000   192.9          200            200            0.0092279777  -1.5805553e-36  0              0.027683933    53.698736      0              2.5929198e+08  2.6109412e-16  0              2.9891247    
    500000   192.9          200            200            0.00054212312 -3.7707733e-36  0              0.0016263694   0.93843706     0              4531376.7      2.6109412e-16  0              2.9983857    
    600000   192.9          200            200            0.0020024062  -2.770054e-36   0              0.0060072185   1.6378782      0              7908727.7      2.6109412e-16  0              2.9960815    
    700000   192.9          200            200            0.0025109312   6.1028812e-37  0              0.0075327937   0.36029293     0              1739725.6      2.6109412e-16  0              2.9954539    
    800000   192.9          200            200            0.0026583004   4.3042397e-36  0              0.0079749013   0.059414444    0              286891.09      2.6109412e-16  0              2.9952819    
    900000   192.9          200            200            0.0027018139  -1.4714193e-37  0              0.0081054417   0.0090818863   0              43853.179      2.6109412e-16  0              2.9952322    
   1000000   192.9          200            200            0.0027139564   4.5714559e-37  0              0.0081418692   0.0013228047   0              6387.3505      2.6109412e-16  0              2.9952185    
   1100000   192.9          200            200            0.0027169459   3.624371e-39   0              0.0081508376   0.00018479012  0              892.28537      2.6109412e-16  0              2.9952153    
   1200000   192.9          200            200            0.0027174843   1.3765603e-39  0              0.0081524528   2.4807591e-05  0              119.78698      2.6109412e-16  0              2.9952147    
   1300000   192.9          200            200            0.0027174725   5.106744e-39   0              0.0081524175   3.1999686e-06  0              15.451503      2.6109412e-16  0              2.9952148    
   1400000   192.9          200            200            0.0027173911   1.1731643e-38  0              0.0081521734   3.9583999e-07  0              1.9113696      2.6109412e-16  0              2.9952149    
   1500000   192.9          200            200            0.0027173335   7.8357441e-39  0              0.0081520004   4.6771474e-08  0              0.22584271     2.6109412e-16  0              2.9952149    
   1600000   192.9          200            200            0.0027173025   1.5786602e-38  0              0.0081519074   5.2432297e-09  0              0.02531768     2.6109412e-16  0              2.995215     
   1700000   192.9          200            200            0.0027172877  -2.0038745e-38  0              0.0081518631   5.5152206e-10  0              0.0026631026   2.6109412e-16  0              2.995215     
   1800000   192.9          200            200            0.0027172811  -1.3779634e-38  0              0.0081518433   5.3430537e-11  0              0.00025799694  2.6109412e-16  0              2.995215     
   1900000   192.9          200            200            0.0027172783  -1.7845909e-38  0              0.008151835    4.6096046e-12  0              2.2258131e-05  2.6109412e-16  0              2.995215     
   2000000   192.9          200            200            0.0027172772   9.2767572e-39  0              0.0081518316   3.3050135e-13  0              1.5958727e-06  2.6109412e-16  0              2.995215     
   2100000   192.9          200            200            0.0027172767  -1.3774025e-38  0              0.0081518302   1.6466214e-14  0              7.9509452e-08  2.6109412e-16  0              2.995215     
   2200000   192.9          200            200            0.0027172766   2.0090197e-38  0              0.0081518297   2.4577471e-16  0              1.1867581e-09  2.6109412e-16  0              2.995215     
   2300000   192.9          200            200            0.0027172765  -2.3236175e-38  0              0.0081518295   3.4305239e-17  0              1.6564772e-10  2.6109412e-16  0              2.995215     
   2400000   192.9          200            200            0.0027172765   3.2917471e-39  0              0.0081518294   4.1804421e-17  0              2.0185859e-10  2.6109412e-16  0              2.995215     
   2500000   192.9          200            200            0.0027172765   2.1485343e-38  0              0.0081518294   1.5384964e-17  0              7.4288486e-11  2.6109412e-16  0              2.995215     
   2600000   192.9          200            200            0.0027172765  -1.6486694e-38  0              0.0081518294   4.2860159e-18  0              2.0695637e-11  2.6109412e-16  0              2.995215     
   2700000   192.9          200            200            0.0027172764   1.2965349e-39  0              0.0081518293   8.4931888e-19  0              4.1010569e-12  2.6109412e-16  0              2.995215     
   2800000   192.9          200            200            0.0027172764   8.5692063e-39  0              0.0081518293   2.159705e-19   0              1.0428443e-12  2.6109412e-16  0              2.995215     
   2900000   192.9          200            200            0.0027172764  -2.1555219e-38  0              0.0081518293   3.9504991e-20  0              1.9075546e-13  2.6109412e-16  0              2.995215     
   3000000   192.9          200            200            0.0027172764   7.6139378e-39  0              0.0081518293   2.3764214e-20  0              1.1474888e-13  2.6109412e-16  0              2.995215     
Loop time of 63.9094 on 4 procs for 3000000 steps with 51 atoms

Performance: 40557433.178 ns/day, 0.000 hours/ns, 46941.474 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32121    | 1.5291     | 4.9444     | 159.5 |  2.39
Neigh   | 0.096738   | 0.097657   | 0.099552   |   0.4 |  0.15
Comm    | 25.632     | 32.442     | 38.266     |  86.1 | 50.76
Output  | 0.061697   | 0.06178    | 0.061846   |   0.0 |  0.10
Modify  | 15.091     | 21.017     | 28.423     | 123.1 | 32.89
Other   |            | 8.762      |            |       | 13.71

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 93

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.44                                                               
Lattice spacing in x,y,z = 6.44 6.44 6.44

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96.6 ${n1e1} -100 100 -100 100 units box
region box block -96.6 96.6 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.6 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.6 96.6 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96.6 -100 -100) to (96.6 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-96.6 -100 -100) to (96.6 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96.6 -100 -100) to (96.6 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_93_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 125 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.15 | 18.62 | 19.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   193.2          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   193.2          200            200            0.0021751736   1.3202967e-39  0              0.0065255209   12002.835      0              6.4397103e+10  2.6109412e-16  0              3.3366648    
    200000   193.2          200            200            0.00068165583  3.2952714e-36  0              0.0020449675   2406.5999      0              1.2911788e+10  2.6109412e-16  0              3.0995714    
    300000   193.2          200            200           -9.989205e-05   6.0048423e-38  0             -0.00029967615  139.65406      0              7.4926608e+08  2.6109412e-16  0              3.0365196    
    400000   193.2          200            200            0.0093981145  -5.0332966e-36  0              0.028194343    46.456233      0              2.4924503e+08  2.6109412e-16  0              2.9889839    
    500000   193.2          200            200            0.00053180374 -4.4344329e-37  0              0.0015954112   0.65980554     0              3539960.9      2.6109412e-16  0              2.9984019    
    600000   193.2          200            200            0.0020174731  -2.8791378e-35  0              0.0060524194   1.7691995      0              9492034.5      2.6109412e-16  0              2.9960573    
    700000   193.2          200            200            0.0025162123  -4.4035652e-37  0              0.007548637    0.37773174     0              2026590.4      2.6109412e-16  0              2.9954427    
    800000   193.2          200            200            0.0026579692   1.8552614e-36  0              0.0079739076   0.061407052    0              329458.53      2.6109412e-16  0              2.9952773    
    900000   193.2          200            200            0.0026991105   2.319398e-39   0              0.0080973316   0.0092815933   0              49797.214      2.6109412e-16  0              2.9952304    
   1000000   193.2          200            200            0.0027103124   7.6681827e-38  0              0.0081309373   0.0013383687   0              7180.5595      2.6109412e-16  0              2.9952178    
   1100000   193.2          200            200            0.0027129402   5.6308617e-39  0              0.0081388207   0.00018519065  0              993.57707      2.6109412e-16  0              2.995215     
   1200000   193.2          200            200            0.0027133427  -9.1757321e-39  0              0.0081400281   2.4627647e-05  0              132.13122      2.6109412e-16  0              2.9952146    
   1300000   193.2          200            200            0.0027132809  -5.9202937e-39  0              0.0081398426   3.1459277e-06  0              16.878399      2.6109412e-16  0              2.9952147    
   1400000   193.2          200            200            0.0027131814   9.9756382e-39  0              0.0081395443   3.8509136e-07  0              2.066076       2.6109412e-16  0              2.9952149    
   1500000   193.2          200            200            0.0027131174   9.6616231e-39  0              0.0081393522   4.4967045e-08  0              0.2412553      2.6109412e-16  0              2.9952149    
   1600000   193.2          200            200            0.0027130842   2.0473282e-39  0              0.0081392526   4.970964e-09   0              0.026670007    2.6109412e-16  0              2.995215     
   1700000   193.2          200            200            0.0027130687   2.5703669e-38  0              0.008139206    5.1378399e-10  0              0.0027565323   2.6109412e-16  0              2.995215     
   1800000   193.2          200            200            0.0027130618   1.8032061e-38  0              0.0081391855   4.8604845e-11  0              0.00026077267  2.6109412e-16  0              2.995215     
   1900000   193.2          200            200            0.002713059    1.6774629e-39  0              0.008139177    4.0463707e-12  0              2.1709418e-05  2.6109412e-16  0              2.995215     
   2000000   193.2          200            200            0.0027130578   3.2445416e-38  0              0.0081391735   2.7247088e-13  0              1.4618493e-06  2.6109412e-16  0              2.995215     
   2100000   193.2          200            200            0.0027130574  -2.7951091e-39  0              0.0081391721   1.1672363e-14  0              6.2624072e-08  2.6109412e-16  0              2.995215     
   2200000   193.2          200            200            0.0027130572  -5.0945319e-39  0              0.0081391715   6.5921484e-17  0              3.5367917e-10  2.6109412e-16  0              2.995215     
   2300000   193.2          200            200            0.0027130571  -7.8636433e-39  0              0.0081391713   7.5273705e-17  0              4.0385531e-10  2.6109412e-16  0              2.995215     
   2400000   193.2          200            200            0.0027130571   1.4445439e-40  0              0.0081391713   5.5565775e-17  0              2.9811916e-10  2.6109412e-16  0              2.995215     
   2500000   193.2          200            200            0.0027130571   1.2639743e-38  0              0.0081391712   1.8398907e-17  0              9.8713043e-11  2.6109412e-16  0              2.995215     
   2600000   193.2          200            200            0.0027130571   3.2907916e-38  0              0.0081391712   4.7667697e-18  0              2.5574472e-11  2.6109412e-16  0              2.995215     
   2700000   193.2          200            200            0.0027130571   2.3492155e-38  0              0.0081391712   1.0400183e-18  0              5.5798621e-12  2.6109412e-16  0              2.995215     
   2800000   193.2          200            200            0.0027130571   2.7722803e-38  0              0.0081391712   2.4234323e-19  0              1.3002097e-12  2.6109412e-16  0              2.995215     
   2900000   193.2          200            200            0.0027130571   2.7298421e-38  0              0.0081391712   1.0575163e-20  0              5.6737419e-14  2.6109412e-16  0              2.995215     
   3000000   193.2          200            200            0.0027130571  -3.1732927e-39  0              0.0081391712   9.0467048e-20  0              4.8537e-13     2.6109412e-16  0              2.995215     
Loop time of 62.7406 on 4 procs for 3000000 steps with 50 atoms

Performance: 41312980.749 ns/day, 0.000 hours/ns, 47815.950 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30801    | 1.4954     | 4.8227     | 157.2 |  2.38
Neigh   | 0.096754   | 0.097659   | 0.099527   |   0.4 |  0.16
Comm    | 25.051     | 31.529     | 37.162     |  83.6 | 50.25
Output  | 0.060768   | 0.06085    | 0.060912   |   0.0 |  0.10
Modify  | 14.999     | 20.806     | 27.886     | 119.2 | 33.16
Other   |            | 8.752      |            |       | 13.95

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.46
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 94

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.45                                                               
Lattice spacing in x,y,z = 6.45 6.45 6.45

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96.75 ${n1e1} -100 100 -100 100 units box
region box block -96.75 96.75 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.75 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.75 96.75 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96.75 -100 -100) to (96.75 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-96.75 -100 -100) to (96.75 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96.75 -100 -100) to (96.75 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_94_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 125 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.15 | 18.62 | 19.78 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   193.5          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   193.5          200            200            0.0021704431  -2.0225264e-37  0              0.0065113292   11991.226      0              5.7901341e+10  2.6109412e-16  0              3.3372283    
    200000   193.5          200            200            0.00067577898 -3.7788801e-37  0              0.0020273369   2379.3163      0              1.1488867e+10  2.6109412e-16  0              3.1010264    
    300000   193.5          200            200           -0.00010157927 -1.5702857e-36  0             -0.0003047378   145.63805      0              7.0323403e+08  2.6109412e-16  0              3.0362343    
    400000   193.5          200            200            0.0095496709  -8.5048736e-36  0              0.028649013    39.808736      0              1.9222214e+08  2.6109412e-16  0              2.9888579    
    500000   193.5          200            200            0.00052315001 -6.9532403e-36  0              0.00156945     0.43482471     0              2099612.9      2.6109412e-16  0              2.998415     
    600000   193.5          200            200            0.0020327609  -1.5653806e-35  0              0.0060982826   1.8985001      0              9167177.4      2.6109412e-16  0              2.9960329    
    700000   193.5          200            200            0.0025214601   3.417884e-37   0              0.0075643803   0.39432108     0              1904035.4      2.6109412e-16  0              2.9954315    
    800000   193.5          200            200            0.0026576029   1.8518273e-36  0              0.0079728087   0.063248658    0              305405.13      2.6109412e-16  0              2.9952728    
    900000   193.5          200            200            0.0026963929  -8.1977868e-38  0              0.0080891786   0.0094583686   0              45671.077      2.6109412e-16  0              2.9952286    
   1000000   193.5          200            200            0.0027066682   1.7960556e-37  0              0.0081200047   0.001350758    0              6522.327       2.6109412e-16  0              2.9952172    
   1100000   193.5          200            200            0.0027089417  -1.1105567e-38  0              0.0081268252   0.00018518637  0              894.19869      2.6109412e-16  0              2.9952148    
   1200000   193.5          200            200            0.0027092117  -2.1377172e-39  0              0.0081276351   2.4400602e-05  0              117.82177      2.6109412e-16  0              2.9952145    
   1300000   193.5          200            200            0.0027091013   6.1126217e-39  0              0.0081273039   3.0870527e-06  0              14.906273      2.6109412e-16  0              2.9952147    
   1400000   193.5          200            200            0.0027089844  -7.8867685e-39  0              0.0081269533   3.7394811e-07  0              1.8056616      2.6109412e-16  0              2.9952148    
   1500000   193.5          200            200            0.0027089142  -3.1806335e-39  0              0.0081267427   4.3148556e-08  0              0.20834893     2.6109412e-16  0              2.9952149    
   1600000   193.5          200            200            0.0027088789  -2.6453269e-38  0              0.0081266368   4.7022623e-09  0              0.022705542    2.6109412e-16  0              2.995215     
   1700000   193.5          200            200            0.0027088627   1.493953e-38   0              0.0081265881   4.7722686e-10  0              0.0023043577   2.6109412e-16  0              2.995215     
   1800000   193.5          200            200            0.0027088557   5.9565442e-39  0              0.008126567    4.402145e-11   0              0.00021256383  2.6109412e-16  0              2.995215     
   1900000   193.5          200            200            0.0027088527  -3.7148822e-39  0              0.0081265582   3.5242693e-12  0              1.7017435e-05  2.6109412e-16  0              2.995215     
   2000000   193.5          200            200            0.0027088515  -6.1294478e-39  0              0.0081265546   2.2066313e-13  0              1.0655033e-06  2.6109412e-16  0              2.995215     
   2100000   193.5          200            200            0.0027088511   1.4752573e-38  0              0.0081265532   7.7902547e-15  0              3.7616352e-08  2.6109412e-16  0              2.995215     
   2200000   193.5          200            200            0.0027088509   1.2811246e-38  0              0.0081265527   5.4587785e-19  0              2.6358488e-12  2.6109412e-16  0              2.995215     
   2300000   193.5          200            200            0.0027088508   1.9982146e-38  0              0.0081265525   1.3019904e-16  0              6.2868456e-10  2.6109412e-16  0              2.995215     
   2400000   193.5          200            200            0.0027088508   3.1571605e-38  0              0.0081265524   7.1307377e-17  0              3.443178e-10   2.6109412e-16  0              2.995215     
   2500000   193.5          200            200            0.0027088508   1.9006469e-38  0              0.0081265524   2.1408906e-17  0              1.0337594e-10  2.6109412e-16  0              2.995215     
   2600000   193.5          200            200            0.0027088508  -1.6904437e-39  0              0.0081265524   5.3045073e-18  0              2.5613567e-11  2.6109412e-16  0              2.995215     
   2700000   193.5          200            200            0.0027088508   3.718953e-38   0              0.0081265524   9.632836e-19   0              4.6513518e-12  2.6109412e-16  0              2.995215     
   2800000   193.5          200            200            0.0027088508   2.2847105e-38  0              0.0081265524   2.2852941e-19  0              1.1034867e-12  2.6109412e-16  0              2.995215     
   2900000   193.5          200            200            0.0027088508   7.081976e-39   0              0.0081265524   2.8006991e-20  0              1.3523574e-13  2.6109412e-16  0              2.995215     
   3000000   193.5          200            200            0.0027088508   2.8244183e-38  0              0.0081265524   4.5651588e-20  0              2.2043518e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1875 on 4 procs for 3000000 steps with 51 atoms

Performance: 40381719.408 ns/day, 0.000 hours/ns, 46738.101 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30439    | 1.5366     | 5.0033     | 161.5 |  2.39
Neigh   | 0.096764   | 0.097333   | 0.09882    |   0.3 |  0.15
Comm    | 25.85      | 32.541     | 38.283     |  84.7 | 50.70
Output  | 0.062339   | 0.062422   | 0.062491   |   0.0 |  0.10
Modify  | 15.212     | 21.119     | 28.434     | 121.9 | 32.90
Other   |            | 8.832      |            |       | 13.76

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 95

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.46                                                               
Lattice spacing in x,y,z = 6.46 6.46 6.46

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -96.9 ${n1e1} -100 100 -100 100 units box
region box block -96.9 96.9 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.9 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -96.9 96.9 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-96.9 -100 -100) to (96.9 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-96.9 -100 -100) to (96.9 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-96.9 -100 -100) to (96.9 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_95_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 126 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.17 | 18.64 | 19.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   193.8          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   193.8          200            200            0.0021656985  -6.0869398e-37  0              0.0064970954   11979.309      0              5.7843795e+10  2.6109412e-16  0              3.3378301    
    200000   193.8          200            200            0.00067038278 -2.8191269e-36  0              0.0020111483   2354.7366      0              1.137018e+10   2.6109412e-16  0              3.1023433    
    300000   193.8          200            200           -0.00010313118 -6.0450621e-36  0             -0.00030939354  151.3459       0              7.3079517e+08  2.6109412e-16  0              3.0359638    
    400000   193.8          200            200            0.009682236    1.0526322e-36  0              0.029046708    33.816661      0              1.6328855e+08  2.6109412e-16  0              2.988747     
    500000   193.8          200            200            0.00051609758  1.271712e-35   0              0.0015482927   0.26203641     0              1265280        2.6109412e-16  0              2.9984249    
    600000   193.8          200            200            0.0020479896   7.1789833e-36  0              0.0061439687   2.0237697      0              9772059.5      2.6109412e-16  0              2.9960086    
    700000   193.8          200            200            0.002526547    7.1240474e-37  0              0.0075796411   0.40985214     0              1979029.3      2.6109412e-16  0              2.9954205    
    800000   193.8          200            200            0.0026571516   1.0299023e-36  0              0.0079714547   0.064921103    0              313480.77      2.6109412e-16  0              2.9952685    
    900000   193.8          200            200            0.0026936421   7.0058983e-38  0              0.0080809263   0.009611227    0              46409.176      2.6109412e-16  0              2.9952269    
   1000000   193.8          200            200            0.002703017    2.0483363e-37  0              0.008109051    0.0013600446   0              6567.1684      2.6109412e-16  0              2.9952165    
   1100000   193.8          200            200            0.0027049479   1.438429e-38   0              0.0081148436   0.00018481374  0              892.3994       2.6109412e-16  0              2.9952145    
   1200000   193.8          200            200            0.0027050903   1.6165801e-39  0              0.008115271    2.4134595e-05  0              116.53732      2.6109412e-16  0              2.9952144    
   1300000   193.8          200            200            0.0027049334   5.2493489e-39  0              0.0081148003   3.0247903e-06  0              14.60563       2.6109412e-16  0              2.9952147    
   1400000   193.8          200            200            0.0027047999  -5.238287e-39   0              0.0081143998   3.6263759e-07  0              1.7510471      2.6109412e-16  0              2.9952148    
   1500000   193.8          200            200            0.0027047239   4.1629474e-40  0              0.0081141718   4.1348561e-08  0              0.1996574      2.6109412e-16  0              2.9952149    
   1600000   193.8          200            200            0.0027046866  -3.5667986e-39  0              0.0081140599   4.4414333e-09  0              0.021446092    2.6109412e-16  0              2.995215     
   1700000   193.8          200            200            0.0027046697   3.9518655e-38  0              0.0081140092   4.4238128e-10  0              0.0021361009   2.6109412e-16  0              2.995215     
   1800000   193.8          200            200            0.0027046625  -1.6975865e-38  0              0.0081139874   3.973847e-11   0              0.00019188285  2.6109412e-16  0              2.995215     
   1900000   193.8          200            200            0.0027046595   3.7653612e-39  0              0.0081139784   3.0489038e-12  0              1.4722065e-05  2.6109412e-16  0              2.995215     
   2000000   193.8          200            200            0.0027046583   4.7344383e-39  0              0.0081139748   1.755053e-13   0              8.4745228e-07  2.6109412e-16  0              2.995215     
   2100000   193.8          200            200            0.0027046578   2.8978755e-38  0              0.0081139734   4.7508641e-15  0              2.2940222e-08  2.6109412e-16  0              2.995215     
   2200000   193.8          200            200            0.0027046576  -2.5200533e-38  0              0.0081139729   4.1204055e-17  0              1.9895964e-10  2.6109412e-16  0              2.995215     
   2300000   193.8          200            200            0.0027046576  -2.0973604e-38  0              0.0081139727   1.9632302e-16  0              9.4797361e-10  2.6109412e-16  0              2.995215     
   2400000   193.8          200            200            0.0027046575   3.856438e-38   0              0.0081139726   8.7553033e-17  0              4.2276226e-10  2.6109412e-16  0              2.995215     
   2500000   193.8          200            200            0.0027046575   1.3583422e-38  0              0.0081139726   2.4596086e-17  0              1.187657e-10   2.6109412e-16  0              2.995215     
   2600000   193.8          200            200            0.0027046575  -2.2675764e-38  0              0.0081139726   5.8601318e-18  0              2.8296479e-11  2.6109412e-16  0              2.995215     
   2700000   193.8          200            200            0.0027046575  -1.532805e-38   0              0.0081139726   1.1155927e-18  0              5.386798e-12   2.6109412e-16  0              2.995215     
   2800000   193.8          200            200            0.0027046575   1.8405657e-38  0              0.0081139726   2.4891605e-19  0              1.2019265e-12  2.6109412e-16  0              2.995215     
   2900000   193.8          200            200            0.0027046575  -1.921663e-38   0              0.0081139726   9.4714468e-21  0              4.5734227e-14  2.6109412e-16  0              2.995215     
   3000000   193.8          200            200            0.0027046575   2.3197082e-39  0              0.0081139726   7.157154e-20   0              3.4559335e-13  2.6109412e-16  0              2.995215     
Loop time of 63.8641 on 4 procs for 3000000 steps with 51 atoms

Performance: 40586159.663 ns/day, 0.000 hours/ns, 46974.722 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.32321    | 1.5055     | 4.8777     | 158.7 |  2.36
Neigh   | 0.097381   | 0.098002   | 0.099592   |   0.3 |  0.15
Comm    | 25.735     | 32.439     | 38.203     |  85.2 | 50.79
Output  | 0.060565   | 0.060646   | 0.060707   |   0.0 |  0.09
Modify  | 15.131     | 21.031     | 28.375     | 122.7 | 32.93
Other   |            | 8.73       |            |       | 13.67

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 164
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 96

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.47                                                               
Lattice spacing in x,y,z = 6.47 6.47 6.47

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -97.05 ${n1e1} -100 100 -100 100 units box
region box block -97.05 97.05 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.05 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.05 97.05 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-97.05 -100 -100) to (97.05 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-97.05 -100 -100) to (97.05 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-97.05 -100 -100) to (97.05 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_96_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 126 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.17 | 18.64 | 19.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   194.1          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   194.1          200            200            0.0021609415   1.0383815e-37  0              0.0064828245   11967.094      0              5.7784816e+10  2.6109412e-16  0              3.3384703    
    200000   194.1          200            200            0.00066566373 -3.7425896e-37  0              0.0019969912   2333.9601      0              1.1269858e+10  2.6109412e-16  0              3.1034562    
    300000   194.1          200            200           -0.00010442106 -1.970832e-36   0             -0.00031326319  156.30665      0              7.5474889e+08  2.6109412e-16  0              3.0357292    
    400000   194.1          200            200            0.0097844597   3.9760512e-38  0              0.029353379    28.986591      0              1.3996587e+08  2.6109412e-16  0              2.9886592    
    500000   194.1          200            200            0.00051095623 -3.5255893e-36  0              0.0015328687   0.14829962     0              716085.77      2.6109412e-16  0              2.9984314    
    600000   194.1          200            200            0.0020610836   2.3490117e-35  0              0.0061832507   2.1314675      0              10292094       2.6109412e-16  0              2.9959871    
    700000   194.1          200            200            0.0025304893   9.8664818e-37  0              0.0075914679   0.42277863     0              2041446.7      2.6109412e-16  0              2.9954109    
    800000   194.1          200            200            0.0026562209   1.8437099e-36  0              0.0079686627   0.066271192    0              319999.87      2.6109412e-16  0              2.9952647    
    900000   194.1          200            200            0.002690707    3.9156849e-38  0              0.0080721209   0.0097282096   0              46974.043      2.6109412e-16  0              2.9952255    
   1000000   194.1          200            200            0.002699302   -4.7560345e-38  0              0.008097906    0.0013658998   0              6595.4412      2.6109412e-16  0              2.995216     
   1100000   194.1          200            200            0.0027009378   2.5340655e-38  0              0.0081028135   0.00018420475  0              889.4588       2.6109412e-16  0              2.9952143    
   1200000   194.1          200            200            0.0027009711   2.8973073e-39  0              0.0081029133   2.3869843e-05  0              115.25893      2.6109412e-16  0              2.9952144    
   1300000   194.1          200            200            0.0027007746  -2.3463008e-39  0              0.0081023237   2.9671704e-06  0              14.327404      2.6109412e-16  0              2.9952146    
   1400000   194.1          200            200            0.002700627    4.6698884e-39  0              0.008101881    3.5251007e-07  0              1.702145       2.6109412e-16  0              2.9952148    
   1500000   194.1          200            200            0.0027005461   2.6725504e-39  0              0.0081016383   3.9771034e-08  0              0.19204009     2.6109412e-16  0              2.9952149    
   1600000   194.1          200            200            0.0027005071   3.7664002e-39  0              0.0081015214   4.2167881e-09  0              0.020361361    2.6109412e-16  0              2.995215     
   1700000   194.1          200            200            0.0027004897   5.345079e-38   0              0.008101469    4.1287059e-10  0              0.0019936043   2.6109412e-16  0              2.995215     
   1800000   194.1          200            200            0.0027004822   5.3139599e-39  0              0.0081014467   3.6179864e-11  0              0.00017469961  2.6109412e-16  0              2.995215     
   1900000   194.1          200            200            0.0027004792   1.844128e-38   0              0.0081014376   2.6642579e-12  0              1.2864748e-05  2.6109412e-16  0              2.995215     
   2000000   194.1          200            200            0.002700478    8.6766445e-39  0              0.0081014339   1.4067933e-13  0              6.7929015e-07  2.6109412e-16  0              2.995215     
   2100000   194.1          200            200            0.0027004775   2.2179408e-38  0              0.0081014325   2.746363e-15   0              1.3261204e-08  2.6109412e-16  0              2.995215     
   2200000   194.1          200            200            0.0027004773   2.7428155e-40  0              0.008101432    1.57196e-16    0              7.5904324e-10  2.6109412e-16  0              2.995215     
   2300000   194.1          200            200            0.0027004773  -1.7260123e-38  0              0.0081014318   2.6341787e-16  0              1.2719506e-09  2.6109412e-16  0              2.995215     
   2400000   194.1          200            200            0.0027004772   1.0940315e-38  0              0.0081014317   1.0313679e-16  0              4.9801064e-10  2.6109412e-16  0              2.995215     
   2500000   194.1          200            200            0.0027004772  -7.5803631e-40  0              0.0081014317   2.7456605e-17  0              1.3257812e-10  2.6109412e-16  0              2.995215     
   2600000   194.1          200            200            0.0027004772  -1.3435295e-38  0              0.0081014316   6.2530017e-18  0              3.0193507e-11  2.6109412e-16  0              2.995215     
   2700000   194.1          200            200            0.0027004772   1.9212518e-38  0              0.0081014316   1.2424761e-18  0              5.9994726e-12  2.6109412e-16  0              2.995215     
   2800000   194.1          200            200            0.0027004772   1.5465006e-38  0              0.0081014316   2.6637412e-19  0              1.2862253e-12  2.6109412e-16  0              2.995215     
   2900000   194.1          200            200            0.0027004772   1.3550009e-38  0              0.0081014316   1.5476934e-20  0              7.4732573e-14  2.6109412e-16  0              2.995215     
   3000000   194.1          200            200            0.0027004772   1.3602731e-38  0              0.0081014316   6.9428553e-20  0              3.3524563e-13  2.6109412e-16  0              2.995215     
Loop time of 64.1784 on 4 procs for 3000000 steps with 51 atoms

Performance: 40387402.312 ns/day, 0.000 hours/ns, 46744.679 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.31382    | 1.5197     | 4.9189     | 159.3 |  2.37
Neigh   | 0.098633   | 0.099315   | 0.10098    |   0.3 |  0.15
Comm    | 25.731     | 32.588     | 38.414     |  86.4 | 50.78
Output  | 0.062388   | 0.062467   | 0.062525   |   0.0 |  0.10
Modify  | 15.146     | 21.116     | 28.616     | 123.7 | 32.90
Other   |            | 8.793      |            |       | 13.70

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 97

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.48                                                               
Lattice spacing in x,y,z = 6.48 6.48 6.48

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -97.2 ${n1e1} -100 100 -100 100 units box
region box block -97.2 97.2 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.2 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.2 97.2 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-97.2 -100 -100) to (97.2 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-97.2 -100 -100) to (97.2 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-97.2 -100 -100) to (97.2 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_97_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 126 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.17 | 18.64 | 19.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   194.4          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   194.4          200            200            0.0021561742  -6.0602283e-37  0              0.0064685227   11954.599      0              5.7724481e+10  2.6109412e-16  0              3.3391485    
    200000   194.4          200            200            0.00066127772  3.3582321e-38  0              0.0019838332   2315.0317      0              1.117846e+10   2.6109412e-16  0              3.1044746    
    300000   194.4          200            200           -0.00010561472  1.2791949e-36  0             -0.00031684417  161.04693      0              7.7763798e+08  2.6109412e-16  0              3.0355061    
    400000   194.4          200            200            0.0098735188  -2.5886712e-36  0              0.029620556    24.649753      0              1.1902484e+08  2.6109412e-16  0              2.9885816    
    500000   194.4          200            200            0.00050685019  1.2756166e-35  0              0.0015205506   0.069037413    0              333356.96      2.6109412e-16  0              2.9984359    
    600000   194.4          200            200            0.0020739951  -1.8672153e-35  0              0.0062219852   2.2352246      0              10793100       2.6109412e-16  0              2.995966     
    700000   194.4          200            200            0.0025342595  -5.8605867e-38  0              0.0076027786   0.43486081     0              2099787.2      2.6109412e-16  0              2.9954015    
    800000   194.4          200            200            0.0026552106   2.6563391e-36  0              0.0079656318   0.067495574    0              325911.97      2.6109412e-16  0              2.9952609    
    900000   194.4          200            200            0.0026877438  -1.1831962e-37  0              0.0080632313   0.0098283859   0              47457.758      2.6109412e-16  0              2.9952241    
   1000000   194.4          200            200            0.0026955827   5.6351293e-38  0              0.0080867482   0.0013696969   0              6613.7762      2.6109412e-16  0              2.9952155    
   1100000   194.4          200            200            0.0026969338   2.0785079e-38  0              0.0080908013   0.00018336853  0              885.42101      2.6109412e-16  0              2.9952141    
   1200000   194.4          200            200            0.002696862    1.855539e-39   0              0.0080905861   2.3583684e-05  0              113.87717      2.6109412e-16  0              2.9952143    
   1300000   194.4          200            200            0.0026966276   2.2587371e-39  0              0.0080898827   2.908144e-06   0              14.042386      2.6109412e-16  0              2.9952146    
   1400000   194.4          200            200            0.0026964666  -2.3577622e-39  0              0.0080893997   3.4240849e-07  0              1.6533681      2.6109412e-16  0              2.9952148    
   1500000   194.4          200            200            0.002696381    5.4945658e-39  0              0.008089143    3.8226014e-08  0              0.18457974     2.6109412e-16  0              2.9952149    
   1600000   194.4          200            200            0.0026963405  -1.0498665e-38  0              0.0080890214   4.0001343e-09  0              0.019315217    2.6109412e-16  0              2.995215     
   1700000   194.4          200            200            0.0026963225  -6.4986993e-39  0              0.0080889675   3.8483589e-10  0              0.0018582348   2.6109412e-16  0              2.995215     
   1800000   194.4          200            200            0.0026963149   1.873564e-38   0              0.0080889447   3.2859212e-11  0              0.00015866538  2.6109412e-16  0              2.995215     
   1900000   194.4          200            200            0.0026963118  -1.8473229e-38  0              0.0080889354   2.3143302e-12  0              1.1175072e-05  2.6109412e-16  0              2.995215     
   2000000   194.4          200            200            0.0026963106   1.6597433e-38  0              0.0080889317   1.1056396e-13  0              5.3387379e-07  2.6109412e-16  0              2.995215     
   2100000   194.4          200            200            0.0026963101   9.9416159e-39  0              0.0080889303   1.3256486e-15  0              6.4010825e-09  2.6109412e-16  0              2.995215     
   2200000   194.4          200            200            0.0026963099   1.7105816e-38  0              0.0080889297   3.3937973e-16  0              1.6387433e-09  2.6109412e-16  0              2.995215     
   2300000   194.4          200            200            0.0026963098   3.3091134e-39  0              0.0080889295   3.3774472e-16  0              1.6308484e-09  2.6109412e-16  0              2.995215     
   2400000   194.4          200            200            0.0026963098   3.4370954e-40  0              0.0080889295   1.1847815e-16  0              5.7208856e-10  2.6109412e-16  0              2.995215     
   2500000   194.4          200            200            0.0026963098  -3.290532e-38   0              0.0080889294   3.0009258e-17  0              1.4490397e-10  2.6109412e-16  0              2.995215     
   2600000   194.4          200            200            0.0026963098  -1.6361685e-38  0              0.0080889294   6.6925651e-18  0              3.2316002e-11  2.6109412e-16  0              2.995215     
   2700000   194.4          200            200            0.0026963098   3.2805433e-38  0              0.0080889294   1.2322494e-18  0              5.9500913e-12  2.6109412e-16  0              2.995215     
   2800000   194.4          200            200            0.0026963098  -1.8674129e-39  0              0.0080889294   2.5610773e-19  0              1.2366526e-12  2.6109412e-16  0              2.995215     
   2900000   194.4          200            200            0.0026963098  -6.1213384e-39  0              0.0080889294   1.0455481e-20  0              5.0485775e-14  2.6109412e-16  0              2.995215     
   3000000   194.4          200            200            0.0026963098   2.018285e-38   0              0.0080889294   9.0514854e-20  0              4.3706384e-13  2.6109412e-16  0              2.995215     
Loop time of 64.226 on 4 procs for 3000000 steps with 51 atoms

Performance: 40357476.905 ns/day, 0.000 hours/ns, 46710.043 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30602    | 1.5306     | 4.9891     | 161.5 |  2.38
Neigh   | 0.098595   | 0.099201   | 0.10081    |   0.3 |  0.15
Comm    | 25.804     | 32.644     | 38.456     |  86.1 | 50.83
Output  | 0.061317   | 0.061398   | 0.06146    |   0.0 |  0.10
Modify  | 15.221     | 21.162     | 28.615     | 123.6 | 32.95
Other   |            | 8.729      |            |       | 13.59

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 98

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.49                                                               
Lattice spacing in x,y,z = 6.49 6.49 6.49

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -97.35 ${n1e1} -100 100 -100 100 units box
region box block -97.35 97.35 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.35 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.35 97.35 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-97.35 -100 -100) to (97.35 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 29 atoms
  using lattice units in orthogonal box = (-97.35 -100 -100) to (97.35 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-97.35 -100 -100) to (97.35 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  29 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  29 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
29 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_98_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 126 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.17 | 18.64 | 19.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   194.7          200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   194.7          200            200            0.0021513993   2.0586884e-37  0              0.0064541979   11941.845      0              6.4069883e+10  2.6109412e-16  0              3.3398641    
    200000   194.7          200            200            0.00065710265 -3.7099045e-37  0              0.001971308    2297.2585      0              1.2325154e+10  2.6109412e-16  0              3.1054371    
    300000   194.7          200            200           -0.00010676827  8.7242341e-37  0             -0.0003203048   165.74964      0              8.89273e+08    2.6109412e-16  0              3.0352861    
    400000   194.7          200            200            0.0099543523   4.4465884e-37  0              0.029863057    20.617832      0              1.1061792e+08  2.6109412e-16  0              2.9885105    
    500000   194.7          200            200            0.00050358174 -1.9976057e-37  0              0.0015107452   0.019445121    0              104326.15      2.6109412e-16  0              2.9984387    
    600000   194.7          200            200            0.0020874157   1.7065078e-35  0              0.0062622471   2.3394264      0              12551392       2.6109412e-16  0              2.9959441    
    700000   194.7          200            200            0.0025381909   2.3826182e-37  0              0.0076145727   0.44662481     0              2396212.6      2.6109412e-16  0              2.995392     
    800000   194.7          200            200            0.0026542555   1.0322251e-36  0              0.0079627664   0.068649344    0              368314.57      2.6109412e-16  0              2.9952572    
    900000   194.7          200            200            0.0026848046   1.7980499e-37  0              0.0080544138   0.0099165589   0              53203.905      2.6109412e-16  0              2.9952226    
   1000000   194.7          200            200            0.0026918788   3.2595667e-38  0              0.0080756364   0.0013716826   0              7359.2936      2.6109412e-16  0              2.9952149    
   1100000   194.7          200            200            0.0026929429  -4.7594757e-38  0              0.0080788286   0.00018228171  0              977.97015      2.6109412e-16  0              2.9952139    
   1200000   194.7          200            200            0.0026927657   3.2240983e-39  0              0.0080782971   2.3265562e-05  0              124.82341      2.6109412e-16  0              2.9952142    
   1300000   194.7          200            200            0.0026924933   2.2003729e-39  0              0.0080774798   2.8453964e-06  0              15.266001      2.6109412e-16  0              2.9952146    
   1400000   194.7          200            200            0.0026923189  -1.2940395e-39  0              0.0080769566   3.3192502e-07  0              1.7808302      2.6109412e-16  0              2.9952148    
   1500000   194.7          200            200            0.0026922287  -9.7870021e-39  0              0.0080766861   3.6649841e-08  0              0.19663218     2.6109412e-16  0              2.9952149    
   1600000   194.7          200            200            0.0026921866   1.4111695e-38  0              0.0080765599   3.7823473e-09  0              0.020292891    2.6109412e-16  0              2.995215     
   1700000   194.7          200            200            0.0026921682   4.1662988e-39  0              0.0080765045   3.570846e-10   0              0.0019158153   2.6109412e-16  0              2.995215     
   1800000   194.7          200            200            0.0026921604   1.195449e-39   0              0.0080764812   2.9633715e-11  0              0.00015898956  2.6109412e-16  0              2.995215     
   1900000   194.7          200            200            0.0026921573  -1.8201962e-38  0              0.0080764718   1.9838339e-12  0              1.0643582e-05  2.6109412e-16  0              2.995215     
   2000000   194.7          200            200            0.002692156    1.0852544e-38  0              0.0080764681   8.3756931e-14  0              4.4936916e-07  2.6109412e-16  0              2.995215     
   2100000   194.7          200            200            0.0026921555  -1.5972086e-38  0              0.0080764666   4.0897897e-16  0              2.1942367e-09  2.6109412e-16  0              2.995215     
   2200000   194.7          200            200            0.0026921554  -5.2287627e-39  0              0.0080764661   5.9358712e-16  0              3.1846886e-09  2.6109412e-16  0              2.995215     
   2300000   194.7          200            200            0.0026921553   2.5767141e-38  0              0.0080764659   4.2005698e-16  0              2.253672e-09   2.6109412e-16  0              2.995215     
   2400000   194.7          200            200            0.0026921553   1.0634616e-38  0              0.0080764658   1.357683e-16   0              7.2841839e-10  2.6109412e-16  0              2.995215     
   2500000   194.7          200            200            0.0026921553  -3.0819229e-38  0              0.0080764658   3.315732e-17   0              1.7789426e-10  2.6109412e-16  0              2.995215     
   2600000   194.7          200            200            0.0026921553   4.2526218e-38  0              0.0080764658   7.1943338e-18  0              3.8598737e-11  2.6109412e-16  0              2.995215     
   2700000   194.7          200            200            0.0026921552  -5.9024585e-39  0              0.0080764657   1.2865937e-18  0              6.9027782e-12  2.6109412e-16  0              2.995215     
   2800000   194.7          200            200            0.0026921552  -3.037457e-38   0              0.0080764657   2.6237443e-19  0              1.4076803e-12  2.6109412e-16  0              2.995215     
   2900000   194.7          200            200            0.0026921552   1.3557873e-38  0              0.0080764657   1.4488912e-22  0              7.77353e-16    2.6109412e-16  0              2.995215     
   3000000   194.7          200            200            0.0026921552   4.0572399e-38  0              0.0080764657   1.5231314e-19  0              8.1718405e-13  2.6109412e-16  0              2.995215     
Loop time of 62.9225 on 4 procs for 3000000 steps with 50 atoms

Performance: 41193508.898 ns/day, 0.000 hours/ns, 47677.672 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.3135     | 1.5025     | 4.8678     | 158.6 |  2.39
Neigh   | 0.098554   | 0.099205   | 0.10081    |   0.3 |  0.16
Comm    | 25.131     | 31.649     | 37.312     |  83.9 | 50.30
Output  | 0.063275   | 0.063355   | 0.063417   |   0.0 |  0.10
Modify  | 15.021     | 20.863     | 28.008     | 120.1 | 33.16
Other   |            | 8.745      |            |       | 13.90

Nlocal:           12.5 ave          50 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:           37.5 ave          50 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.46
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop

include granular.in
### Simulation of contact between two chain

##################### Simulation setup ####################

units micro                              # units
dimension	3                            # dimension
boundary	p p p                        # boundary condition p: periodic
atom_style	sphere                       # atom style
#processors * * 1

####################### Parameter ##################################

variable ind equal ${num}
variable ind equal 99

#variable lat0 equal 1                    #
variable lat1 equal 3+(251*0.01)+(v_ind*0.01)  # .491+(v_ind*0.001)       # Lattice distance of bottom chain
variable lat2 equal 3                    # Lattice distance of top chain
variable d1 equal 3                      # Diamter of particle at bottom chain
variable d2 equal 3                      # Diamter of particle at top chain
#variable d3 equal 1                      # Diamter of supporting particle

variable n2e1 equal 10*v_lat2             # Half length of top chain. 1500 is number of particles
variable n1e1 equal 1.5*v_n2e1*(v_lat1/v_lat2)             # Half length of bottom chain, which is 1.5 time larger than top chain
variable n1e2 equal -v_n1e1
variable n2e2 equal -v_n2e1
#variable lenspr equal -(v_n2e1+100)           # length of the spring connecting top chain and supporting particle
#variable lenspr1 equal -v_lenspr-0.1         # Position of supporting particle upper bound
#variable lenspr2 equal -v_lenspr+0.1         # Position of supporting particle lower bound

variable den equal 2.2 #grams/cm^3      # micrometer^3=10^-12 cm^3 Density of materials

variable V1 equal (1/6)*PI*(v_d1^3)     # Volume of particle 1
variable V2 equal (1/6)*PI*(v_d2^3)     # Volume of particle 2
#variable V3 equal (1/6)*PI*(v_d3^3)     # Volume of particle 3

variable mass1 equal v_den*v_V1  # Mass of particle 1 (picograms)
variable mass2 equal v_den*v_V2  # Mass of particle 2
#variable mass3 equal v_den*v_V3  # Mass of particle 3

# E GPa to picogram/(micrometer-microsecond^2)= 10^3 Pa= 10^-6 GPa
# Force unit(picogram-micrometer/microsecond^2)=10^-9 N= 1nN
# Spring stiffness (force/distance) 10^-3 N/m

variable K0 equal (1500/50)*(10^5)             # Spring stiffness conneting top chain and sup particle
variable E equal 100*(10^6)                    # Young's Modulus using for Hertz/material model
variable PR equal 0.3                          # Poisson's ratio using for Hertz/material model
variable Fn equal -1000                        # Force apply to each particles in top chain
variable dt equal 0.00001                      # Time step units microsecond
variable lgv equal 0.5                         #damping for langevin thermostat for slider


################### Creating the model #################################
lattice sc ${lat1}                                                               # Bottom chain type1
lattice sc 6.5                                                               
Lattice spacing in x,y,z = 6.5 6.5 6.5

region box block ${n1e2} ${n1e1} -100 100 -100 100 units box
region box block -97.5 ${n1e1} -100 100 -100 100 units box
region box block -97.5 97.5 -100 100 -100 100 units box
region substrate block ${n1e2} ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.5 ${n1e1} -0.5 0.5 0 0.5 units box
region substrate block -97.5 97.5 -0.5 0.5 0 0.5 units box

create_box 2 box
Created orthogonal box = (-97.5 -100 -100) to (97.5 100 100)
  1 by 2 by 2 MPI processor grid
create_atoms 1 region substrate
Created 30 atoms
  using lattice units in orthogonal box = (-97.5 -100 -100) to (97.5 100 100)
  create_atoms CPU = 0.000 seconds

lattice sc ${lat2}                                                             # Top chain type2
lattice sc 3                                                             
Lattice spacing in x,y,z = 3 3 3

region slider1 block ${n2e2} ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 ${n2e1} -0.1 0.1 5.9 6.1 units box
region slider1 block -30 30 -0.1 0.1 5.9 6.1 units box

create_atoms 2 region slider1
Created 21 atoms
  using lattice units in orthogonal box = (-97.5 -100 -100) to (97.5 100 100)
  create_atoms CPU = 0.001 seconds

#lattice sc ${lat0}                                                             # Supporting particle type3

#region support block ${lenspr1} ${lenspr2} -0.1 0.1 7.9 8.1 units box

#create_atoms 3 region support

set type 1 diameter ${d1}                    # Set mass and diameter for each particles type
set type 1 diameter 3                    
Setting atom values ...
  30 settings made for diameter
set type 1 mass ${mass1}
set type 1 mass 31.101767270539
Setting atom values ...
  30 settings made for mass
set type 2 diameter ${d2}
set type 2 diameter 3
Setting atom values ...
  21 settings made for diameter
set type 2 mass ${mass2}
set type 2 mass 31.101767270539
Setting atom values ...
  21 settings made for mass
#set type 3 diameter ${d3}
#set type 3 mass ${mass3}

group substrate region substrate           # Define gorup
30 atoms in group substrate
group slider1 region slider1
21 atoms in group slider1
#group support region support
#group substrate_slider union substrate slider1

########################## Potential ###################################
pair_style granular
pair_coeff 1 1 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic              ########### set E between each particle in same type is small to neglect their interaction
pair_coeff 1 1 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic              
pair_coeff 2 2 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 2 2 hertz/material 0.00000001 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 3 3 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material ${E} 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
pair_coeff 1 2 hertz/material 100000000 0.001 0.3 tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 1 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
#pair_coeff 2 3 hertz/material 0.00000001 0.001 ${PR} tangential mindlin NULL 0.1 0.01 damping viscoelastic
comm_modify     vel yes
neigh_modify    delay 0 every 1 check yes

### Compute properties ###

compute 1 slider1 com                      # Compute the center of mass of top chain
#compute 2 support com                      # Compute the center of mass of supporting particle

variable p0 equal "step"

variable slider_z equal "c_1[3]"          # output the position of top chain in z-direction

#variable distance equal "c_2[1]-c_1[1]"   # Distance between COM of top chain and supporting particle

thermo 100000
thermo_style custom step lx ly lz press pxx pyy pzz ke pe temp c_1[1] c_1[2] c_1[3] #c_2[1] c_2[2] c_2[3] v_distance

############### Fix ##################


############## Equilibrium the system with apply force ########################

fix force_slider1 slider1 setforce NULL 0 NULL                                # Fix top chain not to move in y-direction

fix f_sub substrate freeze                                                    # Freeze the bottom chain

fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 ${lgv} 6987532   # NVE+langevin
fix rigid_top slider1 rigid/nve group 1 slider1 langevin 0 0 0.5 6987532   
  1 rigid bodies with 21 atoms

fix add slider1 addforce 0 0 ${Fn} every 1                                    # Add force to top layer
fix add slider1 addforce 0 0 -1000 every 1                                    

timestep ${dt}
timestep 1e-05

# fix  nve_1 slider1 nve

dump 		D1 all custom 100000 Equi_${num}_*.dump id type diameter mass xu yu zu fx fy fz
dump 		D1 all custom 100000 Equi_99_*.dump id type diameter mass xu yu zu fx fy fz

run 3000000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update every 1 steps, delay 0 steps, check yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 3.1
  ghost atom cutoff = 3.1
  binsize = 1.55, bins = 126 130 130
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair granular, perpetual
      attributes: half, newton on, size, history
      pair build: half/size/bin/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 15.17 | 18.64 | 19.8 Mbytes
   Step           Lx             Ly             Lz           Press           Pxx            Pyy            Pzz           KinEng         PotEng          Temp          c_1[1]         c_1[2]         c_1[3]    
         0   195            200            200            0              0              0              0              0              0              0              2.6109412e-16  0              6            
    100000   195            200            200            0.0021466199   2.1278468e-36  0              0.0064398596   11928.858      0              5.7600185e+10  2.6109412e-16  0              3.3406158    
    200000   195            200            200            0.00065327366 -1.9887687e-36  0              0.001959821    2281.4002      0              1.1016065e+10  2.6109412e-16  0              3.1062988    
    300000   195            200            200           -0.00010780012 -3.1742885e-36  0             -0.00032340035  170.10802      0              8.2139076e+08  2.6109412e-16  0              3.0350828    
    400000   195            200            200            0.010020602   -1.6807867e-38  0              0.030061805    17.171079      0              82912994       2.6109412e-16  0              2.9884504    
    500000   195            200            200            0.0005012651   2.8930625e-35  0              0.0015037953   0.00061844743  0              2986.2613      2.6109412e-16  0              2.9984397    
    600000   195            200            200            0.0020999981   7.3396433e-36  0              0.0062999943   2.4356904      0              11761077       2.6109412e-16  0              2.9959234    
    700000   195            200            200            0.0025416546  -8.480169e-38   0              0.0076249638   0.45715598     0              2207442.6      2.6109412e-16  0              2.995383     
    800000   195            200            200            0.0026531053   1.8350078e-36  0              0.007959316    0.069646322    0              336297.17      2.6109412e-16  0              2.9952537    
    900000   195            200            200            0.002681794   -2.8807866e-38  0              0.008045382    0.0099867349   0              48222.369      2.6109412e-16  0              2.9952213    
   1000000   195            200            200            0.0026881547   3.2776812e-38  0              0.008064464    0.0013718595   0              6624.2186      2.6109412e-16  0              2.9952144    
   1100000   195            200            200            0.0026889521  -9.1482501e-38  0              0.0080668564   0.00018105374  0              874.24369      2.6109412e-16  0              2.9952137    
   1200000   195            200            200            0.0026886774   2.1306131e-39  0              0.0080660323   2.2943808e-05  0              110.78744      2.6109412e-16  0              2.9952142    
   1300000   195            200            200            0.00268837     2.0719122e-39  0              0.0080651101   2.7842852e-06  0              13.444317      2.6109412e-16  0              2.9952146    
   1400000   195            200            200            0.0026881834  -9.2336595e-40  0              0.0080645501   3.2193297e-07  0              1.5544991      2.6109412e-16  0              2.9952148    
   1500000   195            200            200            0.002688089    6.5653985e-39  0              0.008064267    3.5171478e-08  0              0.16983048     2.6109412e-16  0              2.9952149    
   1600000   195            200            200            0.0026880455  -8.9002789e-39  0              0.0080641365   3.581e-09      0              0.017291367    2.6109412e-16  0              2.995215     
   1700000   195            200            200            0.0026880266  -1.8655684e-38  0              0.0080640797   3.3181189e-10  0              0.0016022009   2.6109412e-16  0              2.995215     
   1800000   195            200            200            0.0026880187   1.0167711e-38  0              0.0080640561   2.6751018e-11  0              0.00012917109  2.6109412e-16  0              2.995215     
   1900000   195            200            200            0.0026880155   1.1540267e-38  0              0.0080640465   1.6974768e-12  0              8.196508e-06   2.6109412e-16  0              2.995215     
   2000000   195            200            200            0.0026880142   2.4958128e-38  0              0.0080640427   6.2108886e-14  0              2.9990158e-07  2.6109412e-16  0              2.995215     
   2100000   195            200            200            0.0026880138   9.4625763e-39  0              0.0080640413   2.7328473e-17  0              1.3195942e-10  2.6109412e-16  0              2.995215     
   2200000   195            200            200            0.0026880136   7.7899462e-39  0              0.0080640407   8.8993418e-16  0              4.2971737e-09  2.6109412e-16  0              2.995215     
   2300000   195            200            200            0.0026880135   1.6875155e-38  0              0.0080640405   5.044285e-16   0              2.4357047e-09  2.6109412e-16  0              2.995215     
   2400000   195            200            200            0.0026880135   1.4687608e-38  0              0.0080640405   1.5250444e-16  0              7.3638934e-10  2.6109412e-16  0              2.995215     
   2500000   195            200            200            0.0026880135   2.0423836e-39  0              0.0080640404   3.5715714e-17  0              1.724584e-10   2.6109412e-16  0              2.995215     
   2600000   195            200            200            0.0026880135   2.186899e-38   0              0.0080640404   7.5223779e-18  0              3.6322871e-11  2.6109412e-16  0              2.995215     
   2700000   195            200            200            0.0026880135   3.3910637e-38  0              0.0080640404   1.4100086e-18  0              6.8084269e-12  2.6109412e-16  0              2.995215     
   2800000   195            200            200            0.0026880135  -5.9544625e-39  0              0.0080640404   2.8245493e-19  0              1.3638738e-12  2.6109412e-16  0              2.995215     
   2900000   195            200            200            0.0026880135   3.8309709e-38  0              0.0080640404   5.36365e-21    0              2.5899146e-14  2.6109412e-16  0              2.995215     
   3000000   195            200            200            0.0026880135   3.4106454e-38  0              0.0080640404   5.5839852e-20  0              2.6963066e-13  2.6109412e-16  0              2.995215     
Loop time of 64.2154 on 4 procs for 3000000 steps with 51 atoms

Performance: 40364148.145 ns/day, 0.000 hours/ns, 46717.764 timesteps/s
100.0% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.30856    | 1.5293     | 4.9754     | 160.9 |  2.38
Neigh   | 0.098562   | 0.099172   | 0.10077    |   0.3 |  0.15
Comm    | 25.796     | 32.659     | 38.467     |  86.1 | 50.86
Output  | 0.061302   | 0.061384   | 0.061445   |   0.0 |  0.10
Modify  | 15.198     | 21.148     | 28.648     | 123.8 | 32.93
Other   |            | 8.719      |            |       | 13.58

Nlocal:          12.75 ave          51 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1
Nghost:          39.25 ave          52 max           1 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Neighs:           5.75 ave          23 max           0 min
Histogram: 3 0 0 0 0 0 0 0 0 1

Total # of neighbors = 23
Ave neighs/atom = 0.45098039
Neighbor list builds = 166
Dangerous builds = 0

undump D1

############ Add spring between top chain to supp particle and then equilibrium  ###########

#fix sp1 support spring couple slider1 ${K0} ${lenspr} NULL NULL 0                                 # Add spring

#dump 		D2 all custom 100000 add_${num}*.dump id type diameter mass xu yu zu

#fix add1 all print 10 "${p0} ${distance} ${slider_z}" file add_distance_${num}.txt screen no      # out put step, distance(spring length), z-position of top chain

#run 1000000

#undump D2

#unfix add1

########## Pulling the supporting particle with constant velocity #############

#fix m1 support move linear 0.1 0 0 units box                                                      # apply constant velocity to supporting particles along x-direction V=0.1m/s

#fix move1 all print 100 "${p0} ${distance} ${slider_z}" file move_distance_${num}.txt screen no

#dump 		1 all custom 50000 move_${num}_*.dump id type diameter mass xu yu zu

#run 1000000

clear
  using 1 OpenMP thread(s) per MPI task

next num

jump SELF startloop
Total wall time: 1:46:43
